2025-06-04 00:53:26,064	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 30.207.97.15:6379...
2025-06-04 00:53:26,075	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(main_task pid=415227)[0m {'actor_rollout_ref': {'actor': {'adaptive_temperature_clip': -1,
[36m(main_task pid=415227)[0m                                  'adaptive_temperature_target_entropy': 1.0,
[36m(main_task pid=415227)[0m                                  'all_max_clip': -1,
[36m(main_task pid=415227)[0m                                  'alpha_lr': 0.01,
[36m(main_task pid=415227)[0m                                  'clip_ratio': 0.2,
[36m(main_task pid=415227)[0m                                  'clip_upper_bound': 1.0,
[36m(main_task pid=415227)[0m                                  'debug': False,
[36m(main_task pid=415227)[0m                                  'entropy_coeff': 0.001,
[36m(main_task pid=415227)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=415227)[0m                                                  'grad_offload': False,
[36m(main_task pid=415227)[0m                                                  'optimizer_offload': True,
[36m(main_task pid=415227)[0m                                                  'param_offload': False,
[36m(main_task pid=415227)[0m                                                  'sft_optimizer_offload': True,
[36m(main_task pid=415227)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=415227)[0m                                  'grad_clip': 0.7,
[36m(main_task pid=415227)[0m                                  'kl_loss_coef': 0.0,
[36m(main_task pid=415227)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(main_task pid=415227)[0m                                  'loss_remove_clip': True,
[36m(main_task pid=415227)[0m                                  'loss_remove_token_mean': True,
[36m(main_task pid=415227)[0m                                  'off_policy_cliprange': 0.2,
[36m(main_task pid=415227)[0m                                  'off_policy_loss_impl': 'token',
[36m(main_task pid=415227)[0m                                  'off_policy_max_clip': -1,
[36m(main_task pid=415227)[0m                                  'off_policy_min_clip': -1,
[36m(main_task pid=415227)[0m                                  'off_policy_normalize': False,
[36m(main_task pid=415227)[0m                                  'off_policy_reshape': 'p_div_p_0.1',
[36m(main_task pid=415227)[0m                                  'off_policy_reshape_pow_exp': 0.5,
[36m(main_task pid=415227)[0m                                  'off_policy_reshape_weight': 0.1,
[36m(main_task pid=415227)[0m                                  'on_policy_reshape': 'no_reshape',
[36m(main_task pid=415227)[0m                                  'on_policy_reshape_pow_exp': 0.5,
[36m(main_task pid=415227)[0m                                  'on_policy_reshape_weight': 0.1,
[36m(main_task pid=415227)[0m                                  'optim': {'lr': 1e-06,
[36m(main_task pid=415227)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(main_task pid=415227)[0m                                            'min_lr_ratio': None,
[36m(main_task pid=415227)[0m                                            'sft': {'lr': 1e-06,
[36m(main_task pid=415227)[0m                                                    'same_or_not': False},
[36m(main_task pid=415227)[0m                                            'total_training_steps': -1,
[36m(main_task pid=415227)[0m                                            'warmup_style': 'constant'},
[36m(main_task pid=415227)[0m                                  'ppo_epochs': 1,
[36m(main_task pid=415227)[0m                                  'ppo_kl_loss_coef': 0.01,
[36m(main_task pid=415227)[0m                                  'ppo_max_token_len_per_gpu': 32768,
[36m(main_task pid=415227)[0m                                  'ppo_micro_batch_size': 64,
[36m(main_task pid=415227)[0m                                  'ppo_mini_batch_size': 64,
[36m(main_task pid=415227)[0m                                  'sft': {'entropy_coeff': 0.001,
[36m(main_task pid=415227)[0m                                          'sft_data_size': 128,
[36m(main_task pid=415227)[0m                                          'sft_epochs': 1,
[36m(main_task pid=415227)[0m                                          'sft_micro_batch_size': 16,
[36m(main_task pid=415227)[0m                                          'sft_mini_batch_size': 128},
[36m(main_task pid=415227)[0m                                  'sft_prefix_reward_weight': 1.0,
[36m(main_task pid=415227)[0m                                  'shuffle': False,
[36m(main_task pid=415227)[0m                                  'strategy': 'fsdp',
[36m(main_task pid=415227)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=415227)[0m                                  'use_adaptive_temperature': False,
[36m(main_task pid=415227)[0m                                  'use_adaptive_temperature_fixed': False,
[36m(main_task pid=415227)[0m                                  'use_dynamic_bsz': True,
[36m(main_task pid=415227)[0m                                  'use_kl_loss': False,
[36m(main_task pid=415227)[0m                                  'use_off_policy_clip': False,
[36m(main_task pid=415227)[0m                                  'use_off_policy_loss': True,
[36m(main_task pid=415227)[0m                                  'use_off_policy_probs': False,
[36m(main_task pid=415227)[0m                                  'use_ppo_kl_loss': False,
[36m(main_task pid=415227)[0m                                  'use_sft_prefix_reward': False,
[36m(main_task pid=415227)[0m                                  'use_sft_reward': False,
[36m(main_task pid=415227)[0m                                  'use_target_lst': False},
[36m(main_task pid=415227)[0m                        'hybrid_engine': True,
[36m(main_task pid=415227)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(main_task pid=415227)[0m                                  'external_lib': None,
[36m(main_task pid=415227)[0m                                  'override_config': {},
[36m(main_task pid=415227)[0m                                  'path': '/jizhicfs/hymiezhao/models/Meta-Llama-3.1-8B',
[36m(main_task pid=415227)[0m                                  'use_remove_padding': True},
[36m(main_task pid=415227)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(main_task pid=415227)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=415227)[0m                                'log_prob_max_token_len_per_gpu': 32768,
[36m(main_task pid=415227)[0m                                'log_prob_micro_batch_size': 128,
[36m(main_task pid=415227)[0m                                'log_prob_use_dynamic_bsz': True,
[36m(main_task pid=415227)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=415227)[0m                                'use_ref': False},
[36m(main_task pid=415227)[0m                        'rollout': {'do_sample': True,
[36m(main_task pid=415227)[0m                                    'dtype': 'bfloat16',
[36m(main_task pid=415227)[0m                                    'enable_chunked_prefill': True,
[36m(main_task pid=415227)[0m                                    'enforce_eager': True,
[36m(main_task pid=415227)[0m                                    'free_cache_engine': True,
[36m(main_task pid=415227)[0m                                    'gpu_memory_utilization': 0.8,
[36m(main_task pid=415227)[0m                                    'ignore_eos': False,
[36m(main_task pid=415227)[0m                                    'load_format': 'dummy_dtensor',
[36m(main_task pid=415227)[0m                                    'log_prob_max_token_len_per_gpu': 32768,
[36m(main_task pid=415227)[0m                                    'log_prob_micro_batch_size': 128,
[36m(main_task pid=415227)[0m                                    'log_prob_use_dynamic_bsz': True,
[36m(main_task pid=415227)[0m                                    'max_num_batched_tokens': 8192,
[36m(main_task pid=415227)[0m                                    'max_num_seqs': 1024,
[36m(main_task pid=415227)[0m                                    'max_prefix_len': 8192,
[36m(main_task pid=415227)[0m                                    'max_prefix_ratio': 1.0,
[36m(main_task pid=415227)[0m                                    'min_prefix_ratio': 0.0,
[36m(main_task pid=415227)[0m                                    'n': 8,
[36m(main_task pid=415227)[0m                                    'n_prefix': 1,
[36m(main_task pid=415227)[0m                                    'n_val': 1,
[36m(main_task pid=415227)[0m                                    'name': 'vllm',
[36m(main_task pid=415227)[0m                                    'prefix_linear_max_ratio': 0.8,
[36m(main_task pid=415227)[0m                                    'prefix_linear_max_var': 0.1,
[36m(main_task pid=415227)[0m                                    'prefix_reward_strategy': 'all',
[36m(main_task pid=415227)[0m                                    'prefix_reward_weight_alpha': 1.0,
[36m(main_task pid=415227)[0m                                    'prefix_reward_weight_beta': 1.0,
[36m(main_task pid=415227)[0m                                    'prefix_share_across_samples': False,
[36m(main_task pid=415227)[0m                                    'prefix_steps': 1000,
[36m(main_task pid=415227)[0m                                    'prefix_strategy': 'random',
[36m(main_task pid=415227)[0m                                    'prompt_length': 1024,
[36m(main_task pid=415227)[0m                                    'response_length': 8192,
[36m(main_task pid=415227)[0m                                    'temperature': 1.0,
[36m(main_task pid=415227)[0m                                    'tensor_model_parallel_size': 2,
[36m(main_task pid=415227)[0m                                    'top_k': -1,
[36m(main_task pid=415227)[0m                                    'top_p': 1,
[36m(main_task pid=415227)[0m                                    'val_temperature': 0.6}},
[36m(main_task pid=415227)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(main_task pid=415227)[0m                'gamma': 1.0,
[36m(main_task pid=415227)[0m                'grpo_use_std': False,
[36m(main_task pid=415227)[0m                'kl_ctrl': {'kl_coef': 0.0, 'type': 'fixed'},
[36m(main_task pid=415227)[0m                'kl_penalty': 'kl',
[36m(main_task pid=415227)[0m                'lam': 1.0,
[36m(main_task pid=415227)[0m                'surprisal_base': 0.0},
[36m(main_task pid=415227)[0m  'critic': {'cliprange_value': 0.5,
[36m(main_task pid=415227)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(main_task pid=415227)[0m             'forward_micro_batch_size': 64,
[36m(main_task pid=415227)[0m             'grad_clip': 1.0,
[36m(main_task pid=415227)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(main_task pid=415227)[0m                       'external_lib': None,
[36m(main_task pid=415227)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=415227)[0m                                       'grad_offload': False,
[36m(main_task pid=415227)[0m                                       'optimizer_offload': False,
[36m(main_task pid=415227)[0m                                       'param_offload': False,
[36m(main_task pid=415227)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=415227)[0m                       'override_config': {},
[36m(main_task pid=415227)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(main_task pid=415227)[0m                       'tokenizer_path': '/jizhicfs/hymiezhao/models/Meta-Llama-3.1-8B',
[36m(main_task pid=415227)[0m                       'use_remove_padding': False},
[36m(main_task pid=415227)[0m             'optim': {'lr': 1e-05,
[36m(main_task pid=415227)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(main_task pid=415227)[0m                       'min_lr_ratio': None,
[36m(main_task pid=415227)[0m                       'total_training_steps': -1,
[36m(main_task pid=415227)[0m                       'warmup_style': 'constant'},
[36m(main_task pid=415227)[0m             'ppo_epochs': 1,
[36m(main_task pid=415227)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(main_task pid=415227)[0m             'ppo_micro_batch_size': 64,
[36m(main_task pid=415227)[0m             'ppo_mini_batch_size': 64,
[36m(main_task pid=415227)[0m             'shuffle': False,
[36m(main_task pid=415227)[0m             'strategy': 'fsdp',
[36m(main_task pid=415227)[0m             'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=415227)[0m             'use_dynamic_bsz': True},
[36m(main_task pid=415227)[0m  'data': {'accuracy_lower_bound': 0.0,
[36m(main_task pid=415227)[0m           'accuracy_upper_bound': 1.0,
[36m(main_task pid=415227)[0m           'add_tgt_acc_upper_bound': 0.5,
[36m(main_task pid=415227)[0m           'add_tgt_with_acc': False,
[36m(main_task pid=415227)[0m           'disable_truncation_advantage': False,
[36m(main_task pid=415227)[0m           'filter_accuracy': False,
[36m(main_task pid=415227)[0m           'filter_targets': False,
[36m(main_task pid=415227)[0m           'max_prompt_length': 1024,
[36m(main_task pid=415227)[0m           'max_response_length': 8192,
[36m(main_task pid=415227)[0m           'prompt_key': 'prompt',
[36m(main_task pid=415227)[0m           'return_raw_chat': False,
[36m(main_task pid=415227)[0m           'return_raw_input_ids': False,
[36m(main_task pid=415227)[0m           'reward_impl_version': 3,
[36m(main_task pid=415227)[0m           'sample_target_ratio': 1.0,
[36m(main_task pid=415227)[0m           'shuffle': True,
[36m(main_task pid=415227)[0m           'tokenizer': None,
[36m(main_task pid=415227)[0m           'train_batch_size': 128,
[36m(main_task pid=415227)[0m           'train_files': './dataset//llama_openr1.parquet',
[36m(main_task pid=415227)[0m           'val_batch_size': 512,
[36m(main_task pid=415227)[0m           'val_files': './dataset//llama_valid.parquet'},
[36m(main_task pid=415227)[0m  'reward_model': {'enable': False,
[36m(main_task pid=415227)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(main_task pid=415227)[0m                   'max_length': None,
[36m(main_task pid=415227)[0m                   'micro_batch_size': 64,
[36m(main_task pid=415227)[0m                   'model': {'external_lib': None,
[36m(main_task pid=415227)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=415227)[0m                                             'min_num_params': 0,
[36m(main_task pid=415227)[0m                                             'param_offload': False},
[36m(main_task pid=415227)[0m                             'input_tokenizer': '/jizhicfs/hymiezhao/models/Meta-Llama-3.1-8B',
[36m(main_task pid=415227)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(main_task pid=415227)[0m                             'use_remove_padding': False},
[36m(main_task pid=415227)[0m                   'strategy': 'fsdp',
[36m(main_task pid=415227)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=415227)[0m                   'use_dynamic_bsz': True},
[36m(main_task pid=415227)[0m  'sft': {'buffer_type': 'solve_none'},
[36m(main_task pid=415227)[0m  'trainer': {'acc_rebatch': False,
[36m(main_task pid=415227)[0m              'add_full_target_when_none': False,
[36m(main_task pid=415227)[0m              'critic_warmup': 0,
[36m(main_task pid=415227)[0m              'debug': False,
[36m(main_task pid=415227)[0m              'default_hdfs_dir': None,
[36m(main_task pid=415227)[0m              'default_local_dir': './train_results/rl-sft/llama_8_INTERLEAVE',
[36m(main_task pid=415227)[0m              'experiment_name': 'llama_8_INTERLEAVE',
[36m(main_task pid=415227)[0m              'logger': ['console', 'wandb'],
[36m(main_task pid=415227)[0m              'max_optim_to_keep': 2,
[36m(main_task pid=415227)[0m              'n_gpus_per_node': 8,
[36m(main_task pid=415227)[0m              'nnodes': 2,
[36m(main_task pid=415227)[0m              'project_name': 'rl-sft',
[36m(main_task pid=415227)[0m              'rejection_sample': False,
[36m(main_task pid=415227)[0m              'rejection_sample_multiplier': 2,
[36m(main_task pid=415227)[0m              'resume_from_path': False,
[36m(main_task pid=415227)[0m              'resume_mode': 'auto',
[36m(main_task pid=415227)[0m              'save_freq': -1,
[36m(main_task pid=415227)[0m              'skip_by_step': False,
[36m(main_task pid=415227)[0m              'skip_valid_mask': False,
[36m(main_task pid=415227)[0m              'test_freq': 10,
[36m(main_task pid=415227)[0m              'total_epochs': 5,
[36m(main_task pid=415227)[0m              'total_training_steps': None,
[36m(main_task pid=415227)[0m              'val_before_train': False}}
[36m(main_task pid=415227)[0m /jizhicfs/hymiezhao/ml/reasoning/LUFFY/luffy/verl/verl/utils/tokenizer.py:29: UserWarning: tokenizer.pad_token_id is None. Now set to 128001
[36m(main_task pid=415227)[0m   warnings.warn(f'tokenizer.pad_token_id is None. Now set to {tokenizer.eos_token_id}')
[36m(main_task pid=415227)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(main_task pid=415227)[0m No module named 'vllm._version'
[36m(main_task pid=415227)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(main_task pid=415227)[0m original dataset len: 45792
[36m(main_task pid=415227)[0m filter dataset len: 45774
[36m(main_task pid=415227)[0m original dataset len: 2019
[36m(main_task pid=415227)[0m filter dataset len: 2017
[36m(main_task pid=415227)[0m Size of train dataloader: 357
[36m(main_task pid=415227)[0m Size of val dataloader: 1
[36m(main_task pid=415227)[0m Total training steps: 1785
[36m(pid=717751, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=717751, ip=30.207.97.111)[0m No module named 'vllm._version'
[36m(pid=717751, ip=30.207.97.111)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(pid=717887, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=717887, ip=30.207.97.111)[0m No module named 'vllm._version'
[36m(pid=717887, ip=30.207.97.111)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/ml/reasoning/LUFFY/luffy/verl/verl/utils/tokenizer.py:29: UserWarning: tokenizer.pad_token_id is None. Now set to 128001
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m   warnings.warn(f'tokenizer.pad_token_id is None. Now set to {tokenizer.eos_token_id}')
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in LlamaForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  3.81it/s]
[36m(pid=415916)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:[32m [repeated 9x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(pid=415916)[0m No module named 'vllm._version'[32m [repeated 9x across cluster][0m
[36m(pid=415916)[0m   from vllm.version import __version__ as VLLM_VERSION[32m [repeated 9x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s]
[36m(WorkerDict pid=415918)[0m /jizhicfs/hymiezhao/ml/reasoning/LUFFY/luffy/verl/verl/utils/tokenizer.py:29: UserWarning: tokenizer.pad_token_id is None. Now set to 128001[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=415918)[0m   warnings.warn(f'tokenizer.pad_token_id is None. Now set to {tokenizer.eos_token_id}')[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=415916)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in LlamaForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 9x across cluster][0m
[36m(WorkerDict pid=415916)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 9x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m Model config after override: LlamaConfig {
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "_name_or_path": "/jizhicfs/hymiezhao/models/Meta-Llama-3.1-8B",
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "architectures": [
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m     "LlamaForCausalLM"
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   ],
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "attention_bias": false,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "bos_token_id": 128000,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "eos_token_id": 128001,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "head_dim": 128,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "hidden_size": 4096,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "intermediate_size": 14336,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "max_position_embeddings": 131072,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "mlp_bias": false,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "model_type": "llama",
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "num_attention_heads": 32,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "num_hidden_layers": 32,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "num_key_value_heads": 8,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "pad_token_id": 128001,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "pretraining_tp": 1,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "rms_norm_eps": 1e-05,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "rope_scaling": {
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m     "factor": 8.0,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m     "high_freq_factor": 4.0,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m     "low_freq_factor": 1.0,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m     "original_max_position_embeddings": 8192,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m     "rope_type": "llama3"
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   },
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "rope_theta": 500000.0,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "transformers_version": "4.46.3",
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "use_cache": true,
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m   "vocab_size": 128256
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m }
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m 
[36m(WorkerDict pid=415916)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 9x across cluster][0m
[36m(WorkerDict pid=415919)[0m Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  3.68it/s][32m [repeated 23x across cluster][0m
[36m(pid=415920)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:[32m [repeated 5x across cluster][0m
[36m(pid=415920)[0m No module named 'vllm._version'[32m [repeated 5x across cluster][0m
[36m(pid=415920)[0m   from vllm.version import __version__ as VLLM_VERSION[32m [repeated 5x across cluster][0m
[36m(WorkerDict pid=415922)[0m Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  5.21it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  5.07it/s][32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=415917)[0m /jizhicfs/hymiezhao/ml/reasoning/LUFFY/luffy/verl/verl/utils/tokenizer.py:29: UserWarning: tokenizer.pad_token_id is None. Now set to 128001[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=415917)[0m   warnings.warn(f'tokenizer.pad_token_id is None. Now set to {tokenizer.eos_token_id}')[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=415920)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in LlamaForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=415920)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=415920)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.76s/it][32m [repeated 23x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.33s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:15<00:00,  3.86s/it]
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.75s/it]
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=415916)[0m wrap_policy: functools.partial(<function transformer_auto_wrap_policy at 0x7edc8c952d40>, transformer_layer_cls={<class 'transformers.models.llama.modeling_llama.LlamaDecoderLayer'>})
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m LlamaForCausalLM contains 8.03B parameters
[36m(WorkerDict pid=415916)[0m Total steps: 1785, num_warmup_steps: 0
[36m(WorkerDict pid=415916)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m Before building vllm rollout, memory allocated (GB): 1.8697071075439453, memory reserved (GB): 2.06640625
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m wrap_policy: functools.partial(<function transformer_auto_wrap_policy at 0x7fc7bd92ad40>, transformer_layer_cls={<class 'transformers.models.llama.modeling_llama.LlamaDecoderLayer'>})[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m INFO 06-04 00:57:17 config.py:887] Defaulting to use ray for distributed inference
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m INFO 06-04 00:57:17 config.py:1005] Chunked prefill is enabled with max_num_batched_tokens=8192.
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m WARNING 06-04 00:57:17 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m Total steps: 1785, num_warmup_steps: 0[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m Actor use_remove_padding=True[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m local rank 0
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m INFO 06-04 00:57:18 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:211: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m   @torch.library.impl_abstract("xformers_flash::flash_fwd")
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m   @torch.library.impl_abstract("xformers_flash::flash_bwd")
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:344: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m   @torch.library.impl_abstract("xformers_flash::flash_fwd")[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m INFO 06-04 00:57:31 utils.py:1008] Found nccl from library libnccl.so.2
[36m(WorkerDict pid=415916)[0m INFO 06-04 00:57:31 pynccl.py:63] vLLM is using nccl==2.20.5
[36m(WorkerDict pid=415916)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=415919)[0m INFO 06-04 00:57:20 config.py:887] Defaulting to use ray for distributed inference[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415919)[0m INFO 06-04 00:57:20 config.py:1005] Chunked prefill is enabled with max_num_batched_tokens=8192.[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415919)[0m WARNING 06-04 00:57:20 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415919)[0m local rank 0[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415920)[0m INFO 06-04 00:57:21 selector.py:115] Using XFormers backend.[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m INFO 06-04 00:57:32 shm_broadcast.py:241] vLLM message queue communication handle: Handle(connect_ip='127.0.0.1', local_reader_ranks=[1], buffer=<vllm.distributed.device_communicators.shm_broadcast.ShmRingBuffer object at 0x7f7fb844afb0>, local_subscribe_port=49255, remote_subscribe_port=None)
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m before init cache memory allocated: 10.082285056GB, reserved: 10.166992896GB
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m INFO 06-04 00:57:31 utils.py:1008] Found nccl from library libnccl.so.2[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m INFO 06-04 00:57:31 pynccl.py:63] vLLM is using nccl==2.20.5[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m NCCL version 2.20.5+cuda12.4[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m INFO 06-04 00:57:34 selector.py:115] Using XFormers backend.[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717886, ip=30.207.97.111)[0m INFO 06-04 00:57:34 shm_broadcast.py:241] vLLM message queue communication handle: Handle(connect_ip='127.0.0.1', local_reader_ranks=[1], buffer=<vllm.distributed.device_communicators.shm_broadcast.ShmRingBuffer object at 0x7f84ba620490>, local_subscribe_port=53297, remote_subscribe_port=None)[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=415918)[0m kwargs: {'n': 8, 'logprobs': 1, 'max_tokens': 8192, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=415918)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=415918)[0m   warnings.warn(
[36m(WorkerDict pid=415922)[0m   @torch.library.impl_abstract("xformers_flash::flash_bwd")[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415922)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:344: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m kwargs: {'n': 8, 'logprobs': 1, 'max_tokens': 8192, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 9x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 9x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m   warnings.warn([32m [repeated 9x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m after init cache memory allocated: 66.722166272GB, reserved: 66.806874112GB
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m After building vllm rollout, memory allocated (GB): 54.65889501571655, memory reserved (GB): 62.21875
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m After building sharding manager, memory allocated (GB): 54.65889501571655, memory reserved (GB): 62.21875
[36m(main_task pid=415227)[0m wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
[36m(WorkerDict pid=717886, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=717886, ip=30.207.97.111)[0m   warnings.warn([32m [repeated 6x across cluster][0m
[36m(main_task pid=415227)[0m wandb: Currently logged in as: maluqaq (theroadqaq). Use `wandb login --relogin` to force relogin
[36m(main_task pid=415227)[0m wandb: Tracking run with wandb version 0.19.1
[36m(main_task pid=415227)[0m wandb: Run data is saved locally in /jizhicfs/hymiezhao/ml/reasoning/LUFFY/wandb/run-20250604_005829-e8g1dcjb
[36m(main_task pid=415227)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(main_task pid=415227)[0m wandb: Syncing run llama_8_INTERLEAVE
[36m(main_task pid=415227)[0m wandb: ⭐️ View project at https://wandb.ai/theroadqaq/rl-sft
[36m(main_task pid=415227)[0m wandb: 🚀 View run at https://wandb.ai/theroadqaq/rl-sft/runs/e8g1dcjb
[36m(main_task pid=415227)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(main_task pid=415227)[0m Checkpoint tracker file does not exist: %s /jizhicfs/hymiezhao/ml/reasoning/LUFFY/./train_results/rl-sft/llama_8_INTERLEAVE/latest_checkpointed_iteration.txt
[36m(main_task pid=415227)[0m Training from scratch
[36m(WorkerDict pid=717886, ip=30.207.97.111)[0m kwargs: {'n': 8, 'logprobs': 1, 'max_tokens': 8192, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=415916)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717886, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 10x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415923)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415923)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=415918)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.[32m [repeated 9x across cluster][0m
[36m(WorkerDict pid=415918)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined][32m [repeated 9x across cluster][0m
[36m(main_task pid=415227)[0m step:1 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:21771.000 - global_seqlen/max:41807.000 - global_seqlen/minmax_diff:20036.000 - global_seqlen/balanced_min:32621.000 - global_seqlen/balanced_max:32712.000 - global_seqlen/mean:32642.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.477 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:2.020 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.039 - mfu/actor:0.273 - actor/lr:0.000 - actor/sft_entropy_loss:0.741 - actor/sft_loss:0.733 - actor/sft_grad_norm:0.387 - mfu/sft_actor:0.822 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:919.225 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.011 - on_off_metrics/on_response_length_mean:919.225 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:109.445 - prompt_length/max:371.000 - prompt_length/min:40.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:206.577 - timing_s/old_log_prob:11.668 - timing_s/adv:12.189 - timing_s/update_actor:44.643 - timing_s/sft_update_actor:20.700 - timing_s/step:284.301 - timing_per_token_ms/adv:0.012 - timing_per_token_ms/gen:0.219 - timing_per_token_ms/update_actor:0.042
[36m(WorkerDict pid=415921)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415922)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=415922)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=415227)[0m step:2 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:21274.000 - global_seqlen/max:41571.000 - global_seqlen/minmax_diff:20297.000 - global_seqlen/balanced_min:31292.000 - global_seqlen/balanced_max:31350.000 - global_seqlen/mean:31314.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.438 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:2.301 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.040 - mfu/actor:0.301 - actor/lr:0.000 - actor/sft_entropy_loss:0.750 - actor/sft_loss:0.734 - actor/sft_grad_norm:0.360 - mfu/sft_actor:0.590 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:850.523 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.012 - on_off_metrics/on_response_length_mean:850.523 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:99.727 - prompt_length/max:236.000 - prompt_length/min:42.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:242.753 - timing_s/old_log_prob:9.861 - timing_s/adv:10.433 - timing_s/update_actor:36.998 - timing_s/sft_update_actor:20.432 - timing_s/step:310.819 - timing_per_token_ms/adv:0.011 - timing_per_token_ms/gen:0.279 - timing_per_token_ms/update_actor:0.038
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415922)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415922)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=415227)[0m step:3 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:23093.000 - global_seqlen/max:36325.000 - global_seqlen/minmax_diff:13232.000 - global_seqlen/balanced_min:30497.000 - global_seqlen/balanced_max:30592.000 - global_seqlen/mean:30545.500 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.430 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:2.494 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.050 - mfu/actor:0.275 - actor/lr:0.000 - actor/sft_entropy_loss:0.808 - actor/sft_loss:0.752 - actor/sft_grad_norm:0.306 - mfu/sft_actor:0.586 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:877.642 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.015 - on_off_metrics/on_response_length_mean:877.642 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:101.078 - prompt_length/max:229.000 - prompt_length/min:39.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:246.828 - timing_s/old_log_prob:9.079 - timing_s/adv:9.630 - timing_s/update_actor:41.001 - timing_s/sft_update_actor:20.971 - timing_s/step:318.632 - timing_per_token_ms/adv:0.010 - timing_per_token_ms/gen:0.275 - timing_per_token_ms/update_actor:0.041
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415918)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=415227)[0m step:4 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:23120.000 - global_seqlen/max:43329.000 - global_seqlen/minmax_diff:20209.000 - global_seqlen/balanced_min:31113.000 - global_seqlen/balanced_max:31248.000 - global_seqlen/mean:31162.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.272 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:3.858 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.002 - actor/grad_norm:0.059 - mfu/actor:0.264 - actor/lr:0.000 - actor/sft_entropy_loss:0.891 - actor/sft_loss:0.770 - actor/sft_grad_norm:0.304 - mfu/sft_actor:0.608 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:815.711 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.017 - on_off_metrics/on_response_length_mean:815.711 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:100.242 - prompt_length/max:356.000 - prompt_length/min:40.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:209.473 - timing_s/old_log_prob:8.517 - timing_s/adv:9.078 - timing_s/update_actor:40.935 - timing_s/sft_update_actor:19.045 - timing_s/step:278.731 - timing_per_token_ms/adv:0.010 - timing_per_token_ms/gen:0.251 - timing_per_token_ms/update_actor:0.044
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:5 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22212.000 - global_seqlen/max:45344.000 - global_seqlen/minmax_diff:23132.000 - global_seqlen/balanced_min:32963.000 - global_seqlen/balanced_max:33041.000 - global_seqlen/mean:32996.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.054 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:7.131 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.123 - mfu/actor:0.296 - actor/lr:0.000 - actor/sft_entropy_loss:0.858 - actor/sft_loss:0.724 - actor/sft_grad_norm:0.342 - mfu/sft_actor:0.862 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:1430.270 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.082 - on_off_metrics/on_response_length_mean:1430.270 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:106.086 - prompt_length/max:379.000 - prompt_length/min:34.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:226.727 - timing_s/old_log_prob:14.290 - timing_s/adv:14.944 - timing_s/update_actor:62.958 - timing_s/sft_update_actor:23.450 - timing_s/step:328.266 - timing_per_token_ms/adv:0.009 - timing_per_token_ms/gen:0.155 - timing_per_token_ms/update_actor:0.040
[36m(WorkerDict pid=415921)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=415227)[0m step:6 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22989.000 - global_seqlen/max:41123.000 - global_seqlen/minmax_diff:18134.000 - global_seqlen/balanced_min:30223.000 - global_seqlen/balanced_max:30286.000 - global_seqlen/mean:30254.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.032 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:7.601 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.001 - actor/grad_norm:0.133 - mfu/actor:0.388 - actor/lr:0.000 - actor/sft_entropy_loss:1.054 - actor/sft_loss:0.902 - actor/sft_grad_norm:0.350 - mfu/sft_actor:1.446 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:1837.331 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.119 - on_off_metrics/on_response_length_mean:1837.331 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:109.406 - prompt_length/max:407.000 - prompt_length/min:38.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:223.058 - timing_s/old_log_prob:16.193 - timing_s/adv:16.976 - timing_s/update_actor:62.224 - timing_s/sft_update_actor:18.841 - timing_s/step:321.278 - timing_per_token_ms/adv:0.009 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/update_actor:0.031
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=415227)[0m step:7 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22739.000 - global_seqlen/max:36987.000 - global_seqlen/minmax_diff:14248.000 - global_seqlen/balanced_min:30648.000 - global_seqlen/balanced_max:30796.000 - global_seqlen/mean:30761.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.019 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:8.387 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.010 - actor/grad_norm:0.173 - mfu/actor:0.387 - actor/lr:0.000 - actor/sft_entropy_loss:0.818 - actor/sft_loss:0.690 - actor/sft_grad_norm:0.369 - mfu/sft_actor:1.830 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:2513.970 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.184 - on_off_metrics/on_response_length_mean:2513.970 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:103.438 - prompt_length/max:356.000 - prompt_length/min:37.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:268.099 - timing_s/old_log_prob:20.023 - timing_s/adv:21.122 - timing_s/update_actor:83.714 - timing_s/sft_update_actor:20.407 - timing_s/step:393.541 - timing_per_token_ms/adv:0.008 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/update_actor:0.031
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415918)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:8 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25001.000 - global_seqlen/max:39686.000 - global_seqlen/minmax_diff:14685.000 - global_seqlen/balanced_min:30452.000 - global_seqlen/balanced_max:30542.000 - global_seqlen/mean:30508.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.005 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.748 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.008 - actor/grad_norm:0.155 - mfu/actor:0.386 - actor/lr:0.000 - actor/sft_entropy_loss:0.761 - actor/sft_loss:0.645 - actor/sft_grad_norm:0.406 - mfu/sft_actor:1.785 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:2718.527 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.150 - on_off_metrics/on_response_length_mean:2718.527 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:112.508 - prompt_length/max:318.000 - prompt_length/min:41.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:282.619 - timing_s/old_log_prob:24.059 - timing_s/adv:25.481 - timing_s/update_actor:90.453 - timing_s/sft_update_actor:21.864 - timing_s/step:420.617 - timing_per_token_ms/adv:0.009 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.031
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415918)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415918)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:9 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22351.000 - global_seqlen/max:39045.000 - global_seqlen/minmax_diff:16694.000 - global_seqlen/balanced_min:31032.000 - global_seqlen/balanced_max:31151.000 - global_seqlen/mean:31073.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.046 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.719 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.008 - actor/grad_norm:0.124 - mfu/actor:0.406 - actor/lr:0.000 - actor/sft_entropy_loss:0.828 - actor/sft_loss:0.740 - actor/sft_grad_norm:0.401 - mfu/sft_actor:1.762 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:2806.078 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.146 - on_off_metrics/on_response_length_mean:2806.078 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:108.242 - prompt_length/max:373.000 - prompt_length/min:48.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:278.432 - timing_s/old_log_prob:22.979 - timing_s/adv:24.414 - timing_s/update_actor:88.254 - timing_s/sft_update_actor:22.267 - timing_s/step:413.536 - timing_per_token_ms/adv:0.008 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/update_actor:0.030
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415922)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=415227)[0m Validation: Generation end.
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:10 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:23600.000 - global_seqlen/max:34736.000 - global_seqlen/minmax_diff:11136.000 - global_seqlen/balanced_min:29786.000 - global_seqlen/balanced_max:29865.000 - global_seqlen/mean:29830.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.001 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.680 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.030 - actor/grad_norm:0.129 - mfu/actor:0.419 - actor/lr:0.000 - actor/sft_entropy_loss:0.739 - actor/sft_loss:0.682 - actor/sft_grad_norm:0.332 - mfu/sft_actor:2.581 - actor/sft_lr:0.000 - val/test_score/olympiad_bench:0.000 - val/test_score/amc:0.000 - val/test_score/minerva:0.000 - val/test_score/aime:0.000 - val/test_score/math:0.000 - avg_score:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:3574.812 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.272 - on_off_metrics/on_response_length_mean:3574.812 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:97.516 - prompt_length/max:302.000 - prompt_length/min:40.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:355.144 - timing_s/old_log_prob:25.889 - timing_s/adv:27.653 - timing_s/update_actor:108.512 - timing_s/sft_update_actor:20.364 - timing_s/testing:492.890 - timing_s/step:1004.740 - timing_per_token_ms/adv:0.007 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/update_actor:0.029
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:11 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22830.000 - global_seqlen/max:37735.000 - global_seqlen/minmax_diff:14905.000 - global_seqlen/balanced_min:32195.000 - global_seqlen/balanced_max:32254.000 - global_seqlen/mean:32221.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.954 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.020 - actor/grad_norm:0.152 - mfu/actor:0.429 - actor/lr:0.000 - actor/sft_entropy_loss:0.773 - actor/sft_loss:0.729 - actor/sft_grad_norm:0.247 - mfu/sft_actor:2.915 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:4725.754 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.445 - on_off_metrics/on_response_length_mean:4725.754 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:102.500 - prompt_length/max:266.000 - prompt_length/min:36.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:405.326 - timing_s/old_log_prob:34.116 - timing_s/adv:36.333 - timing_s/update_actor:140.961 - timing_s/sft_update_actor:23.287 - timing_s/step:606.100 - timing_per_token_ms/adv:0.007 - timing_per_token_ms/gen:0.084 - timing_per_token_ms/update_actor:0.029
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717886, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:12 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:21076.000 - global_seqlen/max:34758.000 - global_seqlen/minmax_diff:13682.000 - global_seqlen/balanced_min:30520.000 - global_seqlen/balanced_max:30557.000 - global_seqlen/mean:30537.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.016 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.027 - actor/grad_norm:0.366 - mfu/actor:0.450 - actor/lr:0.000 - actor/sft_entropy_loss:0.750 - actor/sft_loss:0.742 - actor/sft_grad_norm:0.202 - mfu/sft_actor:4.405 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:6450.204 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.753 - on_off_metrics/on_response_length_mean:6450.204 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:107.500 - prompt_length/max:324.000 - prompt_length/min:34.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:488.754 - timing_s/old_log_prob:42.796 - timing_s/adv:45.808 - timing_s/update_actor:185.237 - timing_s/sft_update_actor:22.793 - timing_s/step:742.779 - timing_per_token_ms/adv:0.007 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.028
[36m(WorkerDict pid=415922)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m 
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415918)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415918)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:13 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:23323.000 - global_seqlen/max:41232.000 - global_seqlen/minmax_diff:17909.000 - global_seqlen/balanced_min:31217.000 - global_seqlen/balanced_max:31328.000 - global_seqlen/mean:31246.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.172 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.002 - actor/grad_norm:0.278 - mfu/actor:0.462 - actor/lr:0.000 - actor/sft_entropy_loss:0.692 - actor/sft_loss:0.702 - actor/sft_grad_norm:0.197 - mfu/sft_actor:4.499 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:6068.229 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.653 - on_off_metrics/on_response_length_mean:6068.229 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:91.703 - prompt_length/max:355.000 - prompt_length/min:36.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:447.632 - timing_s/old_log_prob:40.030 - timing_s/adv:42.761 - timing_s/update_actor:169.120 - timing_s/sft_update_actor:19.539 - timing_s/step:679.247 - timing_per_token_ms/adv:0.007 - timing_per_token_ms/gen:0.072 - timing_per_token_ms/update_actor:0.027
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415922)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415922)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717886, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:14 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22547.000 - global_seqlen/max:38798.000 - global_seqlen/minmax_diff:16251.000 - global_seqlen/balanced_min:31322.000 - global_seqlen/balanced_max:31380.000 - global_seqlen/mean:31347.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.337 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.015 - actor/grad_norm:0.130 - mfu/actor:0.477 - actor/lr:0.000 - actor/sft_entropy_loss:0.622 - actor/sft_loss:0.630 - actor/sft_grad_norm:0.207 - mfu/sft_actor:4.353 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:6721.897 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.741 - on_off_metrics/on_response_length_mean:6721.897 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:103.047 - prompt_length/max:267.000 - prompt_length/min:40.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:487.276 - timing_s/old_log_prob:43.744 - timing_s/adv:46.708 - timing_s/update_actor:181.099 - timing_s/sft_update_actor:22.487 - timing_s/step:737.768 - timing_per_token_ms/adv:0.007 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/update_actor:0.026
[36m(WorkerDict pid=415921)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m WARNING 06-04 02:59:34 scheduler.py:1484] Sequence group 493 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=1
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m WARNING 06-04 02:59:45 scheduler.py:1484] Sequence group 493 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=1[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m WARNING 06-04 02:59:52 scheduler.py:1484] Sequence group 493 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=1[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=415922)[0m WARNING 06-04 03:00:02 scheduler.py:1484] Sequence group 493 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=1[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m WARNING 06-04 03:00:13 scheduler.py:1484] Sequence group 493 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=1[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m WARNING 06-04 03:00:15 scheduler.py:1484] Sequence group 493 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=1[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:15 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:24961.000 - global_seqlen/max:37523.000 - global_seqlen/minmax_diff:12562.000 - global_seqlen/balanced_min:31322.000 - global_seqlen/balanced_max:31390.000 - global_seqlen/mean:31348.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.383 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.004 - actor/grad_norm:0.152 - mfu/actor:0.507 - actor/lr:0.000 - actor/sft_entropy_loss:0.643 - actor/sft_loss:0.648 - actor/sft_grad_norm:0.208 - mfu/sft_actor:4.427 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7764.155 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.919 - on_off_metrics/on_response_length_mean:7764.155 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:101.383 - prompt_length/max:570.000 - prompt_length/min:39.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:593.421 - timing_s/old_log_prob:48.972 - timing_s/adv:52.470 - timing_s/update_actor:197.354 - timing_s/sft_update_actor:25.117 - timing_s/step:868.556 - timing_per_token_ms/adv:0.007 - timing_per_token_ms/gen:0.075 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415920)[0m 
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m 
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415917)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:16 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22396.000 - global_seqlen/max:39413.000 - global_seqlen/minmax_diff:17017.000 - global_seqlen/balanced_min:31039.000 - global_seqlen/balanced_max:31080.000 - global_seqlen/mean:31056.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.449 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.006 - actor/grad_norm:0.100 - mfu/actor:0.500 - actor/lr:0.000 - actor/sft_entropy_loss:0.709 - actor/sft_loss:0.699 - actor/sft_grad_norm:0.202 - mfu/sft_actor:5.082 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7921.842 - response_length/max:8192.000 - response_length/min:1.000 - response_length/clip_ratio:0.939 - on_off_metrics/on_response_length_mean:7921.842 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:101.438 - prompt_length/max:302.000 - prompt_length/min:32.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:593.783 - timing_s/old_log_prob:49.468 - timing_s/adv:53.048 - timing_s/update_actor:203.811 - timing_s/sft_update_actor:22.733 - timing_s/step:873.577 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.073 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:17 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:26896.000 - global_seqlen/max:41787.000 - global_seqlen/minmax_diff:14891.000 - global_seqlen/balanced_min:33109.000 - global_seqlen/balanced_max:33181.000 - global_seqlen/mean:33161.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.486 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.003 - actor/grad_norm:0.102 - mfu/actor:0.513 - actor/lr:0.000 - actor/sft_entropy_loss:0.735 - actor/sft_loss:0.724 - actor/sft_grad_norm:0.187 - mfu/sft_actor:5.750 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7874.744 - response_length/max:8192.000 - response_length/min:57.000 - response_length/clip_ratio:0.920 - on_off_metrics/on_response_length_mean:7874.744 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:102.086 - prompt_length/max:226.000 - prompt_length/min:36.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:595.844 - timing_s/old_log_prob:48.661 - timing_s/adv:52.259 - timing_s/update_actor:197.334 - timing_s/sft_update_actor:20.152 - timing_s/step:865.857 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415922)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415917)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:18 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22481.000 - global_seqlen/max:42568.000 - global_seqlen/minmax_diff:20087.000 - global_seqlen/balanced_min:31991.000 - global_seqlen/balanced_max:32078.000 - global_seqlen/mean:32036.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.521 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.002 - actor/grad_norm:0.059 - mfu/actor:0.501 - actor/lr:0.000 - actor/sft_entropy_loss:0.695 - actor/sft_loss:0.672 - actor/sft_grad_norm:0.172 - mfu/sft_actor:4.576 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7841.709 - response_length/max:8192.000 - response_length/min:5.000 - response_length/clip_ratio:0.924 - on_off_metrics/on_response_length_mean:7841.709 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:99.531 - prompt_length/max:282.000 - prompt_length/min:41.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:586.174 - timing_s/old_log_prob:48.484 - timing_s/adv:52.114 - timing_s/update_actor:201.490 - timing_s/sft_update_actor:24.326 - timing_s/step:864.307 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.073 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:19 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:21367.000 - global_seqlen/max:37236.000 - global_seqlen/minmax_diff:15869.000 - global_seqlen/balanced_min:30198.000 - global_seqlen/balanced_max:30416.000 - global_seqlen/mean:30280.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.541 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.001 - actor/grad_norm:0.057 - mfu/actor:0.493 - actor/lr:0.000 - actor/sft_entropy_loss:0.617 - actor/sft_loss:0.596 - actor/sft_grad_norm:0.154 - mfu/sft_actor:5.364 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7894.643 - response_length/max:8192.000 - response_length/min:10.000 - response_length/clip_ratio:0.927 - on_off_metrics/on_response_length_mean:7894.643 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:109.852 - prompt_length/max:719.000 - prompt_length/min:45.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:612.115 - timing_s/old_log_prob:49.054 - timing_s/adv:52.817 - timing_s/update_actor:206.063 - timing_s/sft_update_actor:21.315 - timing_s/step:892.519 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.076 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m WARNING 06-04 04:26:52 scheduler.py:1484] Sequence group 788 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=51
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m WARNING 06-04 04:26:58 scheduler.py:1484] Sequence group 790 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=51[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m WARNING 06-04 04:27:12 scheduler.py:1484] Sequence group 786 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=51[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=415918)[0m WARNING 06-04 04:27:19 scheduler.py:1484] Sequence group 787 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=51[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m WARNING 06-04 04:29:25 scheduler.py:1484] Sequence group 727 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=101[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=415922)[0m WARNING 06-04 04:29:36 scheduler.py:1484] Sequence group 736 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=101[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m WARNING 06-04 04:29:49 scheduler.py:1484] Sequence group 731 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=101[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m WARNING 06-04 04:30:21 scheduler.py:1484] Sequence group 725 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=101[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m WARNING 06-04 04:30:35 scheduler.py:1484] Sequence group 722 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=101[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=415918)[0m WARNING 06-04 04:30:43 scheduler.py:1484] Sequence group 728 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=101[32m [repeated 2x across cluster][0m
[36m(main_task pid=415227)[0m Validation: Generation end.
[36m(WorkerDict pid=415919)[0m WARNING 06-04 04:30:43 scheduler.py:1484] Sequence group 728 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=101
[36m(main_task pid=415227)[0m step:20 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25161.000 - global_seqlen/max:35575.000 - global_seqlen/minmax_diff:10414.000 - global_seqlen/balanced_min:30590.000 - global_seqlen/balanced_max:30687.000 - global_seqlen/mean:30628.375 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.564 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.001 - actor/grad_norm:0.040 - mfu/actor:0.498 - actor/lr:0.000 - actor/sft_entropy_loss:0.722 - actor/sft_loss:0.708 - actor/sft_grad_norm:0.135 - mfu/sft_actor:6.469 - actor/sft_lr:0.000 - val/test_score/olympiad_bench:0.000 - val/test_score/math:0.000 - val/test_score/aime:0.000 - val/test_score/amc:0.000 - val/test_score/minerva:0.000 - avg_score:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7938.010 - response_length/max:8192.000 - response_length/min:137.000 - response_length/clip_ratio:0.937 - on_off_metrics/on_response_length_mean:7938.010 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:105.312 - prompt_length/max:324.000 - prompt_length/min:42.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:615.165 - timing_s/old_log_prob:48.593 - timing_s/adv:52.286 - timing_s/update_actor:205.230 - timing_s/sft_update_actor:18.669 - timing_s/testing:1092.062 - timing_s/step:1983.622 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.076 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:21 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:24243.000 - global_seqlen/max:43980.000 - global_seqlen/minmax_diff:19737.000 - global_seqlen/balanced_min:32404.000 - global_seqlen/balanced_max:32514.000 - global_seqlen/mean:32430.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.578 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.001 - actor/grad_norm:0.031 - mfu/actor:0.513 - actor/lr:0.000 - actor/sft_entropy_loss:0.658 - actor/sft_loss:0.659 - actor/sft_grad_norm:0.124 - mfu/sft_actor:5.958 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7959.455 - response_length/max:8192.000 - response_length/min:12.000 - response_length/clip_ratio:0.939 - on_off_metrics/on_response_length_mean:7959.455 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:110.367 - prompt_length/max:488.000 - prompt_length/min:38.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:597.589 - timing_s/old_log_prob:49.691 - timing_s/adv:53.321 - timing_s/update_actor:200.103 - timing_s/sft_update_actor:20.244 - timing_s/step:871.463 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.073 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:22 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:24436.000 - global_seqlen/max:38108.000 - global_seqlen/minmax_diff:13672.000 - global_seqlen/balanced_min:30983.000 - global_seqlen/balanced_max:31044.000 - global_seqlen/mean:31019.500 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.585 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.039 - mfu/actor:0.497 - actor/lr:0.000 - actor/sft_entropy_loss:0.691 - actor/sft_loss:0.688 - actor/sft_grad_norm:0.130 - mfu/sft_actor:4.297 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7900.260 - response_length/max:8192.000 - response_length/min:34.000 - response_length/clip_ratio:0.928 - on_off_metrics/on_response_length_mean:7900.260 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:101.289 - prompt_length/max:257.000 - prompt_length/min:45.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:588.597 - timing_s/old_log_prob:48.203 - timing_s/adv:51.945 - timing_s/update_actor:204.880 - timing_s/sft_update_actor:26.479 - timing_s/step:872.103 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.073 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:23 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:21783.000 - global_seqlen/max:39582.000 - global_seqlen/minmax_diff:17799.000 - global_seqlen/balanced_min:31177.000 - global_seqlen/balanced_max:31309.000 - global_seqlen/mean:31238.500 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.597 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.029 - mfu/actor:0.491 - actor/lr:0.000 - actor/sft_entropy_loss:0.619 - actor/sft_loss:0.639 - actor/sft_grad_norm:0.132 - mfu/sft_actor:5.348 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7894.687 - response_length/max:8192.000 - response_length/min:10.000 - response_length/clip_ratio:0.933 - on_off_metrics/on_response_length_mean:7894.687 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:94.828 - prompt_length/max:354.000 - prompt_length/min:39.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:595.889 - timing_s/old_log_prob:47.903 - timing_s/adv:51.460 - timing_s/update_actor:206.790 - timing_s/sft_update_actor:21.271 - timing_s/step:875.606 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:24 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22538.000 - global_seqlen/max:45541.000 - global_seqlen/minmax_diff:23003.000 - global_seqlen/balanced_min:33378.000 - global_seqlen/balanced_max:33435.000 - global_seqlen/mean:33410.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.608 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.019 - mfu/actor:0.494 - actor/lr:0.000 - actor/sft_entropy_loss:0.666 - actor/sft_loss:0.674 - actor/sft_grad_norm:0.121 - mfu/sft_actor:5.485 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7851.246 - response_length/max:8192.000 - response_length/min:31.000 - response_length/clip_ratio:0.926 - on_off_metrics/on_response_length_mean:7851.246 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:103.906 - prompt_length/max:542.000 - prompt_length/min:48.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:594.844 - timing_s/old_log_prob:47.622 - timing_s/adv:51.355 - timing_s/update_actor:204.927 - timing_s/sft_update_actor:20.923 - timing_s/step:872.209 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415922)[0m WARNING 06-04 05:44:47 scheduler.py:1484] Sequence group 906 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m WARNING 06-04 05:44:49 scheduler.py:1484] Sequence group 906 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415922)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:25 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:24801.000 - global_seqlen/max:36512.000 - global_seqlen/minmax_diff:11711.000 - global_seqlen/balanced_min:30788.000 - global_seqlen/balanced_max:30896.000 - global_seqlen/mean:30857.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.615 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.026 - mfu/actor:0.501 - actor/lr:0.000 - actor/sft_entropy_loss:0.673 - actor/sft_loss:0.676 - actor/sft_grad_norm:0.119 - mfu/sft_actor:5.668 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7946.026 - response_length/max:8192.000 - response_length/min:45.000 - response_length/clip_ratio:0.939 - on_off_metrics/on_response_length_mean:7946.026 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:104.711 - prompt_length/max:360.000 - prompt_length/min:34.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:601.403 - timing_s/old_log_prob:49.069 - timing_s/adv:52.700 - timing_s/update_actor:203.882 - timing_s/sft_update_actor:20.355 - timing_s/step:878.474 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=415919)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:26 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:24104.000 - global_seqlen/max:41517.000 - global_seqlen/minmax_diff:17413.000 - global_seqlen/balanced_min:32530.000 - global_seqlen/balanced_max:32605.000 - global_seqlen/mean:32557.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.624 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.020 - mfu/actor:0.508 - actor/lr:0.000 - actor/sft_entropy_loss:0.676 - actor/sft_loss:0.659 - actor/sft_grad_norm:0.113 - mfu/sft_actor:5.685 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7944.889 - response_length/max:8192.000 - response_length/min:16.000 - response_length/clip_ratio:0.939 - on_off_metrics/on_response_length_mean:7944.889 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:103.859 - prompt_length/max:412.000 - prompt_length/min:39.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:615.287 - timing_s/old_log_prob:56.488 - timing_s/adv:60.193 - timing_s/update_actor:201.637 - timing_s/sft_update_actor:20.520 - timing_s/step:897.781 - timing_per_token_ms/adv:0.007 - timing_per_token_ms/gen:0.076 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=415922)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m WARNING 06-04 06:13:36 scheduler.py:1484] Sequence group 939 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151
[36m(WorkerDict pid=415916)[0m WARNING 06-04 06:15:21 scheduler.py:1484] Sequence group 937 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m WARNING 06-04 06:15:21 scheduler.py:1484] Sequence group 937 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:27 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22434.000 - global_seqlen/max:39691.000 - global_seqlen/minmax_diff:17257.000 - global_seqlen/balanced_min:32348.000 - global_seqlen/balanced_max:32512.000 - global_seqlen/mean:32420.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.632 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.017 - mfu/actor:0.513 - actor/lr:0.000 - actor/sft_entropy_loss:0.649 - actor/sft_loss:0.645 - actor/sft_grad_norm:0.110 - mfu/sft_actor:4.893 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7958.007 - response_length/max:8192.000 - response_length/min:20.000 - response_length/clip_ratio:0.945 - on_off_metrics/on_response_length_mean:7958.007 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:109.617 - prompt_length/max:291.000 - prompt_length/min:36.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:608.444 - timing_s/old_log_prob:49.047 - timing_s/adv:52.709 - timing_s/update_actor:200.636 - timing_s/sft_update_actor:23.543 - timing_s/step:885.499 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.075 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m WARNING 06-04 06:28:40 scheduler.py:1484] Sequence group 955 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m WARNING 06-04 06:28:40 scheduler.py:1484] Sequence group 955 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:28 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25718.000 - global_seqlen/max:41393.000 - global_seqlen/minmax_diff:15675.000 - global_seqlen/balanced_min:30471.000 - global_seqlen/balanced_max:30594.000 - global_seqlen/mean:30535.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.638 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.014 - mfu/actor:0.516 - actor/lr:0.000 - actor/sft_entropy_loss:0.633 - actor/sft_loss:0.617 - actor/sft_grad_norm:0.109 - mfu/sft_actor:5.792 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7936.872 - response_length/max:8192.000 - response_length/min:9.000 - response_length/clip_ratio:0.940 - on_off_metrics/on_response_length_mean:7936.872 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:94.648 - prompt_length/max:229.000 - prompt_length/min:38.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:597.571 - timing_s/old_log_prob:47.842 - timing_s/adv:51.509 - timing_s/update_actor:197.770 - timing_s/sft_update_actor:20.248 - timing_s/step:867.262 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:29 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:23393.000 - global_seqlen/max:36799.000 - global_seqlen/minmax_diff:13406.000 - global_seqlen/balanced_min:29329.000 - global_seqlen/balanced_max:29416.000 - global_seqlen/mean:29359.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.643 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.013 - mfu/actor:0.514 - actor/lr:0.000 - actor/sft_entropy_loss:0.763 - actor/sft_loss:0.742 - actor/sft_grad_norm:0.109 - mfu/sft_actor:4.857 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7978.692 - response_length/max:8192.000 - response_length/min:49.000 - response_length/clip_ratio:0.946 - on_off_metrics/on_response_length_mean:7978.692 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:102.844 - prompt_length/max:308.000 - prompt_length/min:34.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:601.111 - timing_s/old_log_prob:48.465 - timing_s/adv:52.119 - timing_s/update_actor:200.033 - timing_s/sft_update_actor:23.330 - timing_s/step:876.803 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m WARNING 06-04 06:57:31 scheduler.py:1484] Sequence group 987 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m WARNING 06-04 06:57:31 scheduler.py:1484] Sequence group 987 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m WARNING 06-04 07:11:14 scheduler.py:1484] Sequence group 1239 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415918)[0m WARNING 06-04 07:11:28 scheduler.py:1484] Sequence group 1234 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=415922)[0m WARNING 06-04 07:12:46 scheduler.py:1484] Sequence group 1200 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=201[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=415920)[0m WARNING 06-04 07:13:15 scheduler.py:1484] Sequence group 1187 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=201[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m WARNING 06-04 07:13:27 scheduler.py:1484] Sequence group 1176 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=201[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m WARNING 06-04 07:13:40 scheduler.py:1484] Sequence group 1188 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=201[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m WARNING 06-04 07:13:56 scheduler.py:1484] Sequence group 1177 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=201[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m WARNING 06-04 07:14:46 scheduler.py:1484] Sequence group 1172 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=201[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=415918)[0m WARNING 06-04 07:14:55 scheduler.py:1484] Sequence group 1156 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=201[32m [repeated 2x across cluster][0m
[36m(main_task pid=415227)[0m Validation: Generation end.
[36m(WorkerDict pid=415919)[0m WARNING 06-04 07:14:55 scheduler.py:1484] Sequence group 1156 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=201
[36m(main_task pid=415227)[0m step:30 - batch/bef_solve_none:127.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:127.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.001 - batch/bef_failed:0.999 - batch/on_solved:0.001 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:486317.000 - global_seqlen/max:532328.000 - global_seqlen/minmax_diff:46011.000 - global_seqlen/balanced_min:516099.000 - global_seqlen/balanced_max:516346.000 - global_seqlen/mean:516179.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.000 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.645 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.076 - mfu/actor:0.499 - actor/lr:0.000 - val/test_score/aime:0.000 - val/test_score/olympiad_bench:0.012 - val/test_score/math:0.038 - val/test_score/amc:0.015 - val/test_score/minerva:0.004 - avg_score:0.014 - critic/score/mean:0.001 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.001 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.001 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:7962.137 - response_length/max:8192.000 - response_length/min:42.000 - response_length/clip_ratio:0.940 - on_off_metrics/on_response_length_mean:7962.137 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.001 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:103.172 - prompt_length/max:368.000 - prompt_length/min:44.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:606.453 - timing_s/old_log_prob:49.253 - timing_s/adv:52.998 - timing_s/update_actor:205.384 - timing_s/testing:948.386 - timing_s/step:1813.386 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=415227)[0m step:31 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:17810.000 - global_seqlen/max:39128.000 - global_seqlen/minmax_diff:21318.000 - global_seqlen/balanced_min:29897.000 - global_seqlen/balanced_max:29963.000 - global_seqlen/mean:29926.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.006 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.522 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.015 - mfu/actor:0.500 - actor/lr:0.000 - actor/sft_entropy_loss:0.748 - actor/sft_loss:0.718 - actor/sft_grad_norm:0.145 - mfu/sft_actor:4.853 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8000.023 - response_length/max:8192.000 - response_length/min:73.000 - response_length/clip_ratio:0.951 - on_off_metrics/on_response_length_mean:8000.023 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:92.203 - prompt_length/max:200.000 - prompt_length/min:39.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:600.299 - timing_s/old_log_prob:48.669 - timing_s/adv:52.342 - timing_s/update_actor:206.222 - timing_s/sft_update_actor:23.602 - timing_s/step:882.650 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.073 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415922)[0m WARNING 06-04 07:43:25 scheduler.py:1484] Sequence group 1271 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415923)[0m WARNING 06-04 07:43:25 scheduler.py:1484] Sequence group 1271 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415918)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:32 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25263.000 - global_seqlen/max:37633.000 - global_seqlen/minmax_diff:12370.000 - global_seqlen/balanced_min:31231.000 - global_seqlen/balanced_max:31328.000 - global_seqlen/mean:31293.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.012 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.426 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.011 - mfu/actor:0.516 - actor/lr:0.000 - actor/sft_entropy_loss:0.655 - actor/sft_loss:0.632 - actor/sft_grad_norm:0.148 - mfu/sft_actor:6.306 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:7942.185 - response_length/max:8192.000 - response_length/min:112.000 - response_length/clip_ratio:0.942 - on_off_metrics/on_response_length_mean:7942.185 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:97.961 - prompt_length/max:288.000 - prompt_length/min:34.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:595.035 - timing_s/old_log_prob:48.433 - timing_s/adv:52.104 - timing_s/update_actor:197.883 - timing_s/sft_update_actor:18.626 - timing_s/step:863.786 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.073 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m ERROR:2025-06-04 07:59:57,864:Error comparing (-2 <= a) & (a <= 6) and a <= 0
[36m(main_task pid=415227)[0m Traceback (most recent call last):
[36m(main_task pid=415227)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=415227)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=415227)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=415227)[0m     return func(*args, **kwargs)
[36m(main_task pid=415227)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=415227)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=415227)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=415227)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=415227)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=415227)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=415227)[0m AttributeError: 'LessThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=415921)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=415921)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415919)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415923)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:33 - batch/bef_solve_none:125.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:125.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.004 - batch/bef_failed:0.996 - batch/on_solved:0.004 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:26501.000 - global_seqlen/max:40969.000 - global_seqlen/minmax_diff:14468.000 - global_seqlen/balanced_min:33326.000 - global_seqlen/balanced_max:33433.000 - global_seqlen/mean:33380.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.003 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.049 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.769 - actor/pg_loss:-0.009 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.157 - mfu/actor:0.515 - actor/lr:0.000 - actor/sft_entropy_loss:0.748 - actor/sft_loss:0.704 - actor/sft_grad_norm:0.139 - mfu/sft_actor:4.625 - actor/sft_lr:0.000 - critic/score/mean:0.004 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.004 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.875 - critic/advantages/min:-0.250 - critic/returns/mean:-0.002 - critic/returns/max:0.875 - critic/returns/min:-0.250 - response_length/mean:7936.248 - response_length/max:8192.000 - response_length/min:393.000 - response_length/clip_ratio:0.940 - on_off_metrics/on_response_length_mean:7936.248 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.004 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:105.180 - prompt_length/max:439.000 - prompt_length/min:40.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:608.059 - timing_s/old_log_prob:49.194 - timing_s/adv:52.981 - timing_s/update_actor:198.539 - timing_s/sft_update_actor:24.826 - timing_s/step:884.548 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.075 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=415921)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:34 - batch/bef_solve_none:122.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:122.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.007 - batch/bef_failed:0.993 - batch/on_solved:0.007 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:23723.000 - global_seqlen/max:40168.000 - global_seqlen/minmax_diff:16445.000 - global_seqlen/balanced_min:32041.000 - global_seqlen/balanced_max:32180.000 - global_seqlen/mean:32078.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.005 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.123 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.386 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.001 - actor/grad_norm:0.245 - mfu/actor:0.514 - actor/lr:0.000 - actor/sft_entropy_loss:0.649 - actor/sft_loss:0.596 - actor/sft_grad_norm:0.184 - mfu/sft_actor:5.803 - actor/sft_lr:0.000 - critic/score/mean:0.007 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.007 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.875 - critic/advantages/min:-0.250 - critic/returns/mean:-0.003 - critic/returns/max:0.875 - critic/returns/min:-0.250 - response_length/mean:7928.400 - response_length/max:8192.000 - response_length/min:481.000 - response_length/clip_ratio:0.936 - on_off_metrics/on_response_length_mean:7928.400 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.007 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:98.359 - prompt_length/max:310.000 - prompt_length/min:38.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:595.771 - timing_s/old_log_prob:48.031 - timing_s/adv:52.283 - timing_s/update_actor:198.516 - timing_s/sft_update_actor:20.175 - timing_s/step:866.859 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.073 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717888, ip=30.207.97.111)[0m WARNING 06-04 08:26:42 scheduler.py:1484] Sequence group 1320 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
[36m(WorkerDict pid=415920)[0m WARNING 06-04 08:26:51 scheduler.py:1484] Sequence group 1320 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m WARNING 06-04 08:27:13 scheduler.py:1484] Sequence group 1319 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=717886, ip=30.207.97.111)[0m WARNING 06-04 08:27:13 scheduler.py:1484] Sequence group 1319 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415918)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=415922)[0m 
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415922)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:35 - batch/bef_solve_none:126.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:126.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.002 - batch/bef_failed:0.998 - batch/on_solved:0.002 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25751.000 - global_seqlen/max:40359.000 - global_seqlen/minmax_diff:14608.000 - global_seqlen/balanced_min:31359.000 - global_seqlen/balanced_max:31431.000 - global_seqlen/mean:31387.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.098 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.779 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.169 - mfu/actor:0.504 - actor/lr:0.000 - actor/sft_entropy_loss:0.799 - actor/sft_loss:0.713 - actor/sft_grad_norm:0.251 - mfu/sft_actor:4.362 - actor/sft_lr:0.000 - critic/score/mean:0.002 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.002 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.000 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:7995.634 - response_length/max:8192.000 - response_length/min:983.000 - response_length/clip_ratio:0.950 - on_off_metrics/on_response_length_mean:7995.634 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.002 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:102.961 - prompt_length/max:309.000 - prompt_length/min:33.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:616.726 - timing_s/old_log_prob:48.650 - timing_s/adv:52.754 - timing_s/update_actor:204.229 - timing_s/sft_update_actor:26.191 - timing_s/step:900.064 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.075 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m WARNING 06-04 08:42:27 scheduler.py:1484] Sequence group 1335 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m WARNING 06-04 08:42:27 scheduler.py:1484] Sequence group 1335 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415919)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:36 - batch/bef_solve_none:126.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:126.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.002 - batch/bef_failed:0.998 - batch/on_solved:0.002 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:19189.000 - global_seqlen/max:43962.000 - global_seqlen/minmax_diff:24773.000 - global_seqlen/balanced_min:31686.000 - global_seqlen/balanced_max:31829.000 - global_seqlen/mean:31757.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.065 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.414 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.001 - actor/grad_norm:0.104 - mfu/actor:0.518 - actor/lr:0.000 - actor/sft_entropy_loss:0.752 - actor/sft_loss:0.637 - actor/sft_grad_norm:0.297 - mfu/sft_actor:5.973 - actor/sft_lr:0.000 - critic/score/mean:0.002 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.002 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.001 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:7986.573 - response_length/max:8192.000 - response_length/min:2.000 - response_length/clip_ratio:0.957 - on_off_metrics/on_response_length_mean:7986.573 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.002 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:105.141 - prompt_length/max:929.000 - prompt_length/min:36.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:608.699 - timing_s/old_log_prob:49.910 - timing_s/adv:53.610 - timing_s/update_actor:198.646 - timing_s/sft_update_actor:19.612 - timing_s/step:880.765 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:37 - batch/bef_solve_none:126.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:126.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.002 - batch/bef_failed:0.998 - batch/on_solved:0.002 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:24848.000 - global_seqlen/max:38728.000 - global_seqlen/minmax_diff:13880.000 - global_seqlen/balanced_min:30278.000 - global_seqlen/balanced_max:30405.000 - global_seqlen/mean:30341.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.045 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.774 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.001 - actor/grad_norm:0.107 - mfu/actor:0.495 - actor/lr:0.000 - actor/sft_entropy_loss:0.701 - actor/sft_loss:0.596 - actor/sft_grad_norm:0.309 - mfu/sft_actor:5.854 - actor/sft_lr:0.000 - critic/score/mean:0.002 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.002 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.001 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8059.984 - response_length/max:8192.000 - response_length/min:645.000 - response_length/clip_ratio:0.964 - on_off_metrics/on_response_length_mean:8059.984 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.002 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:98.758 - prompt_length/max:260.000 - prompt_length/min:41.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:630.256 - timing_s/old_log_prob:48.840 - timing_s/adv:52.592 - timing_s/update_actor:210.238 - timing_s/sft_update_actor:20.318 - timing_s/step:913.543 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.076 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m WARNING 06-04 09:11:58 scheduler.py:1484] Sequence group 1367 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m WARNING 06-04 09:11:58 scheduler.py:1484] Sequence group 1367 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
[36m(WorkerDict pid=415916)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415923)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415920)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717887, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717886, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:38 - batch/bef_solve_none:124.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:124.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.004 - batch/bef_failed:0.996 - batch/on_solved:0.004 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:21666.000 - global_seqlen/max:40159.000 - global_seqlen/minmax_diff:18493.000 - global_seqlen/balanced_min:32148.000 - global_seqlen/balanced_max:32208.000 - global_seqlen/mean:32174.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.001 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.040 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.905 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.118 - mfu/actor:0.512 - actor/lr:0.000 - actor/sft_entropy_loss:0.835 - actor/sft_loss:0.723 - actor/sft_grad_norm:0.278 - mfu/sft_actor:5.614 - actor/sft_lr:0.000 - critic/score/mean:0.004 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.004 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.003 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8012.392 - response_length/max:8192.000 - response_length/min:358.000 - response_length/clip_ratio:0.959 - on_off_metrics/on_response_length_mean:8012.392 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.004 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:96.289 - prompt_length/max:261.000 - prompt_length/min:32.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:618.758 - timing_s/old_log_prob:49.221 - timing_s/adv:53.174 - timing_s/update_actor:201.518 - timing_s/sft_update_actor:20.916 - timing_s/step:894.541 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.075 - timing_per_token_ms/update_actor:0.024
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717883, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=415920)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415917)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP
[36m(WorkerDict pid=415917)[0m MICROBATCH STEP
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717886, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717889, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=717751, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415916)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=415921)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=415921)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=415227)[0m step:39 - batch/bef_solve_none:123.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:123.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.009 - batch/bef_failed:0.991 - batch/on_solved:0.009 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:26889.000 - global_seqlen/max:43185.000 - global_seqlen/minmax_diff:16296.000 - global_seqlen/balanced_min:34535.000 - global_seqlen/balanced_max:34620.000 - global_seqlen/mean:34580.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.010 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.053 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.719 - actor/pg_loss:0.033 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.189 - mfu/actor:0.505 - actor/lr:0.000 - actor/sft_entropy_loss:0.738 - actor/sft_loss:0.654 - actor/sft_grad_norm:0.241 - mfu/sft_actor:4.524 - actor/sft_lr:0.000 - critic/score/mean:0.009 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.009 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.875 - critic/advantages/min:-0.375 - critic/returns/mean:-0.005 - critic/returns/max:0.875 - critic/returns/min:-0.375 - response_length/mean:7806.993 - response_length/max:8192.000 - response_length/min:2.000 - response_length/clip_ratio:0.923 - on_off_metrics/on_response_length_mean:7806.993 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.009 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:113.086 - prompt_length/max:793.000 - prompt_length/min:38.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:593.390 - timing_s/old_log_prob:48.364 - timing_s/adv:52.649 - timing_s/update_actor:199.421 - timing_s/sft_update_actor:24.365 - timing_s/step:869.976 - timing_per_token_ms/adv:0.006 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.025
[36m(WorkerDict pid=415923)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=717885, ip=30.207.97.111)[0m WARNING 06-04 09:41:55 scheduler.py:1484] Sequence group 1399 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
Traceback (most recent call last):
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/jizhicfs/hymiezhao/ml/reasoning/LUFFY/luffy/verl/verl/src_interleave_sft/main_mix_ppo.py", line 248, in <module>
    main()
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/jizhicfs/hymiezhao/ml/reasoning/LUFFY/luffy/verl/verl/src_interleave_sft/main_mix_ppo.py", line 143, in main
    ray.get(main_task.remote(config))
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/worker.py", line 2623, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/worker.py", line 840, in get_objects
    data_metadata_pairs = self.core_worker.get_objects(
  File "python/ray/_raylet.pyx", line 3481, in ray._raylet.CoreWorker.get_objects
  File "python/ray/_raylet.pyx", line 571, in ray._raylet.check_status
KeyboardInterrupt
[36m(WorkerDict pid=717884, ip=30.207.97.111)[0m WARNING 06-04 09:41:55 scheduler.py:1484] Sequence group 1399 is preempted by PreemptionMode.SWAP mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
Exception ignored in atexit callback: <function shutdown at 0x7fb888ea0c10>
Traceback (most recent call last):
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/worker.py", line 1826, in shutdown
    global_worker.core_worker.shutdown_driver()
KeyboardInterrupt: 
