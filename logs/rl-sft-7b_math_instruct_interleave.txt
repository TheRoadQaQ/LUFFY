2025-06-03 14:38:01,173	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 30.207.97.15:6379...
2025-06-03 14:38:01,183	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(main_task pid=405478)[0m {'actor_rollout_ref': {'actor': {'adaptive_temperature_clip': -1,
[36m(main_task pid=405478)[0m                                  'adaptive_temperature_target_entropy': 1.0,
[36m(main_task pid=405478)[0m                                  'all_max_clip': -1,
[36m(main_task pid=405478)[0m                                  'alpha_lr': 0.01,
[36m(main_task pid=405478)[0m                                  'clip_ratio': 0.2,
[36m(main_task pid=405478)[0m                                  'clip_upper_bound': 1.0,
[36m(main_task pid=405478)[0m                                  'debug': False,
[36m(main_task pid=405478)[0m                                  'entropy_coeff': 0.001,
[36m(main_task pid=405478)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=405478)[0m                                                  'grad_offload': False,
[36m(main_task pid=405478)[0m                                                  'optimizer_offload': True,
[36m(main_task pid=405478)[0m                                                  'param_offload': False,
[36m(main_task pid=405478)[0m                                                  'sft_optimizer_offload': True,
[36m(main_task pid=405478)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=405478)[0m                                  'grad_clip': 0.7,
[36m(main_task pid=405478)[0m                                  'kl_loss_coef': 0.0,
[36m(main_task pid=405478)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(main_task pid=405478)[0m                                  'loss_remove_clip': True,
[36m(main_task pid=405478)[0m                                  'loss_remove_token_mean': True,
[36m(main_task pid=405478)[0m                                  'off_policy_cliprange': 0.2,
[36m(main_task pid=405478)[0m                                  'off_policy_loss_impl': 'token',
[36m(main_task pid=405478)[0m                                  'off_policy_max_clip': -1,
[36m(main_task pid=405478)[0m                                  'off_policy_min_clip': -1,
[36m(main_task pid=405478)[0m                                  'off_policy_normalize': False,
[36m(main_task pid=405478)[0m                                  'off_policy_reshape': 'p_div_p_0.1',
[36m(main_task pid=405478)[0m                                  'off_policy_reshape_pow_exp': 0.5,
[36m(main_task pid=405478)[0m                                  'off_policy_reshape_weight': 0.1,
[36m(main_task pid=405478)[0m                                  'on_policy_reshape': 'no_reshape',
[36m(main_task pid=405478)[0m                                  'on_policy_reshape_pow_exp': 0.5,
[36m(main_task pid=405478)[0m                                  'on_policy_reshape_weight': 0.1,
[36m(main_task pid=405478)[0m                                  'optim': {'lr': 1e-06,
[36m(main_task pid=405478)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(main_task pid=405478)[0m                                            'min_lr_ratio': None,
[36m(main_task pid=405478)[0m                                            'sft': {'lr': 1e-06,
[36m(main_task pid=405478)[0m                                                    'same_or_not': False},
[36m(main_task pid=405478)[0m                                            'total_training_steps': -1,
[36m(main_task pid=405478)[0m                                            'warmup_style': 'constant'},
[36m(main_task pid=405478)[0m                                  'ppo_epochs': 1,
[36m(main_task pid=405478)[0m                                  'ppo_kl_loss_coef': 0.01,
[36m(main_task pid=405478)[0m                                  'ppo_max_token_len_per_gpu': 32768,
[36m(main_task pid=405478)[0m                                  'ppo_micro_batch_size': 64,
[36m(main_task pid=405478)[0m                                  'ppo_mini_batch_size': 64,
[36m(main_task pid=405478)[0m                                  'sft': {'entropy_coeff': 0.001,
[36m(main_task pid=405478)[0m                                          'sft_data_size': 128,
[36m(main_task pid=405478)[0m                                          'sft_epochs': 1,
[36m(main_task pid=405478)[0m                                          'sft_micro_batch_size': 16,
[36m(main_task pid=405478)[0m                                          'sft_mini_batch_size': 128},
[36m(main_task pid=405478)[0m                                  'sft_prefix_reward_weight': 1.0,
[36m(main_task pid=405478)[0m                                  'shuffle': False,
[36m(main_task pid=405478)[0m                                  'strategy': 'fsdp',
[36m(main_task pid=405478)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=405478)[0m                                  'use_adaptive_temperature': False,
[36m(main_task pid=405478)[0m                                  'use_adaptive_temperature_fixed': False,
[36m(main_task pid=405478)[0m                                  'use_dynamic_bsz': True,
[36m(main_task pid=405478)[0m                                  'use_kl_loss': False,
[36m(main_task pid=405478)[0m                                  'use_off_policy_clip': False,
[36m(main_task pid=405478)[0m                                  'use_off_policy_loss': True,
[36m(main_task pid=405478)[0m                                  'use_off_policy_probs': False,
[36m(main_task pid=405478)[0m                                  'use_ppo_kl_loss': False,
[36m(main_task pid=405478)[0m                                  'use_sft_prefix_reward': False,
[36m(main_task pid=405478)[0m                                  'use_sft_reward': False,
[36m(main_task pid=405478)[0m                                  'use_target_lst': False},
[36m(main_task pid=405478)[0m                        'hybrid_engine': True,
[36m(main_task pid=405478)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(main_task pid=405478)[0m                                  'external_lib': None,
[36m(main_task pid=405478)[0m                                  'override_config': {},
[36m(main_task pid=405478)[0m                                  'path': '/jizhicfs/hymiezhao/models/Qwen2.5-Math-7B-Instruct-16-think',
[36m(main_task pid=405478)[0m                                  'use_remove_padding': True},
[36m(main_task pid=405478)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(main_task pid=405478)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=405478)[0m                                'log_prob_max_token_len_per_gpu': 32768,
[36m(main_task pid=405478)[0m                                'log_prob_micro_batch_size': 128,
[36m(main_task pid=405478)[0m                                'log_prob_use_dynamic_bsz': True,
[36m(main_task pid=405478)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=405478)[0m                                'use_ref': False},
[36m(main_task pid=405478)[0m                        'rollout': {'do_sample': True,
[36m(main_task pid=405478)[0m                                    'dtype': 'bfloat16',
[36m(main_task pid=405478)[0m                                    'enable_chunked_prefill': True,
[36m(main_task pid=405478)[0m                                    'enforce_eager': True,
[36m(main_task pid=405478)[0m                                    'free_cache_engine': True,
[36m(main_task pid=405478)[0m                                    'gpu_memory_utilization': 0.8,
[36m(main_task pid=405478)[0m                                    'ignore_eos': False,
[36m(main_task pid=405478)[0m                                    'load_format': 'dummy_dtensor',
[36m(main_task pid=405478)[0m                                    'log_prob_max_token_len_per_gpu': 32768,
[36m(main_task pid=405478)[0m                                    'log_prob_micro_batch_size': 128,
[36m(main_task pid=405478)[0m                                    'log_prob_use_dynamic_bsz': True,
[36m(main_task pid=405478)[0m                                    'max_num_batched_tokens': 8192,
[36m(main_task pid=405478)[0m                                    'max_num_seqs': 1024,
[36m(main_task pid=405478)[0m                                    'max_prefix_len': 8192,
[36m(main_task pid=405478)[0m                                    'max_prefix_ratio': 1.0,
[36m(main_task pid=405478)[0m                                    'min_prefix_ratio': 0.0,
[36m(main_task pid=405478)[0m                                    'n': 8,
[36m(main_task pid=405478)[0m                                    'n_prefix': 1,
[36m(main_task pid=405478)[0m                                    'n_val': 1,
[36m(main_task pid=405478)[0m                                    'name': 'vllm',
[36m(main_task pid=405478)[0m                                    'prefix_linear_max_ratio': 0.8,
[36m(main_task pid=405478)[0m                                    'prefix_linear_max_var': 0.1,
[36m(main_task pid=405478)[0m                                    'prefix_reward_strategy': 'all',
[36m(main_task pid=405478)[0m                                    'prefix_reward_weight_alpha': 1.0,
[36m(main_task pid=405478)[0m                                    'prefix_reward_weight_beta': 1.0,
[36m(main_task pid=405478)[0m                                    'prefix_share_across_samples': False,
[36m(main_task pid=405478)[0m                                    'prefix_steps': 1000,
[36m(main_task pid=405478)[0m                                    'prefix_strategy': 'random',
[36m(main_task pid=405478)[0m                                    'prompt_length': 1024,
[36m(main_task pid=405478)[0m                                    'response_length': 8192,
[36m(main_task pid=405478)[0m                                    'temperature': 1.0,
[36m(main_task pid=405478)[0m                                    'tensor_model_parallel_size': 2,
[36m(main_task pid=405478)[0m                                    'top_k': -1,
[36m(main_task pid=405478)[0m                                    'top_p': 1,
[36m(main_task pid=405478)[0m                                    'val_temperature': 0.6}},
[36m(main_task pid=405478)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(main_task pid=405478)[0m                'gamma': 1.0,
[36m(main_task pid=405478)[0m                'grpo_use_std': False,
[36m(main_task pid=405478)[0m                'kl_ctrl': {'kl_coef': 0.0, 'type': 'fixed'},
[36m(main_task pid=405478)[0m                'kl_penalty': 'kl',
[36m(main_task pid=405478)[0m                'lam': 1.0,
[36m(main_task pid=405478)[0m                'surprisal_base': 0.0},
[36m(main_task pid=405478)[0m  'critic': {'cliprange_value': 0.5,
[36m(main_task pid=405478)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(main_task pid=405478)[0m             'forward_micro_batch_size': 64,
[36m(main_task pid=405478)[0m             'grad_clip': 1.0,
[36m(main_task pid=405478)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(main_task pid=405478)[0m                       'external_lib': None,
[36m(main_task pid=405478)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=405478)[0m                                       'grad_offload': False,
[36m(main_task pid=405478)[0m                                       'optimizer_offload': False,
[36m(main_task pid=405478)[0m                                       'param_offload': False,
[36m(main_task pid=405478)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=405478)[0m                       'override_config': {},
[36m(main_task pid=405478)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(main_task pid=405478)[0m                       'tokenizer_path': '/jizhicfs/hymiezhao/models/Qwen2.5-Math-7B-Instruct-16-think',
[36m(main_task pid=405478)[0m                       'use_remove_padding': False},
[36m(main_task pid=405478)[0m             'optim': {'lr': 1e-05,
[36m(main_task pid=405478)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(main_task pid=405478)[0m                       'min_lr_ratio': None,
[36m(main_task pid=405478)[0m                       'total_training_steps': -1,
[36m(main_task pid=405478)[0m                       'warmup_style': 'constant'},
[36m(main_task pid=405478)[0m             'ppo_epochs': 1,
[36m(main_task pid=405478)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(main_task pid=405478)[0m             'ppo_micro_batch_size': 64,
[36m(main_task pid=405478)[0m             'ppo_mini_batch_size': 64,
[36m(main_task pid=405478)[0m             'shuffle': False,
[36m(main_task pid=405478)[0m             'strategy': 'fsdp',
[36m(main_task pid=405478)[0m             'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=405478)[0m             'use_dynamic_bsz': True},
[36m(main_task pid=405478)[0m  'data': {'accuracy_lower_bound': 0.0,
[36m(main_task pid=405478)[0m           'accuracy_upper_bound': 1.0,
[36m(main_task pid=405478)[0m           'add_tgt_acc_upper_bound': 0.5,
[36m(main_task pid=405478)[0m           'add_tgt_with_acc': False,
[36m(main_task pid=405478)[0m           'disable_truncation_advantage': False,
[36m(main_task pid=405478)[0m           'filter_accuracy': False,
[36m(main_task pid=405478)[0m           'filter_targets': False,
[36m(main_task pid=405478)[0m           'max_prompt_length': 1024,
[36m(main_task pid=405478)[0m           'max_response_length': 8192,
[36m(main_task pid=405478)[0m           'prompt_key': 'prompt',
[36m(main_task pid=405478)[0m           'return_raw_chat': False,
[36m(main_task pid=405478)[0m           'return_raw_input_ids': False,
[36m(main_task pid=405478)[0m           'reward_impl_version': 3,
[36m(main_task pid=405478)[0m           'sample_target_ratio': 1.0,
[36m(main_task pid=405478)[0m           'shuffle': True,
[36m(main_task pid=405478)[0m           'tokenizer': None,
[36m(main_task pid=405478)[0m           'train_batch_size': 128,
[36m(main_task pid=405478)[0m           'train_files': './dataset//openr1.parquet',
[36m(main_task pid=405478)[0m           'val_batch_size': 512,
[36m(main_task pid=405478)[0m           'val_files': './dataset//valid.parquet'},
[36m(main_task pid=405478)[0m  'reward_model': {'enable': False,
[36m(main_task pid=405478)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(main_task pid=405478)[0m                   'max_length': None,
[36m(main_task pid=405478)[0m                   'micro_batch_size': 64,
[36m(main_task pid=405478)[0m                   'model': {'external_lib': None,
[36m(main_task pid=405478)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=405478)[0m                                             'min_num_params': 0,
[36m(main_task pid=405478)[0m                                             'param_offload': False},
[36m(main_task pid=405478)[0m                             'input_tokenizer': '/jizhicfs/hymiezhao/models/Qwen2.5-Math-7B-Instruct-16-think',
[36m(main_task pid=405478)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(main_task pid=405478)[0m                             'use_remove_padding': False},
[36m(main_task pid=405478)[0m                   'strategy': 'fsdp',
[36m(main_task pid=405478)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=405478)[0m                   'use_dynamic_bsz': True},
[36m(main_task pid=405478)[0m  'sft': {'buffer_type': 'solve_none'},
[36m(main_task pid=405478)[0m  'trainer': {'acc_rebatch': False,
[36m(main_task pid=405478)[0m              'add_full_target_when_none': False,
[36m(main_task pid=405478)[0m              'critic_warmup': 0,
[36m(main_task pid=405478)[0m              'debug': False,
[36m(main_task pid=405478)[0m              'default_hdfs_dir': None,
[36m(main_task pid=405478)[0m              'default_local_dir': './train_results/rl-sft/7b_math_instruct_interleave',
[36m(main_task pid=405478)[0m              'experiment_name': '7b_math_instruct_interleave',
[36m(main_task pid=405478)[0m              'logger': ['console', 'wandb'],
[36m(main_task pid=405478)[0m              'max_optim_to_keep': 2,
[36m(main_task pid=405478)[0m              'n_gpus_per_node': 8,
[36m(main_task pid=405478)[0m              'nnodes': 2,
[36m(main_task pid=405478)[0m              'project_name': 'rl-sft',
[36m(main_task pid=405478)[0m              'rejection_sample': False,
[36m(main_task pid=405478)[0m              'rejection_sample_multiplier': 2,
[36m(main_task pid=405478)[0m              'resume_from_path': False,
[36m(main_task pid=405478)[0m              'resume_mode': 'auto',
[36m(main_task pid=405478)[0m              'save_freq': -1,
[36m(main_task pid=405478)[0m              'skip_by_step': False,
[36m(main_task pid=405478)[0m              'skip_valid_mask': False,
[36m(main_task pid=405478)[0m              'test_freq': 10,
[36m(main_task pid=405478)[0m              'total_epochs': 3,
[36m(main_task pid=405478)[0m              'total_training_steps': None,
[36m(main_task pid=405478)[0m              'val_before_train': False}}
[36m(main_task pid=405478)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(main_task pid=405478)[0m No module named 'vllm._version'
[36m(main_task pid=405478)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(main_task pid=405478)[0m original dataset len: 45792
[36m(main_task pid=405478)[0m filter dataset len: 45764
[36m(main_task pid=405478)[0m original dataset len: 2019
[36m(main_task pid=405478)[0m filter dataset len: 2017
[36m(main_task pid=405478)[0m Size of train dataloader: 357
[36m(main_task pid=405478)[0m Size of val dataloader: 1
[36m(main_task pid=405478)[0m Total training steps: 1071
[36m(pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=693598, ip=30.207.97.111)[0m No module named 'vllm._version'
[36m(pid=693598, ip=30.207.97.111)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(pid=693735, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=693735, ip=30.207.97.111)[0m No module named 'vllm._version'
[36m(pid=693735, ip=30.207.97.111)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  3.71it/s]
[36m(pid=693736, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:[32m [repeated 6x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(pid=693736, ip=30.207.97.111)[0m No module named 'vllm._version'[32m [repeated 6x across cluster][0m
[36m(pid=693736, ip=30.207.97.111)[0m   from vllm.version import __version__ as VLLM_VERSION[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  3.94it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  3.86it/s]
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s][32m [repeated 20x across cluster][0m
[36m(pid=406157)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=406157)[0m No module named 'vllm._version'
[36m(pid=406157)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  6.13it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  5.85it/s][32m [repeated 6x across cluster][0m
[36m(pid=406156)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=406156)[0m No module named 'vllm._version'
[36m(pid=406156)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(WorkerDict pid=406155)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=406155)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=406157)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=406157)[0m Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  4.24it/s]
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "_name_or_path": "/jizhicfs/hymiezhao/models/Qwen2.5-Math-7B-Instruct-16-think",
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "architectures": [
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   ],
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "max_position_embeddings": 16384,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "rope_scaling": null,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "rope_theta": 40000.0,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "sliding_window": null,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "transformers_version": "4.46.3",
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "use_cache": true,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "use_mrope": false,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   "vocab_size": 152064
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m }
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m 
[36m(WorkerDict pid=406157)[0m Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  4.53it/s]
[36m(WorkerDict pid=406157)[0m Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  4.62it/s]
[36m(WorkerDict pid=406155)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=406157)[0m Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  4.88it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  4.73it/s]
[36m(pid=406161)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:[32m [repeated 6x across cluster][0m
[36m(pid=406161)[0m No module named 'vllm._version'[32m [repeated 6x across cluster][0m
[36m(pid=406161)[0m   from vllm.version import __version__ as VLLM_VERSION[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=406161)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=406161)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:16,  5.42s/it][32m [repeated 22x across cluster][0m
[36m(WorkerDict pid=406161)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=406160)[0m Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  4.14it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  4.04it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Loading checkpoint shards:  50%|█████     | 2/4 [00:10<00:10,  5.31s/it]
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Loading checkpoint shards:  75%|███████▌  | 3/4 [00:15<00:05,  5.25s/it]
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  4.96s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  5.09s/it]
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m wrap_policy: functools.partial(<function transformer_auto_wrap_policy at 0x7f6368656d40>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m Total steps: 1071, num_warmup_steps: 0
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Before building vllm rollout, memory allocated (GB): 1.785170555114746, memory reserved (GB): 1.787109375
[36m(WorkerDict pid=406161)[0m wrap_policy: functools.partial(<function transformer_auto_wrap_policy at 0x7f91dc3f6d40>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m INFO 06-03 14:42:18 config.py:887] Defaulting to use ray for distributed inference
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m INFO 06-03 14:42:18 config.py:1005] Chunked prefill is enabled with max_num_batched_tokens=8192.
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m WARNING 06-03 14:42:18 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Total steps: 1071, num_warmup_steps: 0[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m Actor use_remove_padding=True[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m local rank 0
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m INFO 06-03 14:42:18 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:211: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m   @torch.library.impl_abstract("xformers_flash::flash_fwd")
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m   @torch.library.impl_abstract("xformers_flash::flash_bwd")
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:344: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m   @torch.library.impl_abstract("xformers_flash::flash_fwd")[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m INFO 06-03 14:42:30 utils.py:1008] Found nccl from library libnccl.so.2
[36m(WorkerDict pid=406155)[0m INFO 06-03 14:42:30 pynccl.py:63] vLLM is using nccl==2.20.5
[36m(WorkerDict pid=406155)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=406159)[0m INFO 06-03 14:42:21 config.py:887] Defaulting to use ray for distributed inference[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m INFO 06-03 14:42:21 config.py:1005] Chunked prefill is enabled with max_num_batched_tokens=8192.[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m WARNING 06-03 14:42:21 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m local rank 0[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m INFO 06-03 14:42:22 selector.py:115] Using XFormers backend.[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406157)[0m INFO 06-03 14:42:31 shm_broadcast.py:241] vLLM message queue communication handle: Handle(connect_ip='127.0.0.1', local_reader_ranks=[1], buffer=<vllm.distributed.device_communicators.shm_broadcast.ShmRingBuffer object at 0x7f81bce0afb0>, local_subscribe_port=58633, remote_subscribe_port=None)
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m before init cache memory allocated: 9.56789504GB, reserved: 9.669967872GB
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m INFO 06-03 14:42:30 utils.py:1008] Found nccl from library libnccl.so.2[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m INFO 06-03 14:42:30 pynccl.py:63] vLLM is using nccl==2.20.5[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m NCCL version 2.20.5+cuda12.4[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m INFO 06-03 14:42:33 selector.py:115] Using XFormers backend.[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m INFO 06-03 14:42:33 shm_broadcast.py:241] vLLM message queue communication handle: Handle(connect_ip='127.0.0.1', local_reader_ranks=[1], buffer=<vllm.distributed.device_communicators.shm_broadcast.ShmRingBuffer object at 0x7f5d60165e70>, local_subscribe_port=35635, remote_subscribe_port=None)[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=406157)[0m kwargs: {'n': 8, 'logprobs': 1, 'max_tokens': 8192, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=406157)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=406157)[0m   warnings.warn(
[36m(WorkerDict pid=406159)[0m   @torch.library.impl_abstract("xformers_flash::flash_bwd")[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:344: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m kwargs: {'n': 8, 'logprobs': 1, 'max_tokens': 8192, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 5x across cluster][0m
[36m(WorkerDict pid=406159)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 5x across cluster][0m
[36m(WorkerDict pid=406159)[0m   warnings.warn([32m [repeated 5x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m kwargs: {'n': 8, 'logprobs': 1, 'max_tokens': 8192, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m   warnings.warn([32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m after init cache memory allocated: 66.409102848GB, reserved: 66.51117568GB
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m After building vllm rollout, memory allocated (GB): 54.73451471328735, memory reserved (GB): 61.943359375
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m After building sharding manager, memory allocated (GB): 54.73451471328735, memory reserved (GB): 61.943359375
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m kwargs: {'n': 8, 'logprobs': 1, 'max_tokens': 8192, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(main_task pid=405478)[0m wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
[36m(main_task pid=405478)[0m wandb: Currently logged in as: maluqaq (theroadqaq). Use `wandb login --relogin` to force relogin
[36m(main_task pid=405478)[0m wandb: Tracking run with wandb version 0.19.1
[36m(main_task pid=405478)[0m wandb: Run data is saved locally in /jizhicfs/hymiezhao/ml/reasoning/LUFFY/wandb/run-20250603_144402-r2hryte8
[36m(main_task pid=405478)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(main_task pid=405478)[0m wandb: Syncing run 7b_math_instruct_interleave
[36m(main_task pid=405478)[0m wandb: ⭐️ View project at https://wandb.ai/theroadqaq/rl-sft
[36m(main_task pid=405478)[0m wandb: 🚀 View run at https://wandb.ai/theroadqaq/rl-sft/runs/r2hryte8
[36m(main_task pid=405478)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(main_task pid=405478)[0m Checkpoint tracker file does not exist: %s /jizhicfs/hymiezhao/ml/reasoning/LUFFY/./train_results/rl-sft/7b_math_instruct_interleave/latest_checkpointed_iteration.txt
[36m(main_task pid=405478)[0m Training from scratch
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:1 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:27618.000 - global_seqlen/max:48916.000 - global_seqlen/minmax_diff:21298.000 - global_seqlen/balanced_min:35559.000 - global_seqlen/balanced_max:35637.000 - global_seqlen/mean:35600.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.007 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.473 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.015 - mfu/actor:0.524 - actor/lr:0.000 - actor/sft_entropy_loss:7.265 - actor/sft_loss:2.709 - actor/sft_grad_norm:3.771 - mfu/sft_actor:8.243 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8149.832 - response_length/max:8192.000 - response_length/min:211.000 - response_length/clip_ratio:0.994 - on_off_metrics/on_response_length_mean:8149.832 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:238.711 - prompt_length/max:546.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:461.650 - timing_s/old_log_prob:47.138 - timing_s/adv:50.277 - timing_s/update_actor:187.130 - timing_s/sft_update_actor:18.707 - timing_s/step:717.955 - timing_per_token_ms/gen:0.055 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406160)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:2 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25462.000 - global_seqlen/max:41568.000 - global_seqlen/minmax_diff:16106.000 - global_seqlen/balanced_min:33377.000 - global_seqlen/balanced_max:33416.000 - global_seqlen/mean:33395.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.010 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.431 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.015 - mfu/actor:0.528 - actor/lr:0.000 - actor/sft_entropy_loss:6.985 - actor/sft_loss:2.980 - actor/sft_grad_norm:3.623 - mfu/sft_actor:7.471 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8150.318 - response_length/max:8192.000 - response_length/min:651.000 - response_length/clip_ratio:0.993 - on_off_metrics/on_response_length_mean:8150.318 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:247.023 - prompt_length/max:448.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:508.721 - timing_s/old_log_prob:45.517 - timing_s/adv:48.617 - timing_s/update_actor:185.232 - timing_s/sft_update_actor:15.417 - timing_s/step:758.172 - timing_per_token_ms/gen:0.061 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:3 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:26768.000 - global_seqlen/max:41720.000 - global_seqlen/minmax_diff:14952.000 - global_seqlen/balanced_min:33857.000 - global_seqlen/balanced_max:33962.000 - global_seqlen/mean:33909.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.015 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.385 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.015 - mfu/actor:0.525 - actor/lr:0.000 - actor/sft_entropy_loss:7.042 - actor/sft_loss:2.529 - actor/sft_grad_norm:3.702 - mfu/sft_actor:6.931 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8166.652 - response_length/max:8192.000 - response_length/min:381.000 - response_length/clip_ratio:0.995 - on_off_metrics/on_response_length_mean:8166.652 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.625 - prompt_length/max:369.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:505.293 - timing_s/old_log_prob:46.621 - timing_s/adv:49.885 - timing_s/update_actor:187.233 - timing_s/sft_update_actor:16.797 - timing_s/step:759.424 - timing_per_token_ms/gen:0.060 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406162)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:4 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25179.000 - global_seqlen/max:39882.000 - global_seqlen/minmax_diff:14703.000 - global_seqlen/balanced_min:32836.000 - global_seqlen/balanced_max:32891.000 - global_seqlen/mean:32851.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.022 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.308 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.015 - mfu/actor:0.514 - actor/lr:0.000 - actor/sft_entropy_loss:5.743 - actor/sft_loss:2.028 - actor/sft_grad_norm:3.240 - mfu/sft_actor:7.711 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8133.775 - response_length/max:8192.000 - response_length/min:404.000 - response_length/clip_ratio:0.991 - on_off_metrics/on_response_length_mean:8133.775 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.227 - prompt_length/max:488.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:436.246 - timing_s/old_log_prob:45.584 - timing_s/adv:48.769 - timing_s/update_actor:190.292 - timing_s/sft_update_actor:15.739 - timing_s/step:691.216 - timing_per_token_ms/gen:0.052 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(main_task pid=405478)[0m step:5 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22492.000 - global_seqlen/max:47480.000 - global_seqlen/minmax_diff:24988.000 - global_seqlen/balanced_min:34592.000 - global_seqlen/balanced_max:34710.000 - global_seqlen/mean:34658.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.011 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.451 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.014 - mfu/actor:0.486 - actor/lr:0.000 - actor/sft_entropy_loss:6.310 - actor/sft_loss:2.209 - actor/sft_grad_norm:3.224 - mfu/sft_actor:7.259 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8138.211 - response_length/max:8192.000 - response_length/min:397.000 - response_length/clip_ratio:0.992 - on_off_metrics/on_response_length_mean:8138.211 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.742 - prompt_length/max:514.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:435.546 - timing_s/old_log_prob:50.209 - timing_s/adv:53.318 - timing_s/update_actor:201.160 - timing_s/sft_update_actor:16.018 - timing_s/step:706.189 - timing_per_token_ms/gen:0.052 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406162)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:6 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25819.000 - global_seqlen/max:42283.000 - global_seqlen/minmax_diff:16464.000 - global_seqlen/balanced_min:34358.000 - global_seqlen/balanced_max:34464.000 - global_seqlen/mean:34407.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.014 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.418 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.014 - mfu/actor:0.523 - actor/lr:0.000 - actor/sft_entropy_loss:6.523 - actor/sft_loss:2.327 - actor/sft_grad_norm:3.030 - mfu/sft_actor:6.687 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8176.739 - response_length/max:8192.000 - response_length/min:926.000 - response_length/clip_ratio:0.996 - on_off_metrics/on_response_length_mean:8176.739 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.734 - prompt_length/max:528.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:439.248 - timing_s/old_log_prob:46.923 - timing_s/adv:50.340 - timing_s/update_actor:187.652 - timing_s/sft_update_actor:17.029 - timing_s/step:694.408 - timing_per_token_ms/gen:0.052 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406162)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406160)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:7 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:20175.000 - global_seqlen/max:45215.000 - global_seqlen/minmax_diff:25040.000 - global_seqlen/balanced_min:32951.000 - global_seqlen/balanced_max:32987.000 - global_seqlen/mean:32968.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.012 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.484 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.013 - mfu/actor:0.531 - actor/lr:0.000 - actor/sft_entropy_loss:4.645 - actor/sft_loss:1.583 - actor/sft_grad_norm:2.161 - mfu/sft_actor:7.677 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8176.603 - response_length/max:8192.000 - response_length/min:561.000 - response_length/clip_ratio:0.997 - on_off_metrics/on_response_length_mean:8176.603 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:239.695 - prompt_length/max:399.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:438.481 - timing_s/old_log_prob:46.724 - timing_s/adv:49.932 - timing_s/update_actor:184.395 - timing_s/sft_update_actor:15.698 - timing_s/step:688.660 - timing_per_token_ms/gen:0.052 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406160)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:8 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:19318.000 - global_seqlen/max:45750.000 - global_seqlen/minmax_diff:26432.000 - global_seqlen/balanced_min:32708.000 - global_seqlen/balanced_max:32810.000 - global_seqlen/mean:32763.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.015 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.466 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.012 - mfu/actor:0.535 - actor/lr:0.000 - actor/sft_entropy_loss:4.585 - actor/sft_loss:1.571 - actor/sft_grad_norm:1.855 - mfu/sft_actor:7.842 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8177.816 - response_length/max:8192.000 - response_length/min:900.000 - response_length/clip_ratio:0.998 - on_off_metrics/on_response_length_mean:8177.816 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:235.961 - prompt_length/max:480.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:442.571 - timing_s/old_log_prob:45.209 - timing_s/adv:48.313 - timing_s/update_actor:183.811 - timing_s/sft_update_actor:15.428 - timing_s/step:690.257 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:9 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:27497.000 - global_seqlen/max:40968.000 - global_seqlen/minmax_diff:13471.000 - global_seqlen/balanced_min:35831.000 - global_seqlen/balanced_max:35953.000 - global_seqlen/mean:35881.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.010 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.539 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.011 - mfu/actor:0.528 - actor/lr:0.000 - actor/sft_entropy_loss:5.105 - actor/sft_loss:1.674 - actor/sft_grad_norm:1.739 - mfu/sft_actor:6.539 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8179.952 - response_length/max:8192.000 - response_length/min:442.000 - response_length/clip_ratio:0.998 - on_off_metrics/on_response_length_mean:8179.952 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.203 - prompt_length/max:520.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:441.094 - timing_s/old_log_prob:46.600 - timing_s/adv:49.707 - timing_s/update_actor:186.017 - timing_s/sft_update_actor:17.834 - timing_s/step:694.782 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 9x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m Validation: Generation end.
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   warnings.warn(
[36m(WorkerDict pid=406161)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined][32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m Find no current best saved. Best score is set to -inf
[36m(main_task pid=405478)[0m Saving best checkpoint with score 0.05078475938541334 at ./train_results/rl-sft/7b_math_instruct_interleave/best/actor
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Saving actor checkpoint to ./train_results/rl-sft/7b_math_instruct_interleave/best/actor
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m [2025-06-03 16:50:32,263] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(main_task pid=405478)[0m step:10 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25021.000 - global_seqlen/max:41385.000 - global_seqlen/minmax_diff:16364.000 - global_seqlen/balanced_min:33464.000 - global_seqlen/balanced_max:33572.000 - global_seqlen/mean:33528.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.008 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.576 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.011 - mfu/actor:0.495 - actor/lr:0.000 - actor/sft_entropy_loss:4.648 - actor/sft_loss:1.563 - actor/sft_grad_norm:1.714 - mfu/sft_actor:7.477 - actor/sft_lr:0.000 - val/test_score/aime:0.008 - val/test_score/amc:0.048 - val/test_score/olympiad_bench:0.039 - val/test_score/minerva:0.037 - val/test_score/math:0.122 - avg_score:0.051 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8180.863 - response_length/max:8192.000 - response_length/min:872.000 - response_length/clip_ratio:0.997 - on_off_metrics/on_response_length_mean:8180.863 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:230.797 - prompt_length/max:348.000 - prompt_length/min:169.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:441.623 - timing_s/old_log_prob:46.048 - timing_s/adv:49.173 - timing_s/update_actor:198.431 - timing_s/sft_update_actor:16.009 - timing_s/testing:449.946 - timing_s/step:1207.476 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m   warnings.warn([32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:11 - batch/bef_solve_none:127.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:127.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.001 - batch/bef_failed:0.999 - batch/on_solved:0.001 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:531788.000 - global_seqlen/max:543040.000 - global_seqlen/minmax_diff:11252.000 - global_seqlen/balanced_min:533155.000 - global_seqlen/balanced_max:540394.000 - global_seqlen/mean:539429.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.011 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.548 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.016 - mfu/actor:0.522 - actor/lr:0.000 - critic/score/mean:0.001 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.001 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.001 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8177.165 - response_length/max:8192.000 - response_length/min:680.000 - response_length/clip_ratio:0.997 - on_off_metrics/on_response_length_mean:8177.165 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.001 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.422 - prompt_length/max:604.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:441.718 - timing_s/old_log_prob:46.951 - timing_s/adv:50.150 - timing_s/update_actor:188.717 - timing_s/step:680.708 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406158)[0m MICROBATCH STEP
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:12 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25553.000 - global_seqlen/max:42742.000 - global_seqlen/minmax_diff:17189.000 - global_seqlen/balanced_min:34257.000 - global_seqlen/balanced_max:34319.000 - global_seqlen/mean:34298.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.020 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.443 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.010 - mfu/actor:0.541 - actor/lr:0.000 - actor/sft_entropy_loss:4.145 - actor/sft_loss:1.494 - actor/sft_grad_norm:1.327 - mfu/sft_actor:5.902 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8192.000 - response_length/max:8192.000 - response_length/min:8192.000 - response_length/clip_ratio:1.000 - on_off_metrics/on_response_length_mean:8192.000 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:249.727 - prompt_length/max:531.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:452.243 - timing_s/old_log_prob:47.258 - timing_s/adv:50.501 - timing_s/update_actor:181.719 - timing_s/sft_update_actor:19.416 - timing_s/step:704.057 - timing_per_token_ms/gen:0.054 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406159)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(main_task pid=405478)[0m step:13 - batch/bef_solve_none:126.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:126.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.002 - batch/bef_failed:0.998 - batch/on_solved:0.002 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:23811.000 - global_seqlen/max:43768.000 - global_seqlen/minmax_diff:19957.000 - global_seqlen/balanced_min:34256.000 - global_seqlen/balanced_max:34341.000 - global_seqlen/mean:34285.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.003 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.009 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.632 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.031 - mfu/actor:0.527 - actor/lr:0.000 - actor/sft_entropy_loss:2.697 - actor/sft_loss:1.020 - actor/sft_grad_norm:0.822 - mfu/sft_actor:7.038 - actor/sft_lr:0.000 - critic/score/mean:0.002 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.002 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.001 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8175.688 - response_length/max:8192.000 - response_length/min:695.000 - response_length/clip_ratio:0.997 - on_off_metrics/on_response_length_mean:8175.688 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.002 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.859 - prompt_length/max:416.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:441.851 - timing_s/old_log_prob:46.017 - timing_s/adv:49.374 - timing_s/update_actor:186.132 - timing_s/sft_update_actor:16.666 - timing_s/step:694.539 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:14 - batch/bef_solve_none:127.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:127.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.001 - batch/bef_failed:0.999 - batch/on_solved:0.001 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:27439.000 - global_seqlen/max:47313.000 - global_seqlen/minmax_diff:19874.000 - global_seqlen/balanced_min:35391.000 - global_seqlen/balanced_max:35476.000 - global_seqlen/mean:35433.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.018 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.527 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.029 - mfu/actor:0.514 - actor/lr:0.000 - actor/sft_entropy_loss:2.125 - actor/sft_loss:0.920 - actor/sft_grad_norm:0.691 - mfu/sft_actor:5.271 - actor/sft_lr:0.000 - critic/score/mean:0.001 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.001 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:0.000 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8185.016 - response_length/max:8192.000 - response_length/min:1040.000 - response_length/clip_ratio:0.999 - on_off_metrics/on_response_length_mean:8185.016 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.001 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.625 - prompt_length/max:662.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:440.043 - timing_s/old_log_prob:46.391 - timing_s/adv:49.658 - timing_s/update_actor:190.771 - timing_s/sft_update_actor:21.190 - timing_s/step:701.822 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:15 - batch/bef_solve_none:126.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:126.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.002 - batch/bef_failed:0.998 - batch/on_solved:0.002 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:21225.000 - global_seqlen/max:39185.000 - global_seqlen/minmax_diff:17960.000 - global_seqlen/balanced_min:32189.000 - global_seqlen/balanced_max:32230.000 - global_seqlen/mean:32203.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.004 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.722 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.273 - mfu/actor:0.512 - actor/lr:0.000 - actor/sft_entropy_loss:1.945 - actor/sft_loss:0.988 - actor/sft_grad_norm:0.549 - mfu/sft_actor:6.726 - actor/sft_lr:0.000 - critic/score/mean:0.002 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.002 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.001 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8163.041 - response_length/max:8192.000 - response_length/min:429.000 - response_length/clip_ratio:0.996 - on_off_metrics/on_response_length_mean:8163.041 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.002 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:239.750 - prompt_length/max:496.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:440.710 - timing_s/old_log_prob:45.728 - timing_s/adv:48.965 - timing_s/update_actor:191.571 - timing_s/sft_update_actor:17.134 - timing_s/step:698.513 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:16 - batch/bef_solve_none:128.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:128.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.000 - batch/bef_failed:1.000 - batch/on_solved:0.000 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:27671.000 - global_seqlen/max:47802.000 - global_seqlen/minmax_diff:20131.000 - global_seqlen/balanced_min:35248.000 - global_seqlen/balanced_max:35287.000 - global_seqlen/mean:35270.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.017 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.556 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.020 - mfu/actor:0.530 - actor/lr:0.000 - actor/sft_entropy_loss:1.926 - actor/sft_loss:0.942 - actor/sft_grad_norm:0.520 - mfu/sft_actor:7.222 - actor/sft_lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:8170.210 - response_length/max:8192.000 - response_length/min:556.000 - response_length/clip_ratio:0.997 - on_off_metrics/on_response_length_mean:8170.210 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.000 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.031 - prompt_length/max:517.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:440.419 - timing_s/old_log_prob:46.861 - timing_s/adv:50.244 - timing_s/update_actor:184.977 - timing_s/sft_update_actor:15.949 - timing_s/step:691.717 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406157)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:17 - batch/bef_solve_none:125.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:125.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.003 - batch/bef_failed:0.997 - batch/on_solved:0.003 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25833.000 - global_seqlen/max:41608.000 - global_seqlen/minmax_diff:15775.000 - global_seqlen/balanced_min:33660.000 - global_seqlen/balanced_max:33750.000 - global_seqlen/mean:33723.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.019 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.531 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.528 - mfu/actor:0.532 - actor/lr:0.000 - actor/sft_entropy_loss:1.663 - actor/sft_loss:0.930 - actor/sft_grad_norm:0.435 - mfu/sft_actor:6.587 - actor/sft_lr:0.000 - critic/score/mean:0.003 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.003 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.001 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8184.400 - response_length/max:8192.000 - response_length/min:410.000 - response_length/clip_ratio:0.999 - on_off_metrics/on_response_length_mean:8184.400 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.003 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.023 - prompt_length/max:568.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:439.357 - timing_s/old_log_prob:46.962 - timing_s/adv:50.428 - timing_s/update_actor:185.135 - timing_s/sft_update_actor:17.367 - timing_s/step:692.434 - timing_per_token_ms/gen:0.052 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:18 - batch/bef_solve_none:126.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:126.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.002 - batch/bef_failed:0.998 - batch/on_solved:0.002 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:27145.000 - global_seqlen/max:45212.000 - global_seqlen/minmax_diff:18067.000 - global_seqlen/balanced_min:35211.000 - global_seqlen/balanced_max:35298.000 - global_seqlen/mean:35241.375 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.004 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.008 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.675 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.034 - mfu/actor:0.522 - actor/lr:0.000 - actor/sft_entropy_loss:1.596 - actor/sft_loss:0.861 - actor/sft_grad_norm:0.420 - mfu/sft_actor:6.649 - actor/sft_lr:0.000 - critic/score/mean:0.002 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.002 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.001 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8155.745 - response_length/max:8192.000 - response_length/min:378.000 - response_length/clip_ratio:0.995 - on_off_metrics/on_response_length_mean:8155.745 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.002 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:239.359 - prompt_length/max:367.000 - prompt_length/min:170.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:438.552 - timing_s/old_log_prob:47.266 - timing_s/adv:50.585 - timing_s/update_actor:187.479 - timing_s/sft_update_actor:17.129 - timing_s/step:693.874 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:19 - batch/bef_solve_none:124.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:124.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.004 - batch/bef_failed:0.996 - batch/on_solved:0.004 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:26188.000 - global_seqlen/max:39986.000 - global_seqlen/minmax_diff:13798.000 - global_seqlen/balanced_min:32517.000 - global_seqlen/balanced_max:32586.000 - global_seqlen/mean:32543.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.005 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.010 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.651 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.045 - mfu/actor:0.535 - actor/lr:0.000 - actor/sft_entropy_loss:1.570 - actor/sft_loss:0.918 - actor/sft_grad_norm:0.371 - mfu/sft_actor:8.340 - actor/sft_lr:0.000 - critic/score/mean:0.004 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.004 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.002 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8127.500 - response_length/max:8192.000 - response_length/min:282.000 - response_length/clip_ratio:0.990 - on_off_metrics/on_response_length_mean:8127.500 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.004 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:246.867 - prompt_length/max:587.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:437.960 - timing_s/old_log_prob:46.287 - timing_s/adv:49.774 - timing_s/update_actor:182.864 - timing_s/sft_update_actor:14.424 - timing_s/step:685.184 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m Validation: Generation end.
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m Saving best checkpoint with score 0.29071846150443925 at ./train_results/rl-sft/7b_math_instruct_interleave/best/actor
[36m(main_task pid=405478)[0m ERROR:2025-06-03 18:53:07,927:Error comparing I(0) and (C*V_0)*exp(-beta*t)*cos(omega*t)/(-C*R*beta + 1) + (C**2*R*V_0*omega)*exp(-beta*t)*sin(omega*t)/(-1*2*R*C*beta + 1) + (-C*V_0/(-C*R*beta + 1) + I)*exp(-t/(C*R))
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=405478)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 699, in simplify
[36m(main_task pid=405478)[0m     expr = trigsimp(expr, deep=True)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 565, in trigsimp
[36m(main_task pid=405478)[0m     expr_simplified = trigsimpfunc(expr)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 558, in <lambda>
[36m(main_task pid=405478)[0m     'matching': (lambda x: futrig(x)),
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1159, in futrig
[36m(main_task pid=405478)[0m     e = bottom_up(e, _futrig)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=405478)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=405478)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 233, in bottom_up
[36m(main_task pid=405478)[0m     rv = F(rv)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1226, in _futrig
[36m(main_task pid=405478)[0m     e = greedy(tree, objective=Lops)(e)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 150, in minrule
[36m(main_task pid=405478)[0m     return min([rule(expr) for rule in rules], key=objective)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 150, in <listcomp>
[36m(main_task pid=405478)[0m     return min([rule(expr) for rule in rules], key=objective)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 64, in chain_rl
[36m(main_task pid=405478)[0m     expr = rule(expr)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1194, in <lambda>
[36m(main_task pid=405478)[0m     lambda x: _eapply(factor, x, trigs),
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1250, in _eapply
[36m(main_task pid=405478)[0m     return func(e)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6577, in factor
[36m(main_task pid=405478)[0m     return _generic_factor(f, gens, args, method='factor')
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6258, in _generic_factor
[36m(main_task pid=405478)[0m     return _symbolic_factor(sympify(expr), opt, method)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6198, in _symbolic_factor
[36m(main_task pid=405478)[0m     coeff, factors = _symbolic_factor_list(together(expr, fraction=opt['fraction']), opt, method)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6163, in _symbolic_factor_list
[36m(main_task pid=405478)[0m     _coeff, _factors = func()
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 3378, in factor_list
[36m(main_task pid=405478)[0m     coeff, factors = f.rep.factor_list()
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyclasses.py", line 1637, in factor_list
[36m(main_task pid=405478)[0m     coeff, factors = dmp_factor_list(f._rep, f.lev, f.dom)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1549, in dmp_factor_list
[36m(main_task pid=405478)[0m     coeff, factors = dmp_zz_i_factor(f, u, K0)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1249, in dmp_zz_i_factor
[36m(main_task pid=405478)[0m     coeff, factors = dmp_qq_i_factor(f, u, K1)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1238, in dmp_qq_i_factor
[36m(main_task pid=405478)[0m     coeff, factors = dmp_factor_list(f, u, K1)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1547, in dmp_factor_list
[36m(main_task pid=405478)[0m     coeff, factors = dmp_ext_factor(f, u, K0)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1420, in dmp_ext_factor
[36m(main_task pid=405478)[0m     f, F = dmp_sqf_part(f, u, K), f
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/sqfreetools.py", line 470, in dmp_sqf_part
[36m(main_task pid=405478)[0m     gcd = dmp_gcd(gcd, dmp_diff_in(f, 1, i, u, K), u, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/euclidtools.py", line 1639, in dmp_gcd
[36m(main_task pid=405478)[0m     return dmp_inner_gcd(f, g, u, K)[0]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/euclidtools.py", line 1598, in dmp_inner_gcd
[36m(main_task pid=405478)[0m     h, cff, cfg = _dmp_inner_gcd(f, g, u, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/euclidtools.py", line 1563, in _dmp_inner_gcd
[36m(main_task pid=405478)[0m     return dmp_ff_prs_gcd(f, g, u, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/euclidtools.py", line 1116, in dmp_ff_prs_gcd
[36m(main_task pid=405478)[0m     h = dmp_subresultants(F, G, u, K)[-1]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/euclidtools.py", line 549, in dmp_subresultants
[36m(main_task pid=405478)[0m     return dmp_inner_subresultants(f, g, u, K)[0]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/euclidtools.py", line 512, in dmp_inner_subresultants
[36m(main_task pid=405478)[0m     h = dmp_prem(f, g, u, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 1238, in dmp_prem
[36m(main_task pid=405478)[0m     G = dmp_mul_term(g, lc_r, j, u, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 184, in dmp_mul_term
[36m(main_task pid=405478)[0m     return [ dmp_mul(cf, c, v, K) for cf in f ] + dmp_zeros(i, v, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 184, in <listcomp>
[36m(main_task pid=405478)[0m     return [ dmp_mul(cf, c, v, K) for cf in f ] + dmp_zeros(i, v, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 828, in dmp_mul
[36m(main_task pid=405478)[0m     coeff = dmp_add(coeff, dmp_mul(f[j], g[i - j], v, K), v, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 828, in dmp_mul
[36m(main_task pid=405478)[0m     coeff = dmp_add(coeff, dmp_mul(f[j], g[i - j], v, K), v, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 578, in dmp_add
[36m(main_task pid=405478)[0m     return dmp_strip([ dmp_add(a, b, v, K) for a, b in zip(f, g) ], u)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 578, in <listcomp>
[36m(main_task pid=405478)[0m     return dmp_strip([ dmp_add(a, b, v, K) for a, b in zip(f, g) ], u)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 587, in dmp_add
[36m(main_task pid=405478)[0m     return h + [ dmp_add(a, b, v, K) for a, b in zip(f, g) ]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 587, in <listcomp>
[36m(main_task pid=405478)[0m     return h + [ dmp_add(a, b, v, K) for a, b in zip(f, g) ]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 565, in dmp_add
[36m(main_task pid=405478)[0m     df = dmp_degree(f, u)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 181, in dmp_degree
[36m(main_task pid=405478)[0m     if dmp_zero_p(f, u):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 713, in dmp_zero_p
[36m(main_task pid=405478)[0m     while u:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=405478)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=405478)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   warnings.warn(
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Saving actor checkpoint to ./train_results/rl-sft/7b_math_instruct_interleave/best/actor
[36m(main_task pid=405478)[0m step:20 - batch/bef_solve_none:123.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:123.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.005 - batch/bef_failed:0.995 - batch/on_solved:0.005 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:26579.000 - global_seqlen/max:44899.000 - global_seqlen/minmax_diff:18320.000 - global_seqlen/balanced_min:34126.000 - global_seqlen/balanced_max:34205.000 - global_seqlen/mean:34155.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.020 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.531 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.051 - mfu/actor:0.538 - actor/lr:0.000 - actor/sft_entropy_loss:1.583 - actor/sft_loss:0.952 - actor/sft_grad_norm:0.338 - mfu/sft_actor:6.941 - actor/sft_lr:0.000 - val/test_score/math:0.622 - val/test_score/aime:0.100 - val/test_score/olympiad_bench:0.293 - val/test_score/amc:0.277 - val/test_score/minerva:0.162 - avg_score:0.291 - critic/score/mean:0.005 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.005 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.002 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8161.430 - response_length/max:8192.000 - response_length/min:489.000 - response_length/clip_ratio:0.995 - on_off_metrics/on_response_length_mean:8161.430 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.005 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:238.500 - prompt_length/max:501.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:444.450 - timing_s/old_log_prob:45.829 - timing_s/adv:49.219 - timing_s/update_actor:181.904 - timing_s/sft_update_actor:16.859 - timing_s/testing:378.021 - timing_s/step:1123.696 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.021 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:21 - batch/bef_solve_none:123.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:123.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.005 - batch/bef_failed:0.995 - batch/on_solved:0.005 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25729.000 - global_seqlen/max:39311.000 - global_seqlen/minmax_diff:13582.000 - global_seqlen/balanced_min:34669.000 - global_seqlen/balanced_max:34758.000 - global_seqlen/mean:34729.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.016 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.587 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.082 - mfu/actor:0.501 - actor/lr:0.000 - actor/sft_entropy_loss:1.591 - actor/sft_loss:0.939 - actor/sft_grad_norm:0.313 - mfu/sft_actor:7.282 - actor/sft_lr:0.000 - critic/score/mean:0.005 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.005 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.875 - critic/advantages/min:-0.125 - critic/returns/mean:-0.002 - critic/returns/max:0.875 - critic/returns/min:-0.125 - response_length/mean:8133.241 - response_length/max:8192.000 - response_length/min:10.000 - response_length/clip_ratio:0.992 - on_off_metrics/on_response_length_mean:8133.241 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.005 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:235.062 - prompt_length/max:515.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:436.399 - timing_s/old_log_prob:45.724 - timing_s/adv:49.519 - timing_s/update_actor:194.654 - timing_s/sft_update_actor:16.203 - timing_s/step:696.932 - timing_per_token_ms/gen:0.052 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:22 - batch/bef_solve_none:113.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:113.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.017 - batch/bef_failed:0.983 - batch/on_solved:0.017 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:26211.000 - global_seqlen/max:43983.000 - global_seqlen/minmax_diff:17772.000 - global_seqlen/balanced_min:35873.000 - global_seqlen/balanced_max:36007.000 - global_seqlen/mean:35907.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.015 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.020 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.532 - actor/pg_loss:0.053 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.629 - mfu/actor:0.506 - actor/lr:0.000 - actor/sft_entropy_loss:1.531 - actor/sft_loss:0.937 - actor/sft_grad_norm:0.281 - mfu/sft_actor:6.489 - actor/sft_lr:0.000 - critic/score/mean:0.017 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.017 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:0.875 - critic/advantages/min:-0.250 - critic/returns/mean:-0.008 - critic/returns/max:0.875 - critic/returns/min:-0.250 - response_length/mean:8016.843 - response_length/max:8192.000 - response_length/min:151.000 - response_length/clip_ratio:0.976 - on_off_metrics/on_response_length_mean:8016.843 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.017 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.320 - prompt_length/max:407.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:433.961 - timing_s/old_log_prob:47.228 - timing_s/adv:51.418 - timing_s/update_actor:190.428 - timing_s/sft_update_actor:17.501 - timing_s/step:693.508 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:23 - batch/bef_solve_none:117.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:117.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.014 - batch/bef_failed:0.986 - batch/on_solved:0.014 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:22857.000 - global_seqlen/max:44588.000 - global_seqlen/minmax_diff:21731.000 - global_seqlen/balanced_min:34210.000 - global_seqlen/balanced_max:34241.000 - global_seqlen/mean:34228.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.034 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.364 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.004 - actor/grad_norm:0.146 - mfu/actor:0.523 - actor/lr:0.000 - actor/sft_entropy_loss:1.231 - actor/sft_loss:0.848 - actor/sft_grad_norm:0.273 - mfu/sft_actor:6.559 - actor/sft_lr:0.000 - critic/score/mean:0.014 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.014 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:0.875 - critic/advantages/min:-0.250 - critic/returns/mean:-0.006 - critic/returns/max:0.875 - critic/returns/min:-0.250 - response_length/mean:8083.060 - response_length/max:8192.000 - response_length/min:484.000 - response_length/clip_ratio:0.984 - on_off_metrics/on_response_length_mean:8083.060 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.014 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.594 - prompt_length/max:546.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:435.100 - timing_s/old_log_prob:51.496 - timing_s/adv:55.392 - timing_s/update_actor:185.631 - timing_s/sft_update_actor:17.675 - timing_s/step:693.949 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.022 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406157)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406158)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:24 - batch/bef_solve_none:94.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:94.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.046 - batch/bef_failed:0.954 - batch/on_solved:0.046 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:29413.000 - global_seqlen/max:47630.000 - global_seqlen/minmax_diff:18217.000 - global_seqlen/balanced_min:37635.000 - global_seqlen/balanced_max:37783.000 - global_seqlen/mean:37694.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.030 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.031 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.391 - actor/pg_loss:0.093 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.715 - mfu/actor:0.493 - actor/lr:0.000 - actor/sft_entropy_loss:1.346 - actor/sft_loss:0.911 - actor/sft_grad_norm:0.244 - mfu/sft_actor:5.861 - actor/sft_lr:0.000 - critic/score/mean:0.046 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.046 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.022 - critic/advantages/max:0.875 - critic/advantages/min:-0.625 - critic/returns/mean:-0.022 - critic/returns/max:0.875 - critic/returns/min:-0.625 - response_length/mean:7829.317 - response_length/max:8192.000 - response_length/min:265.000 - response_length/clip_ratio:0.950 - on_off_metrics/on_response_length_mean:7829.317 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.046 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.047 - prompt_length/max:448.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:433.062 - timing_s/old_log_prob:46.374 - timing_s/adv:50.401 - timing_s/update_actor:190.218 - timing_s/sft_update_actor:18.583 - timing_s/step:692.424 - timing_per_token_ms/gen:0.054 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m ERROR:2025-06-03 19:47:24,140:Error during parsing
[36m(main_task pid=405478)[0m ValueError: Error from parse_expr with transformed code: '４'
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=405478)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=405478)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=405478)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=405478)[0m     expr = eval(
[36m(main_task pid=405478)[0m   File "<string>", line 1
[36m(main_task pid=405478)[0m     ４
[36m(main_task pid=405478)[0m     ^
[36m(main_task pid=405478)[0m SyntaxError: invalid character '４' (U+FF14)
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=405478)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=405478)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=405478)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=405478)[0m     number = Number(number_str)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=405478)[0m     val = sympify(obj)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=405478)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=405478)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse '４'' failed, because of exception being raised:
[36m(main_task pid=405478)[0m SyntaxError: invalid character '４' (U+FF14) (<string>, line 1)
[36m(WorkerDict pid=406160)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:25 - batch/bef_solve_none:91.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:91.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.065 - batch/bef_failed:0.935 - batch/on_solved:0.065 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25099.000 - global_seqlen/max:42530.000 - global_seqlen/minmax_diff:17431.000 - global_seqlen/balanced_min:35555.000 - global_seqlen/balanced_max:35608.000 - global_seqlen/mean:35580.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.049 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.052 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.135 - actor/pg_loss:0.148 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.313 - mfu/actor:0.499 - actor/lr:0.000 - actor/sft_entropy_loss:1.097 - actor/sft_loss:0.867 - actor/sft_grad_norm:0.221 - mfu/sft_actor:6.808 - actor/sft_lr:0.000 - critic/score/mean:0.065 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.065 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:0.875 - critic/advantages/min:-0.750 - critic/returns/mean:-0.032 - critic/returns/max:0.875 - critic/returns/min:-0.750 - response_length/mean:7620.292 - response_length/max:8192.000 - response_length/min:298.000 - response_length/clip_ratio:0.923 - on_off_metrics/on_response_length_mean:7620.292 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.065 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.203 - prompt_length/max:790.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:415.311 - timing_s/old_log_prob:46.084 - timing_s/adv:52.066 - timing_s/update_actor:183.364 - timing_s/sft_update_actor:16.148 - timing_s/step:667.046 - timing_per_token_ms/gen:0.053 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:26 - batch/bef_solve_none:75.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:75.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.118 - batch/bef_failed:0.882 - batch/on_solved:0.118 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:396423.000 - global_seqlen/max:531077.000 - global_seqlen/minmax_diff:134654.000 - global_seqlen/balanced_min:466817.000 - global_seqlen/balanced_max:472475.000 - global_seqlen/mean:472082.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.031 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.060 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.032 - actor/pg_loss:0.105 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:2.384 - mfu/actor:0.495 - actor/lr:0.000 - critic/score/mean:0.118 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.118 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.058 - critic/advantages/max:0.875 - critic/advantages/min:-0.750 - critic/returns/mean:-0.058 - critic/returns/max:0.875 - critic/returns/min:-0.750 - response_length/mean:7131.010 - response_length/max:8192.000 - response_length/min:236.000 - response_length/clip_ratio:0.857 - on_off_metrics/on_response_length_mean:7131.010 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.118 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.281 - prompt_length/max:996.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:413.925 - timing_s/old_log_prob:44.953 - timing_s/adv:49.960 - timing_s/update_actor:173.309 - timing_s/step:637.312 - timing_per_token_ms/gen:0.057 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m ERROR:2025-06-03 20:08:55,195:Error during parsing
[36m(main_task pid=405478)[0m ValueError: Error from parse_expr with transformed code: '１'
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=405478)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=405478)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=405478)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=405478)[0m     expr = eval(
[36m(main_task pid=405478)[0m   File "<string>", line 1
[36m(main_task pid=405478)[0m     １
[36m(main_task pid=405478)[0m     ^
[36m(main_task pid=405478)[0m SyntaxError: invalid character '１' (U+FF11)
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=405478)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=405478)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=405478)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=405478)[0m     number = Number(number_str)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=405478)[0m     val = sympify(obj)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=405478)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=405478)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse '１'' failed, because of exception being raised:
[36m(main_task pid=405478)[0m SyntaxError: invalid character '１' (U+FF11) (<string>, line 1)
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:27 - batch/bef_solve_none:74.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:1.000 - batch/solve_none:74.000 - batch/solve_none_format:0.000 - batch/solve_all:1.000 - batch/bef_solved:0.144 - batch/bef_failed:0.856 - batch/on_solved:0.144 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:29462.000 - global_seqlen/max:49840.000 - global_seqlen/minmax_diff:20378.000 - global_seqlen/balanced_min:40150.000 - global_seqlen/balanced_max:40212.000 - global_seqlen/mean:40181.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.056 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.062 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:11.013 - actor/pg_loss:0.207 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:1.389 - mfu/actor:0.495 - actor/lr:0.000 - actor/sft_entropy_loss:1.249 - actor/sft_loss:0.879 - actor/sft_grad_norm:0.216 - mfu/sft_actor:4.955 - actor/sft_lr:0.000 - critic/score/mean:0.144 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.144 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.065 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.065 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:6876.797 - response_length/max:8192.000 - response_length/min:148.000 - response_length/clip_ratio:0.823 - on_off_metrics/on_response_length_mean:6876.797 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.144 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.867 - prompt_length/max:515.000 - prompt_length/min:183.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:403.914 - timing_s/old_log_prob:43.725 - timing_s/adv:48.464 - timing_s/update_actor:167.324 - timing_s/sft_update_actor:17.943 - timing_s/step:637.810 - timing_per_token_ms/gen:0.057 - timing_per_token_ms/update_actor:0.023 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:28 - batch/bef_solve_none:68.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:68.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.158 - batch/bef_failed:0.842 - batch/on_solved:0.158 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:347181.000 - global_seqlen/max:492167.000 - global_seqlen/minmax_diff:144986.000 - global_seqlen/balanced_min:429720.000 - global_seqlen/balanced_max:435570.000 - global_seqlen/mean:430452.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.059 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.075 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.848 - actor/pg_loss:0.195 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.225 - mfu/actor:0.448 - actor/lr:0.000 - critic/score/mean:0.158 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.158 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.075 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.075 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:6477.235 - response_length/max:8192.000 - response_length/min:284.000 - response_length/clip_ratio:0.768 - on_off_metrics/on_response_length_mean:6477.235 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.158 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:248.578 - prompt_length/max:452.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:380.121 - timing_s/old_log_prob:42.894 - timing_s/adv:47.537 - timing_s/update_actor:174.337 - timing_s/step:602.180 - timing_per_token_ms/gen:0.057 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406159)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:29 - batch/bef_solve_none:58.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:58.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.195 - batch/bef_failed:0.805 - batch/on_solved:0.195 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:34152.000 - global_seqlen/max:47879.000 - global_seqlen/minmax_diff:13727.000 - global_seqlen/balanced_min:42237.000 - global_seqlen/balanced_max:42252.000 - global_seqlen/mean:42245.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.051 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.107 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.452 - actor/pg_loss:0.170 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.620 - mfu/actor:0.465 - actor/lr:0.000 - actor/sft_entropy_loss:1.096 - actor/sft_loss:0.881 - actor/sft_grad_norm:0.195 - mfu/sft_actor:4.068 - actor/sft_lr:0.000 - critic/score/mean:0.195 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.195 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.090 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.090 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:6019.282 - response_length/max:8192.000 - response_length/min:237.000 - response_length/clip_ratio:0.705 - on_off_metrics/on_response_length_mean:6019.282 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.195 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:230.594 - prompt_length/max:425.000 - prompt_length/min:181.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:387.169 - timing_s/old_log_prob:40.935 - timing_s/adv:46.347 - timing_s/update_actor:155.517 - timing_s/sft_update_actor:19.654 - timing_s/step:608.805 - timing_per_token_ms/gen:0.063 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m Validation: Generation end.
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m ERROR:2025-06-03 20:45:52,839:Error comparing -8 + 1*E and exp(-1*50000*t)*sin(500000*t)
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=405478)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 699, in simplify
[36m(main_task pid=405478)[0m     expr = trigsimp(expr, deep=True)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 565, in trigsimp
[36m(main_task pid=405478)[0m     expr_simplified = trigsimpfunc(expr)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 558, in <lambda>
[36m(main_task pid=405478)[0m     'matching': (lambda x: futrig(x)),
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1159, in futrig
[36m(main_task pid=405478)[0m     e = bottom_up(e, _futrig)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=405478)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=405478)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 233, in bottom_up
[36m(main_task pid=405478)[0m     rv = F(rv)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1226, in _futrig
[36m(main_task pid=405478)[0m     e = greedy(tree, objective=Lops)(e)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 150, in minrule
[36m(main_task pid=405478)[0m     return min([rule(expr) for rule in rules], key=objective)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 150, in <listcomp>
[36m(main_task pid=405478)[0m     return min([rule(expr) for rule in rules], key=objective)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 64, in chain_rl
[36m(main_task pid=405478)[0m     expr = rule(expr)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1194, in <lambda>
[36m(main_task pid=405478)[0m     lambda x: _eapply(factor, x, trigs),
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1250, in _eapply
[36m(main_task pid=405478)[0m     return func(e)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6577, in factor
[36m(main_task pid=405478)[0m     return _generic_factor(f, gens, args, method='factor')
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6258, in _generic_factor
[36m(main_task pid=405478)[0m     return _symbolic_factor(sympify(expr), opt, method)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6198, in _symbolic_factor
[36m(main_task pid=405478)[0m     coeff, factors = _symbolic_factor_list(together(expr, fraction=opt['fraction']), opt, method)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6163, in _symbolic_factor_list
[36m(main_task pid=405478)[0m     _coeff, _factors = func()
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 3378, in factor_list
[36m(main_task pid=405478)[0m     coeff, factors = f.rep.factor_list()
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyclasses.py", line 1637, in factor_list
[36m(main_task pid=405478)[0m     coeff, factors = dmp_factor_list(f._rep, f.lev, f.dom)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1569, in dmp_factor_list
[36m(main_task pid=405478)[0m     coeff, factors = dmp_zz_factor(f, v, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1189, in dmp_zz_factor
[36m(main_task pid=405478)[0m     H = dmp_zz_wang(g, u, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1025, in dmp_zz_wang
[36m(main_task pid=405478)[0m     ct, T = dmp_zz_factor(dmp_LC(f, K), u - 1, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1188, in dmp_zz_factor
[36m(main_task pid=405478)[0m     g = dmp_sqf_part(g, u, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/sqfreetools.py", line 470, in dmp_sqf_part
[36m(main_task pid=405478)[0m     gcd = dmp_gcd(gcd, dmp_diff_in(f, 1, i, u, K), u, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 259, in dmp_diff_in
[36m(main_task pid=405478)[0m     return _rec_diff_in(f, m, u, 0, j, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 231, in _rec_diff_in
[36m(main_task pid=405478)[0m     return dmp_diff(g, m, v, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 213, in dmp_diff
[36m(main_task pid=405478)[0m     deriv.append(dmp_mul_ground(coeff, K(n), v, K))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 290, in dmp_mul_ground
[36m(main_task pid=405478)[0m     return dup_mul_ground(f, c, K)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=405478)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=405478)[0m TimeoutError: Operation timed out!
[36m(main_task pid=405478)[0m Saving best checkpoint with score 0.40661474444232654 at ./train_results/rl-sft/7b_math_instruct_interleave/best/actor
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   warnings.warn(
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Saving actor checkpoint to ./train_results/rl-sft/7b_math_instruct_interleave/best/actor
[36m(main_task pid=405478)[0m step:30 - batch/bef_solve_none:49.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:2.000 - batch/solve_none:49.000 - batch/solve_none_format:0.000 - batch/solve_all:2.000 - batch/bef_solved:0.271 - batch/bef_failed:0.729 - batch/on_solved:0.271 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:283993.000 - global_seqlen/max:432118.000 - global_seqlen/minmax_diff:148125.000 - global_seqlen/balanced_min:352803.000 - global_seqlen/balanced_max:354313.000 - global_seqlen/mean:354218.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.132 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.113 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.376 - actor/pg_loss:0.401 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:1.237 - mfu/actor:0.437 - actor/lr:0.000 - val/test_score/math:0.820 - val/test_score/minerva:0.265 - val/test_score/olympiad_bench:0.391 - val/test_score/amc:0.437 - val/test_score/aime:0.121 - avg_score:0.407 - critic/score/mean:0.271 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.271 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.114 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.114 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:5297.585 - response_length/max:8192.000 - response_length/min:189.000 - response_length/clip_ratio:0.608 - on_off_metrics/on_response_length_mean:5297.585 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.271 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.078 - prompt_length/max:503.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:347.792 - timing_s/old_log_prob:36.631 - timing_s/adv:42.006 - timing_s/update_actor:147.052 - timing_s/testing:239.787 - timing_s/step:831.519 - timing_per_token_ms/gen:0.064 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/adv:0.007
[36m(main_task pid=405478)[0m ERROR:2025-06-03 20:53:43,927:Error comparing (x <= 7*pi/4) & (pi/4 <= x) and Union(Interval(0, pi/4), Interval((3*pi)/4, 2*pi))
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=405478)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=405478)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=405478)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=405478)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=405478)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=405478)[0m     result = B._complement(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=405478)[0m     return Set._complement(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in _complement
[36m(main_task pid=405478)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in <genexpr>
[36m(main_task pid=405478)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=405478)[0m     return func(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 806, in __sub__
[36m(main_task pid=405478)[0m     return Complement(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=405478)[0m     result = B._complement(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=405478)[0m     return Set._complement(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 219, in _complement
[36m(main_task pid=405478)[0m     return Intersection(other, self.complement(S.Reals))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in simplify_intersection
[36m(main_task pid=405478)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in <genexpr>
[36m(main_task pid=405478)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=405478)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 455, in _
[36m(main_task pid=405478)[0m     if a.end < b.end:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=405478)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=405478)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=405478)[0m ERROR:2025-06-03 20:53:44,057:Error comparing (x <= 7*pi/4) & (pi/4 <= x) and Union(Interval(pi/4, (3*pi)/4), Interval((5*pi)/4, (7*pi)/4))
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=405478)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=405478)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=405478)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=405478)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=405478)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1731, in reduce
[36m(main_task pid=405478)[0m     if B == S.UniversalSet or A.is_subset(B):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1434, in is_subset
[36m(main_task pid=405478)[0m     return fuzzy_and(s.is_subset(other) for s in self.args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/logic.py", line 142, in fuzzy_and
[36m(main_task pid=405478)[0m     for ai in args:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1434, in <genexpr>
[36m(main_task pid=405478)[0m     return fuzzy_and(s.is_subset(other) for s in self.args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 430, in is_subset
[36m(main_task pid=405478)[0m     if self.intersect(other) == self:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 150, in intersect
[36m(main_task pid=405478)[0m     return Intersection(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=405478)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 432, in _
[36m(main_task pid=405478)[0m     if a.start < b.start:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=405478)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=405478)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=405478)[0m ERROR:2025-06-03 20:53:44,177:Error comparing (x <= 7*pi/4) & (pi/4 <= x) and Union(Interval(0, pi/4), Interval((5*pi)/4, (3*pi)/2))
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=405478)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=405478)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=405478)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=405478)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=405478)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=405478)[0m     result = B._complement(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=405478)[0m     return Set._complement(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in _complement
[36m(main_task pid=405478)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in <genexpr>
[36m(main_task pid=405478)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=405478)[0m     return func(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 806, in __sub__
[36m(main_task pid=405478)[0m     return Complement(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=405478)[0m     result = B._complement(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=405478)[0m     return Set._complement(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 219, in _complement
[36m(main_task pid=405478)[0m     return Intersection(other, self.complement(S.Reals))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in simplify_intersection
[36m(main_task pid=405478)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in <genexpr>
[36m(main_task pid=405478)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=405478)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 455, in _
[36m(main_task pid=405478)[0m     if a.end < b.end:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=405478)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=405478)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=405478)[0m ERROR:2025-06-03 20:53:44,282:Error comparing (x <= 7*pi/4) & (pi/4 <= x) and Union(Interval(0, pi/4), Interval((7*pi)/4, 2*pi))
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=405478)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=405478)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=405478)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=405478)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=405478)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=405478)[0m     result = B._complement(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=405478)[0m     return Set._complement(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in _complement
[36m(main_task pid=405478)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in <genexpr>
[36m(main_task pid=405478)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=405478)[0m     return func(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 806, in __sub__
[36m(main_task pid=405478)[0m     return Complement(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=405478)[0m     result = B._complement(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=405478)[0m     return Set._complement(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 219, in _complement
[36m(main_task pid=405478)[0m     return Intersection(other, self.complement(S.Reals))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in simplify_intersection
[36m(main_task pid=405478)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in <genexpr>
[36m(main_task pid=405478)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=405478)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 455, in _
[36m(main_task pid=405478)[0m     if a.end < b.end:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=405478)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=405478)[0m TypeError: cannot determine truth value of Relational
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:31 - batch/bef_solve_none:56.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:4.000 - batch/solve_none:56.000 - batch/solve_none_format:0.000 - batch/solve_all:4.000 - batch/bef_solved:0.271 - batch/bef_failed:0.729 - batch/on_solved:0.271 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:35569.000 - global_seqlen/max:48721.000 - global_seqlen/minmax_diff:13152.000 - global_seqlen/balanced_min:41103.000 - global_seqlen/balanced_max:41145.000 - global_seqlen/mean:41122.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.119 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.119 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:10.314 - actor/pg_loss:0.376 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.002 - actor/grad_norm:1.280 - mfu/actor:0.471 - actor/lr:0.000 - actor/sft_entropy_loss:1.089 - actor/sft_loss:0.897 - actor/sft_grad_norm:0.182 - mfu/sft_actor:3.618 - actor/sft_lr:0.000 - critic/score/mean:0.271 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.271 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.093 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.093 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:5196.419 - response_length/max:8192.000 - response_length/min:203.000 - response_length/clip_ratio:0.595 - on_off_metrics/on_response_length_mean:5196.419 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.271 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.156 - prompt_length/max:458.000 - prompt_length/min:171.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:407.881 - timing_s/old_log_prob:42.698 - timing_s/adv:48.778 - timing_s/update_actor:133.501 - timing_s/sft_update_actor:20.259 - timing_s/step:610.579 - timing_per_token_ms/gen:0.077 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=406158)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:32 - batch/bef_solve_none:43.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:5.000 - batch/solve_none:43.000 - batch/solve_none_format:0.000 - batch/solve_all:5.000 - batch/bef_solved:0.294 - batch/bef_failed:0.706 - batch/on_solved:0.294 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:215409.000 - global_seqlen/max:400248.000 - global_seqlen/minmax_diff:184839.000 - global_seqlen/balanced_min:313202.000 - global_seqlen/balanced_max:318215.000 - global_seqlen/mean:313907.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.120 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.154 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.878 - actor/pg_loss:0.373 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.009 - actor/grad_norm:2.154 - mfu/actor:0.461 - actor/lr:0.000 - critic/score/mean:0.294 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.294 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.115 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.115 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:4668.614 - response_length/max:8192.000 - response_length/min:282.000 - response_length/clip_ratio:0.518 - on_off_metrics/on_response_length_mean:4668.614 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.294 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.195 - prompt_length/max:373.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:339.642 - timing_s/old_log_prob:35.231 - timing_s/adv:41.520 - timing_s/update_actor:122.601 - timing_s/step:503.931 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:33 - batch/bef_solve_none:44.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:3.000 - batch/solve_none:44.000 - batch/solve_none_format:0.000 - batch/solve_all:3.000 - batch/bef_solved:0.312 - batch/bef_failed:0.688 - batch/on_solved:0.312 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:240881.000 - global_seqlen/max:404805.000 - global_seqlen/minmax_diff:163924.000 - global_seqlen/balanced_min:313729.000 - global_seqlen/balanced_max:318589.000 - global_seqlen/mean:315559.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.089 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.148 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.949 - actor/pg_loss:0.275 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:1.810 - mfu/actor:0.460 - actor/lr:0.000 - critic/score/mean:0.312 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.312 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.131 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.131 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:4693.520 - response_length/max:8192.000 - response_length/min:263.000 - response_length/clip_ratio:0.521 - on_off_metrics/on_response_length_mean:4693.520 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.312 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.094 - prompt_length/max:435.000 - prompt_length/min:183.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:320.972 - timing_s/old_log_prob:35.003 - timing_s/adv:40.930 - timing_s/update_actor:123.361 - timing_s/step:485.440 - timing_per_token_ms/gen:0.067 - timing_per_token_ms/update_actor:0.024 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:34 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.348 - batch/bef_failed:0.652 - batch/on_solved:0.348 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32462.000 - global_seqlen/max:51171.000 - global_seqlen/minmax_diff:18709.000 - global_seqlen/balanced_min:44581.000 - global_seqlen/balanced_max:44642.000 - global_seqlen/mean:44607.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.102 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.172 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.637 - actor/pg_loss:0.290 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:3.677 - mfu/actor:0.430 - actor/lr:0.000 - actor/sft_entropy_loss:1.031 - actor/sft_loss:0.865 - actor/sft_grad_norm:0.180 - mfu/sft_actor:2.741 - actor/sft_lr:0.000 - critic/score/mean:0.348 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.348 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.115 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.115 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:4520.738 - response_length/max:8192.000 - response_length/min:181.000 - response_length/clip_ratio:0.502 - on_off_metrics/on_response_length_mean:4520.738 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.348 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.719 - prompt_length/max:686.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:325.122 - timing_s/old_log_prob:33.240 - timing_s/adv:37.591 - timing_s/update_actor:127.519 - timing_s/sft_update_actor:22.152 - timing_s/step:512.531 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:35 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:13.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:13.000 - batch/bef_solved:0.366 - batch/bef_failed:0.634 - batch/on_solved:0.366 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:215949.000 - global_seqlen/max:397863.000 - global_seqlen/minmax_diff:181914.000 - global_seqlen/balanced_min:283566.000 - global_seqlen/balanced_max:288602.000 - global_seqlen/mean:285769.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.137 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.176 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.598 - actor/pg_loss:0.395 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:1.362 - mfu/actor:0.448 - actor/lr:0.000 - critic/score/mean:0.366 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.366 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.103 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.103 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:4227.643 - response_length/max:8192.000 - response_length/min:238.000 - response_length/clip_ratio:0.460 - on_off_metrics/on_response_length_mean:4227.643 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.366 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.500 - prompt_length/max:463.000 - prompt_length/min:167.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:315.814 - timing_s/old_log_prob:33.751 - timing_s/adv:38.862 - timing_s/update_actor:114.596 - timing_s/step:469.408 - timing_per_token_ms/gen:0.073 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:36 - batch/bef_solve_none:36.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:18.000 - batch/solve_none:36.000 - batch/solve_none_format:0.000 - batch/solve_all:18.000 - batch/bef_solved:0.405 - batch/bef_failed:0.595 - batch/on_solved:0.405 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:181056.000 - global_seqlen/max:338203.000 - global_seqlen/minmax_diff:157147.000 - global_seqlen/balanced_min:254578.000 - global_seqlen/balanced_max:259226.000 - global_seqlen/mean:257667.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.121 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.196 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.354 - actor/pg_loss:0.295 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.239 - mfu/actor:0.435 - actor/lr:0.000 - critic/score/mean:0.405 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.405 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.116 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.116 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:3791.782 - response_length/max:8192.000 - response_length/min:234.000 - response_length/clip_ratio:0.399 - on_off_metrics/on_response_length_mean:3791.782 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.405 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:234.266 - prompt_length/max:397.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:296.392 - timing_s/old_log_prob:29.177 - timing_s/adv:34.157 - timing_s/update_actor:106.135 - timing_s/step:436.816 - timing_per_token_ms/gen:0.076 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:37 - batch/bef_solve_none:26.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:14.000 - batch/solve_none:26.000 - batch/solve_none_format:0.000 - batch/solve_all:14.000 - batch/bef_solved:0.444 - batch/bef_failed:0.556 - batch/on_solved:0.444 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:129819.000 - global_seqlen/max:368866.000 - global_seqlen/minmax_diff:239047.000 - global_seqlen/balanced_min:249160.000 - global_seqlen/balanced_max:253176.000 - global_seqlen/mean:249611.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.152 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.216 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.102 - actor/pg_loss:0.445 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.991 - mfu/actor:0.440 - actor/lr:0.000 - critic/score/mean:0.444 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.444 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.143 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.143 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:3659.149 - response_length/max:8192.000 - response_length/min:168.000 - response_length/clip_ratio:0.375 - on_off_metrics/on_response_length_mean:3659.149 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.444 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.023 - prompt_length/max:411.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:307.443 - timing_s/old_log_prob:32.077 - timing_s/adv:37.578 - timing_s/update_actor:101.692 - timing_s/step:446.849 - timing_per_token_ms/gen:0.082 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:38 - batch/bef_solve_none:38.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:16.000 - batch/solve_none:38.000 - batch/solve_none_format:0.000 - batch/solve_all:16.000 - batch/bef_solved:0.435 - batch/bef_failed:0.565 - batch/on_solved:0.435 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:34185.000 - global_seqlen/max:51627.000 - global_seqlen/minmax_diff:17442.000 - global_seqlen/balanced_min:41456.000 - global_seqlen/balanced_max:41532.000 - global_seqlen/mean:41498.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.079 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.218 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.091 - actor/pg_loss:0.222 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.824 - mfu/actor:0.452 - actor/lr:0.000 - actor/sft_entropy_loss:0.721 - actor/sft_loss:0.882 - actor/sft_grad_norm:0.191 - mfu/sft_actor:2.498 - actor/sft_lr:0.000 - critic/score/mean:0.435 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.435 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.125 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.125 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:3543.255 - response_length/max:8192.000 - response_length/min:150.000 - response_length/clip_ratio:0.363 - on_off_metrics/on_response_length_mean:3543.255 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.435 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.219 - prompt_length/max:387.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:304.121 - timing_s/old_log_prob:29.484 - timing_s/adv:34.910 - timing_s/update_actor:95.565 - timing_s/sft_update_actor:19.085 - timing_s/step:453.810 - timing_per_token_ms/gen:0.084 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=406159)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406157)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:39 - batch/bef_solve_none:35.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:13.000 - batch/solve_none:35.000 - batch/solve_none_format:0.000 - batch/solve_all:13.000 - batch/bef_solved:0.416 - batch/bef_failed:0.584 - batch/on_solved:0.416 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:140203.000 - global_seqlen/max:327675.000 - global_seqlen/minmax_diff:187472.000 - global_seqlen/balanced_min:244028.000 - global_seqlen/balanced_max:248228.000 - global_seqlen/mean:246696.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.155 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.249 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:8.699 - actor/pg_loss:0.433 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.003 - actor/grad_norm:3.915 - mfu/actor:0.444 - actor/lr:0.000 - critic/score/mean:0.416 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.416 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.112 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.112 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:3612.579 - response_length/max:8192.000 - response_length/min:215.000 - response_length/clip_ratio:0.369 - on_off_metrics/on_response_length_mean:3612.579 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.416 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.047 - prompt_length/max:395.000 - prompt_length/min:170.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:273.603 - timing_s/old_log_prob:28.748 - timing_s/adv:34.450 - timing_s/update_actor:99.018 - timing_s/step:407.223 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m Validation: Generation end.
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   warnings.warn(
[36m(main_task pid=405478)[0m Saving best checkpoint with score 0.41450987791740335 at ./train_results/rl-sft/7b_math_instruct_interleave/best/actor
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Saving actor checkpoint to ./train_results/rl-sft/7b_math_instruct_interleave/best/actor
[36m(main_task pid=405478)[0m step:40 - batch/bef_solve_none:26.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:17.000 - batch/solve_none:26.000 - batch/solve_none_format:0.000 - batch/solve_all:17.000 - batch/bef_solved:0.447 - batch/bef_failed:0.553 - batch/on_solved:0.447 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:193515.000 - global_seqlen/max:351930.000 - global_seqlen/minmax_diff:158415.000 - global_seqlen/balanced_min:254494.000 - global_seqlen/balanced_max:259179.000 - global_seqlen/mean:256251.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.091 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.186 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.443 - actor/pg_loss:0.264 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.628 - mfu/actor:0.434 - actor/lr:0.000 - val/test_score/amc:0.470 - val/test_score/olympiad_bench:0.391 - val/test_score/minerva:0.268 - val/test_score/math:0.806 - val/test_score/aime:0.138 - avg_score:0.415 - critic/score/mean:0.447 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.447 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.136 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.136 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:3763.189 - response_length/max:8192.000 - response_length/min:218.000 - response_length/clip_ratio:0.396 - on_off_metrics/on_response_length_mean:3763.189 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.447 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.734 - prompt_length/max:503.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:270.381 - timing_s/old_log_prob:29.961 - timing_s/adv:35.247 - timing_s/update_actor:105.859 - timing_s/testing:310.499 - timing_s/step:775.823 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:41 - batch/bef_solve_none:34.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:34.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.383 - batch/bef_failed:0.617 - batch/on_solved:0.383 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:180443.000 - global_seqlen/max:334752.000 - global_seqlen/minmax_diff:154309.000 - global_seqlen/balanced_min:265869.000 - global_seqlen/balanced_max:270144.000 - global_seqlen/mean:267531.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.103 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.243 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:8.773 - actor/pg_loss:0.324 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.006 - actor/grad_norm:3.322 - mfu/actor:0.453 - actor/lr:0.000 - critic/score/mean:0.383 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.383 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.103 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.103 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:3937.051 - response_length/max:8192.000 - response_length/min:224.000 - response_length/clip_ratio:0.412 - on_off_metrics/on_response_length_mean:3937.051 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.383 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.133 - prompt_length/max:440.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:309.292 - timing_s/old_log_prob:28.322 - timing_s/adv:35.098 - timing_s/update_actor:106.461 - timing_s/step:450.992 - timing_per_token_ms/gen:0.077 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m step:42 - batch/bef_solve_none:31.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:15.000 - batch/solve_none:31.000 - batch/solve_none_format:0.000 - batch/solve_all:15.000 - batch/bef_solved:0.407 - batch/bef_failed:0.593 - batch/on_solved:0.407 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:34361.000 - global_seqlen/max:50612.000 - global_seqlen/minmax_diff:16251.000 - global_seqlen/balanced_min:43445.000 - global_seqlen/balanced_max:43588.000 - global_seqlen/mean:43549.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.077 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.223 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:9.021 - actor/pg_loss:0.225 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:1.560 - mfu/actor:0.457 - actor/lr:0.000 - actor/sft_entropy_loss:0.685 - actor/sft_loss:0.763 - actor/sft_grad_norm:0.206 - mfu/sft_actor:2.868 - actor/sft_lr:0.000 - critic/score/mean:0.407 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.407 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.097 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.097 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:4002.876 - response_length/max:8192.000 - response_length/min:198.000 - response_length/clip_ratio:0.418 - on_off_metrics/on_response_length_mean:4002.876 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.407 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.742 - prompt_length/max:477.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:301.752 - timing_s/old_log_prob:30.322 - timing_s/adv:35.069 - timing_s/update_actor:106.911 - timing_s/sft_update_actor:19.414 - timing_s/step:463.327 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:43 - batch/bef_solve_none:38.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:38.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.427 - batch/bef_failed:0.573 - batch/on_solved:0.427 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:154380.000 - global_seqlen/max:340674.000 - global_seqlen/minmax_diff:186294.000 - global_seqlen/balanced_min:265413.000 - global_seqlen/balanced_max:269823.000 - global_seqlen/mean:266541.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.033 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.248 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:8.729 - actor/pg_loss:0.100 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.579 - mfu/actor:0.448 - actor/lr:0.000 - critic/score/mean:0.427 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.427 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.098 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.098 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:3927.498 - response_length/max:8192.000 - response_length/min:176.000 - response_length/clip_ratio:0.410 - on_off_metrics/on_response_length_mean:3927.498 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.427 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.219 - prompt_length/max:425.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:300.568 - timing_s/old_log_prob:28.469 - timing_s/adv:32.909 - timing_s/update_actor:106.334 - timing_s/step:439.976 - timing_per_token_ms/gen:0.075 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406162)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:44 - batch/bef_solve_none:30.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:19.000 - batch/solve_none:30.000 - batch/solve_none_format:0.000 - batch/solve_all:19.000 - batch/bef_solved:0.473 - batch/bef_failed:0.527 - batch/on_solved:0.473 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:137329.000 - global_seqlen/max:290872.000 - global_seqlen/minmax_diff:153543.000 - global_seqlen/balanced_min:218694.000 - global_seqlen/balanced_max:223154.000 - global_seqlen/mean:220931.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.155 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.326 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:7.757 - actor/pg_loss:0.431 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.198 - mfu/actor:0.413 - actor/lr:0.000 - critic/score/mean:0.473 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.473 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.109 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.109 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:3209.775 - response_length/max:8192.000 - response_length/min:212.000 - response_length/clip_ratio:0.304 - on_off_metrics/on_response_length_mean:3209.775 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.473 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.281 - prompt_length/max:544.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:250.253 - timing_s/old_log_prob:24.891 - timing_s/adv:30.983 - timing_s/update_actor:94.971 - timing_s/step:376.388 - timing_per_token_ms/gen:0.076 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:45 - batch/bef_solve_none:23.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:25.000 - batch/solve_none:23.000 - batch/solve_none_format:0.000 - batch/solve_all:25.000 - batch/bef_solved:0.545 - batch/bef_failed:0.455 - batch/on_solved:0.545 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:100789.000 - global_seqlen/max:270374.000 - global_seqlen/minmax_diff:169585.000 - global_seqlen/balanced_min:203362.000 - global_seqlen/balanced_max:207332.000 - global_seqlen/mean:205643.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.173 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.344 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:7.546 - actor/pg_loss:0.455 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.211 - mfu/actor:0.405 - actor/lr:0.000 - critic/score/mean:0.545 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.545 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.120 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.120 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2963.521 - response_length/max:8192.000 - response_length/min:181.000 - response_length/clip_ratio:0.273 - on_off_metrics/on_response_length_mean:2963.521 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.545 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:249.656 - prompt_length/max:728.000 - prompt_length/min:171.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:243.124 - timing_s/old_log_prob:24.696 - timing_s/adv:29.107 - timing_s/update_actor:89.719 - timing_s/step:362.097 - timing_per_token_ms/gen:0.080 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m ERROR:2025-06-03 22:51:11,111:Error comparing (pi/4 <= x) & (x <= (7*pi)/4) and Union(Interval(pi/4, (3*pi)/4), Interval((5*pi)/4, (7*pi)/4))
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=405478)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=405478)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=405478)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=405478)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=405478)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1731, in reduce
[36m(main_task pid=405478)[0m     if B == S.UniversalSet or A.is_subset(B):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1434, in is_subset
[36m(main_task pid=405478)[0m     return fuzzy_and(s.is_subset(other) for s in self.args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/logic.py", line 142, in fuzzy_and
[36m(main_task pid=405478)[0m     for ai in args:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1434, in <genexpr>
[36m(main_task pid=405478)[0m     return fuzzy_and(s.is_subset(other) for s in self.args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 430, in is_subset
[36m(main_task pid=405478)[0m     if self.intersect(other) == self:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 150, in intersect
[36m(main_task pid=405478)[0m     return Intersection(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=405478)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 432, in _
[36m(main_task pid=405478)[0m     if a.start < b.start:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=405478)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=405478)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=405478)[0m ERROR:2025-06-03 22:51:11,225:Error comparing (pi/4 <= x) & (x <= (7*pi)/4) and Union(Interval(pi/4, (3*pi)/4), Interval((5*pi)/4, (7*pi)/4))
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=405478)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=405478)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=405478)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=405478)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=405478)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1731, in reduce
[36m(main_task pid=405478)[0m     if B == S.UniversalSet or A.is_subset(B):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1434, in is_subset
[36m(main_task pid=405478)[0m     return fuzzy_and(s.is_subset(other) for s in self.args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/logic.py", line 142, in fuzzy_and
[36m(main_task pid=405478)[0m     for ai in args:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1434, in <genexpr>
[36m(main_task pid=405478)[0m     return fuzzy_and(s.is_subset(other) for s in self.args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 430, in is_subset
[36m(main_task pid=405478)[0m     if self.intersect(other) == self:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 150, in intersect
[36m(main_task pid=405478)[0m     return Intersection(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=405478)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 432, in _
[36m(main_task pid=405478)[0m     if a.start < b.start:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=405478)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=405478)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=405478)[0m ERROR:2025-06-03 22:51:11,305:Error comparing (pi/4 <= x) & (x <= (7*pi)/4) and Union(Interval(pi/4, (3*pi)/4), Interval((5*pi)/4, (7*pi)/4))
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=405478)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=405478)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=405478)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=405478)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=405478)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1731, in reduce
[36m(main_task pid=405478)[0m     if B == S.UniversalSet or A.is_subset(B):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1434, in is_subset
[36m(main_task pid=405478)[0m     return fuzzy_and(s.is_subset(other) for s in self.args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/logic.py", line 142, in fuzzy_and
[36m(main_task pid=405478)[0m     for ai in args:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1434, in <genexpr>
[36m(main_task pid=405478)[0m     return fuzzy_and(s.is_subset(other) for s in self.args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 430, in is_subset
[36m(main_task pid=405478)[0m     if self.intersect(other) == self:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 150, in intersect
[36m(main_task pid=405478)[0m     return Intersection(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=405478)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 432, in _
[36m(main_task pid=405478)[0m     if a.start < b.start:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=405478)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=405478)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=405478)[0m ERROR:2025-06-03 22:51:11,551:Error comparing (pi/4 <= x) & (x <= (7*pi)/4) and Union({pi/4}, Interval((5*pi)/6, (5*pi)/3))
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=405478)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=405478)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=405478)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=405478)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=405478)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1735, in reduce
[36m(main_task pid=405478)[0m     return Intersection(*(s.complement(A) for s in B.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1735, in <genexpr>
[36m(main_task pid=405478)[0m     return Intersection(*(s.complement(A) for s in B.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 199, in complement
[36m(main_task pid=405478)[0m     return Complement(universe, self)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=405478)[0m     return Complement.reduce(a, b)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=405478)[0m     result = B._complement(A)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2025, in _complement
[36m(main_task pid=405478)[0m     return Set._complement(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 219, in _complement
[36m(main_task pid=405478)[0m     return Intersection(other, self.complement(S.Reals))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in simplify_intersection
[36m(main_task pid=405478)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in <genexpr>
[36m(main_task pid=405478)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=405478)[0m     return simplify_intersection(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=405478)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 430, in _
[36m(main_task pid=405478)[0m     if a.start <= b.end and b.start <= a.end:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=405478)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=405478)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=405478)[0m ERROR:2025-06-03 22:51:15,435:Error comparing 3*n**2 + 3*n + 1 and Sum(binomial(2*n, k)*binomial(-k + 2*n, n), (k, 0, n))**2
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=405478)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 760, in simplify
[36m(main_task pid=405478)[0m     return done(expr)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 585, in done
[36m(main_task pid=405478)[0m     rv = e.doit() if doit else e
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=405478)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=405478)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=405478)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=405478)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 1927, in doit
[36m(main_task pid=405478)[0m     terms = [term.doit(**hints) if isinstance(term, Basic) else term
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 1927, in <listcomp>
[36m(main_task pid=405478)[0m     terms = [term.doit(**hints) if isinstance(term, Basic) else term
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 252, in doit
[36m(main_task pid=405478)[0m     newf = eval_sum(f, (i, a, b))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1048, in eval_sum
[36m(main_task pid=405478)[0m     value = eval_sum_symbolic(f.expand(), (i, a, b))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1131, in eval_sum_symbolic
[36m(main_task pid=405478)[0m     s = eval_sum_symbolic(with_i, (i, a, b))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1252, in eval_sum_symbolic
[36m(main_task pid=405478)[0m     h = eval_sum_hyper(f_orig, (i, a, b))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1343, in eval_sum_hyper
[36m(main_task pid=405478)[0m     res2 = _eval_sum_hyper(f, i, b + 1)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1268, in _eval_sum_hyper
[36m(main_task pid=405478)[0m     return _eval_sum_hyper(f.subs(i, i + a), i, 0)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1274, in _eval_sum_hyper
[36m(main_task pid=405478)[0m     return _eval_sum_hyper(f.subs(i, i + 1), i, 0)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1274, in _eval_sum_hyper
[36m(main_task pid=405478)[0m     return _eval_sum_hyper(f.subs(i, i + 1), i, 0)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1274, in _eval_sum_hyper
[36m(main_task pid=405478)[0m     return _eval_sum_hyper(f.subs(i, i + 1), i, 0)
[36m(main_task pid=405478)[0m   [Previous line repeated 9 more times]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1272, in _eval_sum_hyper
[36m(main_task pid=405478)[0m     if simplify(f.subs(i, Dummy('i', integer=True, positive=True))) == 0:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 707, in simplify
[36m(main_task pid=405478)[0m     expr = combsimp(expr)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/combsimp.py", line 53, in combsimp
[36m(main_task pid=405478)[0m     return gammasimp(expr);
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 81, in gammasimp
[36m(main_task pid=405478)[0m     return _gammasimp(expr, as_comb=False)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 457, in _gammasimp
[36m(main_task pid=405478)[0m     expr = rule_gamma(was)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 178, in rule_gamma
[36m(main_task pid=405478)[0m     expr = rule_gamma(expr, 4)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 437, in rule_gamma
[36m(main_task pid=405478)[0m     y = find_fuzzy(denom, g - 1)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 394, in find_fuzzy
[36m(main_task pid=405478)[0m     a = len(cancel(x/y).free_symbols)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=405478)[0m     return func(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 106, in binary_op_wrapper
[36m(main_task pid=405478)[0m     return func(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 259, in __truediv__
[36m(main_task pid=405478)[0m     return Mul(self, denom)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=405478)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 57, in __new__
[36m(main_task pid=405478)[0m     args = list(map(_sympify_, args))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 514, in _sympify
[36m(main_task pid=405478)[0m     return sympify(a, strict=True)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 374, in sympify
[36m(main_task pid=405478)[0m     is_sympy = getattr(a, '__sympy__', None)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 178, in __sympy__
[36m(main_task pid=405478)[0m     @property
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=405478)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=405478)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:46 - batch/bef_solve_none:35.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:35.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.409 - batch/bef_failed:0.591 - batch/on_solved:0.409 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:36419.000 - global_seqlen/max:49189.000 - global_seqlen/minmax_diff:12770.000 - global_seqlen/balanced_min:43026.000 - global_seqlen/balanced_max:43140.000 - global_seqlen/mean:43114.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.075 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.348 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:7.473 - actor/pg_loss:0.213 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.183 - mfu/actor:0.444 - actor/lr:0.000 - actor/sft_entropy_loss:0.609 - actor/sft_loss:0.850 - actor/sft_grad_norm:0.215 - mfu/sft_actor:2.002 - actor/sft_lr:0.000 - critic/score/mean:0.409 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.409 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.116 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.116 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:3003.893 - response_length/max:8192.000 - response_length/min:208.000 - response_length/clip_ratio:0.279 - on_off_metrics/on_response_length_mean:3003.893 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.409 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.219 - prompt_length/max:404.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:240.794 - timing_s/old_log_prob:25.234 - timing_s/adv:35.747 - timing_s/update_actor:83.249 - timing_s/sft_update_actor:20.283 - timing_s/step:380.222 - timing_per_token_ms/gen:0.078 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=405478)[0m ERROR:2025-06-03 22:57:01,384:Error comparing Eq(16*(x - 1)**2 + (y + 1/2)**2, 4) & Eq((x - 2)**2 + (y + 3)**2, 16*(x - 1)**2 + (y + 1/2)**2) and Eq((x - 1)**2 + (y + 1/2)**2, 4)
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=405478)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=405478)[0m AttributeError: 'Equality' object has no attribute '_unsorted_args'
[36m(main_task pid=405478)[0m ERROR:2025-06-03 22:57:01,503:Error comparing Eq(16*(x - 1)**2 + (y + 1/2)**2, 4) & Eq((x - 2)**2 + (y + 3)**2, 16*(x - 1)**2 + (y + 1/2)**2) and Eq((x - 1)**2 + (y + 1/2)**2, 4)
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=405478)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=405478)[0m AttributeError: 'Equality' object has no attribute '_unsorted_args'
[36m(main_task pid=405478)[0m ERROR:2025-06-03 22:57:01,531:Error comparing Eq(16*(x - 1)**2 + (y + 1/2)**2, 4) & Eq((x - 2)**2 + (y + 3)**2, 16*(x - 1)**2 + (y + 1/2)**2) and Eq((x - 1)**2 + (y + 1/2)**2, 4)
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=405478)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=405478)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=405478)[0m AttributeError: 'Equality' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:47 - batch/bef_solve_none:25.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:18.000 - batch/solve_none:25.000 - batch/solve_none_format:0.000 - batch/solve_all:18.000 - batch/bef_solved:0.479 - batch/bef_failed:0.521 - batch/on_solved:0.479 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:108505.000 - global_seqlen/max:242011.000 - global_seqlen/minmax_diff:133506.000 - global_seqlen/balanced_min:164467.000 - global_seqlen/balanced_max:168749.000 - global_seqlen/mean:165537.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.043 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.418 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:6.590 - actor/pg_loss:0.143 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.181 - mfu/actor:0.410 - actor/lr:0.000 - critic/score/mean:0.479 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.479 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.130 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.130 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2340.498 - response_length/max:8192.000 - response_length/min:164.000 - response_length/clip_ratio:0.191 - on_off_metrics/on_response_length_mean:2340.498 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.479 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:246.031 - prompt_length/max:730.000 - prompt_length/min:181.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:209.693 - timing_s/old_log_prob:19.794 - timing_s/adv:25.925 - timing_s/update_actor:70.801 - timing_s/step:306.548 - timing_per_token_ms/gen:0.087 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:48 - batch/bef_solve_none:22.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:24.000 - batch/solve_none:22.000 - batch/solve_none_format:0.000 - batch/solve_all:24.000 - batch/bef_solved:0.499 - batch/bef_failed:0.501 - batch/on_solved:0.499 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:104168.000 - global_seqlen/max:261113.000 - global_seqlen/minmax_diff:156945.000 - global_seqlen/balanced_min:171336.000 - global_seqlen/balanced_max:174624.000 - global_seqlen/mean:173595.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.243 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.359 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:7.323 - actor/pg_loss:0.550 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.176 - mfu/actor:0.406 - actor/lr:0.000 - critic/score/mean:0.499 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.499 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.134 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.134 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2462.749 - response_length/max:8192.000 - response_length/min:183.000 - response_length/clip_ratio:0.214 - on_off_metrics/on_response_length_mean:2462.749 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.499 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:249.688 - prompt_length/max:653.000 - prompt_length/min:183.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:224.329 - timing_s/old_log_prob:22.761 - timing_s/adv:28.143 - timing_s/update_actor:75.903 - timing_s/step:328.518 - timing_per_token_ms/gen:0.089 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:49 - batch/bef_solve_none:14.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:26.000 - batch/solve_none:14.000 - batch/solve_none_format:0.000 - batch/solve_all:26.000 - batch/bef_solved:0.528 - batch/bef_failed:0.472 - batch/on_solved:0.528 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:84529.000 - global_seqlen/max:258077.000 - global_seqlen/minmax_diff:173548.000 - global_seqlen/balanced_min:166508.000 - global_seqlen/balanced_max:170072.000 - global_seqlen/mean:168546.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.186 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.404 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:6.762 - actor/pg_loss:0.523 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.183 - mfu/actor:0.412 - actor/lr:0.000 - critic/score/mean:0.528 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.528 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.143 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.143 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2397.656 - response_length/max:8192.000 - response_length/min:185.000 - response_length/clip_ratio:0.196 - on_off_metrics/on_response_length_mean:2397.656 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.528 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:235.875 - prompt_length/max:442.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:224.010 - timing_s/old_log_prob:21.704 - timing_s/adv:25.541 - timing_s/update_actor:71.927 - timing_s/step:321.641 - timing_per_token_ms/gen:0.091 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406160)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m 
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m Validation: Generation end.
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   warnings.warn(
[36m(main_task pid=405478)[0m Saving best checkpoint with score 0.4291827920018506 at ./train_results/rl-sft/7b_math_instruct_interleave/best/actor
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m Saving actor checkpoint to ./train_results/rl-sft/7b_math_instruct_interleave/best/actor
[36m(main_task pid=405478)[0m step:50 - batch/bef_solve_none:35.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:21.000 - batch/solve_none:35.000 - batch/solve_none_format:0.000 - batch/solve_all:21.000 - batch/bef_solved:0.440 - batch/bef_failed:0.560 - batch/on_solved:0.440 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:79283.000 - global_seqlen/max:244741.000 - global_seqlen/minmax_diff:165458.000 - global_seqlen/balanced_min:169475.000 - global_seqlen/balanced_max:173019.000 - global_seqlen/mean:172199.500 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.097 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.476 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.894 - actor/pg_loss:0.286 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.158 - mfu/actor:0.420 - actor/lr:0.000 - val/test_score/olympiad_bench:0.404 - val/test_score/aime:0.142 - val/test_score/amc:0.485 - val/test_score/math:0.810 - val/test_score/minerva:0.305 - avg_score:0.429 - critic/score/mean:0.440 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.440 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.097 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.097 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2447.781 - response_length/max:8192.000 - response_length/min:210.000 - response_length/clip_ratio:0.199 - on_off_metrics/on_response_length_mean:2447.781 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.440 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.836 - prompt_length/max:498.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:213.903 - timing_s/old_log_prob:20.827 - timing_s/adv:27.849 - timing_s/update_actor:72.093 - timing_s/testing:236.667 - timing_s/step:605.373 - timing_per_token_ms/gen:0.085 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:51 - batch/bef_solve_none:30.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:19.000 - batch/solve_none:30.000 - batch/solve_none_format:0.000 - batch/solve_all:19.000 - batch/bef_solved:0.437 - batch/bef_failed:0.563 - batch/on_solved:0.437 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:38560.000 - global_seqlen/max:51772.000 - global_seqlen/minmax_diff:13212.000 - global_seqlen/balanced_min:44750.000 - global_seqlen/balanced_max:44871.000 - global_seqlen/mean:44818.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.069 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.424 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:6.521 - actor/pg_loss:0.177 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.167 - mfu/actor:0.443 - actor/lr:0.000 - actor/sft_entropy_loss:0.645 - actor/sft_loss:0.818 - actor/sft_grad_norm:0.215 - mfu/sft_actor:1.649 - actor/sft_lr:0.000 - critic/score/mean:0.437 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.437 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.108 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.108 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2554.881 - response_length/max:8192.000 - response_length/min:152.000 - response_length/clip_ratio:0.218 - on_off_metrics/on_response_length_mean:2554.881 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.437 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.945 - prompt_length/max:727.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:222.123 - timing_s/old_log_prob:23.410 - timing_s/adv:28.727 - timing_s/update_actor:71.570 - timing_s/sft_update_actor:20.849 - timing_s/step:343.400 - timing_per_token_ms/gen:0.085 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:52 - batch/bef_solve_none:19.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:19.000 - batch/solve_none:19.000 - batch/solve_none_format:0.000 - batch/solve_all:19.000 - batch/bef_solved:0.531 - batch/bef_failed:0.469 - batch/on_solved:0.531 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:105676.000 - global_seqlen/max:215927.000 - global_seqlen/minmax_diff:110251.000 - global_seqlen/balanced_min:153724.000 - global_seqlen/balanced_max:157264.000 - global_seqlen/mean:156389.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.088 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.468 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.964 - actor/pg_loss:0.219 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.192 - mfu/actor:0.404 - actor/lr:0.000 - critic/score/mean:0.531 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.531 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.152 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.152 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2198.587 - response_length/max:8192.000 - response_length/min:188.000 - response_length/clip_ratio:0.167 - on_off_metrics/on_response_length_mean:2198.587 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.531 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.992 - prompt_length/max:514.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:206.030 - timing_s/old_log_prob:18.530 - timing_s/adv:24.544 - timing_s/update_actor:67.477 - timing_s/step:298.208 - timing_per_token_ms/gen:0.092 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:53 - batch/bef_solve_none:26.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:21.000 - batch/solve_none:26.000 - batch/solve_none_format:0.000 - batch/solve_all:21.000 - batch/bef_solved:0.489 - batch/bef_failed:0.511 - batch/on_solved:0.489 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:101800.000 - global_seqlen/max:261666.000 - global_seqlen/minmax_diff:159866.000 - global_seqlen/balanced_min:155844.000 - global_seqlen/balanced_max:159013.000 - global_seqlen/mean:157824.375 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.130 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.433 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:6.402 - actor/pg_loss:0.335 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.170 - mfu/actor:0.442 - actor/lr:0.000 - critic/score/mean:0.489 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.489 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.123 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.123 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2224.842 - response_length/max:8192.000 - response_length/min:212.000 - response_length/clip_ratio:0.166 - on_off_metrics/on_response_length_mean:2224.842 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.489 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.164 - prompt_length/max:448.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:224.328 - timing_s/old_log_prob:22.834 - timing_s/adv:26.841 - timing_s/update_actor:62.676 - timing_s/step:313.981 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:54 - batch/bef_solve_none:28.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:26.000 - batch/solve_none:28.000 - batch/solve_none_format:0.000 - batch/solve_all:26.000 - batch/bef_solved:0.491 - batch/bef_failed:0.509 - batch/on_solved:0.491 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:72974.000 - global_seqlen/max:232250.000 - global_seqlen/minmax_diff:159276.000 - global_seqlen/balanced_min:149005.000 - global_seqlen/balanced_max:152675.000 - global_seqlen/mean:149694.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.150 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.426 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:6.402 - actor/pg_loss:0.425 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.157 - mfu/actor:0.419 - actor/lr:0.000 - critic/score/mean:0.491 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.491 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.105 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.105 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2102.821 - response_length/max:8192.000 - response_length/min:183.000 - response_length/clip_ratio:0.159 - on_off_metrics/on_response_length_mean:2102.821 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.491 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.148 - prompt_length/max:393.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.978 - timing_s/old_log_prob:20.714 - timing_s/adv:25.405 - timing_s/update_actor:62.371 - timing_s/step:286.886 - timing_per_token_ms/gen:0.092 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:55 - batch/bef_solve_none:23.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:30.000 - batch/solve_none:23.000 - batch/solve_none_format:0.000 - batch/solve_all:30.000 - batch/bef_solved:0.514 - batch/bef_failed:0.486 - batch/on_solved:0.514 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:95821.000 - global_seqlen/max:213929.000 - global_seqlen/minmax_diff:118108.000 - global_seqlen/balanced_min:152802.000 - global_seqlen/balanced_max:154928.000 - global_seqlen/mean:154629.375 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.186 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.470 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.923 - actor/pg_loss:0.451 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.161 - mfu/actor:0.386 - actor/lr:0.000 - critic/score/mean:0.514 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.514 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.111 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.111 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2178.779 - response_length/max:8192.000 - response_length/min:113.000 - response_length/clip_ratio:0.152 - on_off_metrics/on_response_length_mean:2178.779 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.514 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.305 - prompt_length/max:645.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.400 - timing_s/old_log_prob:19.037 - timing_s/adv:24.173 - timing_s/update_actor:69.704 - timing_s/step:286.430 - timing_per_token_ms/gen:0.086 - timing_per_token_ms/update_actor:0.028 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:56 - batch/bef_solve_none:20.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:34.000 - batch/solve_none:20.000 - batch/solve_none_format:0.000 - batch/solve_all:34.000 - batch/bef_solved:0.549 - batch/bef_failed:0.451 - batch/on_solved:0.549 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:37815.000 - global_seqlen/max:51048.000 - global_seqlen/minmax_diff:13233.000 - global_seqlen/balanced_min:43185.000 - global_seqlen/balanced_max:43280.000 - global_seqlen/mean:43234.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.175 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.484 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.760 - actor/pg_loss:0.462 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.165 - mfu/actor:0.405 - actor/lr:0.000 - actor/sft_entropy_loss:0.569 - actor/sft_loss:0.747 - actor/sft_grad_norm:0.230 - mfu/sft_actor:1.450 - actor/sft_lr:0.000 - critic/score/mean:0.549 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.549 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.131 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.131 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1982.024 - response_length/max:8192.000 - response_length/min:130.000 - response_length/clip_ratio:0.137 - on_off_metrics/on_response_length_mean:1982.024 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.549 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.430 - prompt_length/max:387.000 - prompt_length/min:170.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.817 - timing_s/old_log_prob:16.923 - timing_s/adv:21.416 - timing_s/update_actor:61.082 - timing_s/sft_update_actor:18.635 - timing_s/step:294.093 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:57 - batch/bef_solve_none:28.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:26.000 - batch/solve_none:28.000 - batch/solve_none_format:0.000 - batch/solve_all:26.000 - batch/bef_solved:0.492 - batch/bef_failed:0.508 - batch/on_solved:0.492 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:67473.000 - global_seqlen/max:225353.000 - global_seqlen/minmax_diff:157880.000 - global_seqlen/balanced_min:144008.000 - global_seqlen/balanced_max:144296.000 - global_seqlen/mean:144028.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.104 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.492 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.590 - actor/pg_loss:0.230 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.164 - mfu/actor:0.397 - actor/lr:0.000 - critic/score/mean:0.492 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.492 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.127 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.127 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2003.689 - response_length/max:8192.000 - response_length/min:165.000 - response_length/clip_ratio:0.141 - on_off_metrics/on_response_length_mean:2003.689 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.492 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:246.758 - prompt_length/max:528.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.796 - timing_s/old_log_prob:18.990 - timing_s/adv:25.150 - timing_s/update_actor:62.679 - timing_s/step:285.711 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:58 - batch/bef_solve_none:29.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:20.000 - batch/solve_none:29.000 - batch/solve_none_format:0.000 - batch/solve_all:20.000 - batch/bef_solved:0.491 - batch/bef_failed:0.509 - batch/on_solved:0.491 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:77571.000 - global_seqlen/max:213877.000 - global_seqlen/minmax_diff:136306.000 - global_seqlen/balanced_min:150338.000 - global_seqlen/balanced_max:153718.000 - global_seqlen/mean:151816.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.117 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.502 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.442 - actor/pg_loss:0.310 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.516 - mfu/actor:0.431 - actor/lr:0.000 - critic/score/mean:0.491 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.491 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.129 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.129 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2132.067 - response_length/max:8192.000 - response_length/min:205.000 - response_length/clip_ratio:0.147 - on_off_metrics/on_response_length_mean:2132.067 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.491 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.070 - prompt_length/max:404.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.150 - timing_s/old_log_prob:19.016 - timing_s/adv:25.620 - timing_s/update_actor:61.219 - timing_s/step:280.098 - timing_per_token_ms/gen:0.088 - timing_per_token_ms/update_actor:0.025 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693734, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:59 - batch/bef_solve_none:18.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:23.000 - batch/solve_none:18.000 - batch/solve_none_format:0.000 - batch/solve_all:23.000 - batch/bef_solved:0.534 - batch/bef_failed:0.466 - batch/on_solved:0.534 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:82925.000 - global_seqlen/max:189747.000 - global_seqlen/minmax_diff:106822.000 - global_seqlen/balanced_min:128408.000 - global_seqlen/balanced_max:130771.000 - global_seqlen/mean:130571.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.158 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.526 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.194 - actor/pg_loss:0.378 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.185 - mfu/actor:0.391 - actor/lr:0.000 - critic/score/mean:0.534 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.534 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.143 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.143 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1799.873 - response_length/max:8192.000 - response_length/min:165.000 - response_length/clip_ratio:0.107 - on_off_metrics/on_response_length_mean:1799.873 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.534 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.312 - prompt_length/max:476.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:188.939 - timing_s/old_log_prob:16.755 - timing_s/adv:21.827 - timing_s/update_actor:57.772 - timing_s/step:268.632 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/update_actor:0.028 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m Validation: Generation end.
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:60 - batch/bef_solve_none:22.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:26.000 - batch/solve_none:22.000 - batch/solve_none_format:0.000 - batch/solve_all:26.000 - batch/bef_solved:0.524 - batch/bef_failed:0.476 - batch/on_solved:0.524 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:80239.000 - global_seqlen/max:201484.000 - global_seqlen/minmax_diff:121245.000 - global_seqlen/balanced_min:139586.000 - global_seqlen/balanced_max:142077.000 - global_seqlen/mean:140832.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.149 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.533 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.139 - actor/pg_loss:0.348 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.165 - mfu/actor:0.403 - actor/lr:0.000 - val/test_score/math:0.812 - val/test_score/olympiad_bench:0.394 - val/test_score/aime:0.154 - val/test_score/amc:0.485 - val/test_score/minerva:0.265 - avg_score:0.422 - critic/score/mean:0.524 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.524 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.095 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.095 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1952.730 - response_length/max:8192.000 - response_length/min:186.000 - response_length/clip_ratio:0.117 - on_off_metrics/on_response_length_mean:1952.730 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.524 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:247.773 - prompt_length/max:531.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.886 - timing_s/old_log_prob:18.558 - timing_s/adv:23.739 - timing_s/update_actor:60.353 - timing_s/testing:239.368 - timing_s/step:518.446 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.011
[36m(main_task pid=405478)[0m ERROR:2025-06-04 00:15:57,042:Error during parsing
[36m(main_task pid=405478)[0m ValueError: Error from parse_expr with transformed code: '６'
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=405478)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=405478)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=405478)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=405478)[0m     expr = eval(
[36m(main_task pid=405478)[0m   File "<string>", line 1
[36m(main_task pid=405478)[0m     ６
[36m(main_task pid=405478)[0m     ^
[36m(main_task pid=405478)[0m SyntaxError: invalid character '６' (U+FF16)
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=405478)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=405478)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=405478)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=405478)[0m     number = Number(number_str)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=405478)[0m     val = sympify(obj)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=405478)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=405478)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse '６'' failed, because of exception being raised:
[36m(main_task pid=405478)[0m SyntaxError: invalid character '６' (U+FF16) (<string>, line 1)
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:61 - batch/bef_solve_none:23.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:16.000 - batch/solve_none:23.000 - batch/solve_none_format:0.000 - batch/solve_all:16.000 - batch/bef_solved:0.477 - batch/bef_failed:0.523 - batch/on_solved:0.477 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:97074.000 - global_seqlen/max:181934.000 - global_seqlen/minmax_diff:84860.000 - global_seqlen/balanced_min:141918.000 - global_seqlen/balanced_max:145447.000 - global_seqlen/mean:142378.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.103 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.525 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.175 - actor/pg_loss:0.290 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.164 - mfu/actor:0.379 - actor/lr:0.000 - critic/score/mean:0.477 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.477 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.107 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.107 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1989.734 - response_length/max:8192.000 - response_length/min:205.000 - response_length/clip_ratio:0.127 - on_off_metrics/on_response_length_mean:1989.734 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.477 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:234.922 - prompt_length/max:385.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:188.501 - timing_s/old_log_prob:16.543 - timing_s/adv:21.131 - timing_s/update_actor:64.687 - timing_s/step:274.405 - timing_per_token_ms/gen:0.093 - timing_per_token_ms/update_actor:0.028 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406158)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m ERROR:2025-06-04 00:20:36,081:Error comparing (-x**3 + x**2 + 1)**1000 and (x**3 - x**2 + 1)**1000
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=405478)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 644, in simplify
[36m(main_task pid=405478)[0m     _e = cancel(expr)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7182, in cancel
[36m(main_task pid=405478)[0m     R, (F, G) = sring((p, q), *gens, **args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 163, in sring
[36m(main_task pid=405478)[0m     reps, opt = _parallel_dict_from_expr(exprs, opt)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 344, in _parallel_dict_from_expr
[36m(main_task pid=405478)[0m     exprs = [ expr.expand() for expr in exprs ]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 344, in <listcomp>
[36m(main_task pid=405478)[0m     exprs = [ expr.expand() for expr in exprs ]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=405478)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3673, in expand
[36m(main_task pid=405478)[0m     expr, hit = Expr._expand_hint(expr, hint, deep=deep, **hints)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3604, in _expand_hint
[36m(main_task pid=405478)[0m     arg, arghit = Expr._expand_hint(arg, hint, **hints)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3612, in _expand_hint
[36m(main_task pid=405478)[0m     newexpr = getattr(expr, hint)(**hints)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 1104, in _eval_expand_multinomial
[36m(main_task pid=405478)[0m     return basic_from_dict(expansion_dict, *p)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 401, in expr_from_dict
[36m(main_task pid=405478)[0m     term.append(Pow(g, m))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=405478)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 207, in __new__
[36m(main_task pid=405478)[0m     obj = b._eval_power(e)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 333, in _eval_power
[36m(main_task pid=405478)[0m     return s*Pow(b, e*other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=405478)[0m     return func(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 106, in binary_op_wrapper
[36m(main_task pid=405478)[0m     return func(self, other)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 224, in __rmul__
[36m(main_task pid=405478)[0m     return Mul(other, self)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=405478)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 261, in __hash__
[36m(main_task pid=405478)[0m     h = hash((type(self).__name__,) + self._hashable_content())
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 256, in __hash__
[36m(main_task pid=405478)[0m     def __hash__(self) -> int:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=405478)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=405478)[0m TimeoutError: Operation timed out!
[36m(main_task pid=405478)[0m ERROR:2025-06-04 00:20:39,140:Error comparing (-x**3 + x**2 + 1)**1000 and (x**3 - x**2 + 1)**1000
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=405478)[0m     return self._assumptions[fact]
[36m(main_task pid=405478)[0m KeyError: 'zero'
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=405478)[0m 
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=405478)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 644, in simplify
[36m(main_task pid=405478)[0m     _e = cancel(expr)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7182, in cancel
[36m(main_task pid=405478)[0m     R, (F, G) = sring((p, q), *gens, **args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 163, in sring
[36m(main_task pid=405478)[0m     reps, opt = _parallel_dict_from_expr(exprs, opt)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 344, in _parallel_dict_from_expr
[36m(main_task pid=405478)[0m     exprs = [ expr.expand() for expr in exprs ]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 344, in <listcomp>
[36m(main_task pid=405478)[0m     exprs = [ expr.expand() for expr in exprs ]
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=405478)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3673, in expand
[36m(main_task pid=405478)[0m     expr, hit = Expr._expand_hint(expr, hint, deep=deep, **hints)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3604, in _expand_hint
[36m(main_task pid=405478)[0m     arg, arghit = Expr._expand_hint(arg, hint, **hints)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3612, in _expand_hint
[36m(main_task pid=405478)[0m     newexpr = getattr(expr, hint)(**hints)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 1104, in _eval_expand_multinomial
[36m(main_task pid=405478)[0m     return basic_from_dict(expansion_dict, *p)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 403, in expr_from_dict
[36m(main_task pid=405478)[0m     result.append(Mul(*term))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=405478)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=405478)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 511, in flatten
[36m(main_task pid=405478)[0m     if e.is_zero:
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 503, in getit
[36m(main_task pid=405478)[0m     return _ask(fact, self)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 566, in _ask
[36m(main_task pid=405478)[0m     assumptions.deduce_all_facts(((fact_i, fact_i_value),))
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/facts.py", line 625, in deduce_all_facts
[36m(main_task pid=405478)[0m     self._tell(key, value)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/facts.py", line 582, in _tell
[36m(main_task pid=405478)[0m     def _tell(self, k, v):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=405478)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=405478)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:62 - batch/bef_solve_none:24.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:27.000 - batch/solve_none:24.000 - batch/solve_none_format:0.000 - batch/solve_all:27.000 - batch/bef_solved:0.507 - batch/bef_failed:0.493 - batch/on_solved:0.507 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:37689.000 - global_seqlen/max:49606.000 - global_seqlen/minmax_diff:11917.000 - global_seqlen/balanced_min:43747.000 - global_seqlen/balanced_max:43822.000 - global_seqlen/mean:43788.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.531 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.089 - actor/pg_loss:0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.158 - mfu/actor:0.418 - actor/lr:0.000 - actor/sft_entropy_loss:0.685 - actor/sft_loss:0.874 - actor/sft_grad_norm:0.219 - mfu/sft_actor:1.281 - actor/sft_lr:0.000 - critic/score/mean:0.507 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.507 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.072 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.072 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1935.534 - response_length/max:8192.000 - response_length/min:195.000 - response_length/clip_ratio:0.124 - on_off_metrics/on_response_length_mean:1935.534 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.507 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.094 - prompt_length/max:510.000 - prompt_length/min:171.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.465 - timing_s/old_log_prob:19.962 - timing_s/adv:32.191 - timing_s/update_actor:57.636 - timing_s/sft_update_actor:20.302 - timing_s/step:302.712 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/adv:0.014
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693733, ip=30.207.97.111)[0m 
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406156)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:63 - batch/bef_solve_none:23.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:25.000 - batch/solve_none:23.000 - batch/solve_none_format:0.000 - batch/solve_all:25.000 - batch/bef_solved:0.539 - batch/bef_failed:0.461 - batch/on_solved:0.539 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:61267.000 - global_seqlen/max:224314.000 - global_seqlen/minmax_diff:163047.000 - global_seqlen/balanced_min:143389.000 - global_seqlen/balanced_max:143390.000 - global_seqlen/mean:143389.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.194 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.480 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.680 - actor/pg_loss:0.447 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.183 - mfu/actor:0.365 - actor/lr:0.000 - critic/score/mean:0.539 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.539 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.141 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.141 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1997.213 - response_length/max:8192.000 - response_length/min:138.000 - response_length/clip_ratio:0.141 - on_off_metrics/on_response_length_mean:1997.213 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.539 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.250 - prompt_length/max:500.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:211.382 - timing_s/old_log_prob:19.159 - timing_s/adv:24.296 - timing_s/update_actor:68.218 - timing_s/step:303.999 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/update_actor:0.030 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=406162)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:64 - batch/bef_solve_none:16.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:27.000 - batch/solve_none:16.000 - batch/solve_none_format:0.000 - batch/solve_all:27.000 - batch/bef_solved:0.551 - batch/bef_failed:0.449 - batch/on_solved:0.551 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:89858.000 - global_seqlen/max:222984.000 - global_seqlen/minmax_diff:133126.000 - global_seqlen/balanced_min:133132.000 - global_seqlen/balanced_max:135992.000 - global_seqlen/mean:134562.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.213 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.546 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:4.857 - actor/pg_loss:0.537 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.163 - mfu/actor:0.389 - actor/lr:0.000 - critic/score/mean:0.551 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.551 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.105 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.105 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1850.424 - response_length/max:8192.000 - response_length/min:172.000 - response_length/clip_ratio:0.117 - on_off_metrics/on_response_length_mean:1850.424 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.551 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:252.117 - prompt_length/max:682.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:190.359 - timing_s/old_log_prob:19.799 - timing_s/adv:24.336 - timing_s/update_actor:60.099 - timing_s/step:274.979 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/update_actor:0.028 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406157)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:65 - batch/bef_solve_none:26.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:26.000 - batch/solve_none:26.000 - batch/solve_none_format:0.000 - batch/solve_all:26.000 - batch/bef_solved:0.511 - batch/bef_failed:0.489 - batch/on_solved:0.511 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:87947.000 - global_seqlen/max:199670.000 - global_seqlen/minmax_diff:111723.000 - global_seqlen/balanced_min:136567.000 - global_seqlen/balanced_max:138717.000 - global_seqlen/mean:138468.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.139 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.536 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.028 - actor/pg_loss:0.398 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.170 - mfu/actor:0.403 - actor/lr:0.000 - critic/score/mean:0.511 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.511 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.110 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.110 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1917.332 - response_length/max:8192.000 - response_length/min:213.000 - response_length/clip_ratio:0.123 - on_off_metrics/on_response_length_mean:1917.332 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.511 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:246.234 - prompt_length/max:505.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.831 - timing_s/old_log_prob:16.502 - timing_s/adv:21.565 - timing_s/update_actor:59.237 - timing_s/step:279.826 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m ERROR:2025-06-04 00:40:09,212:Error comparing zoo and 1/4
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=405478)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=405478)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=405478)[0m ERROR:2025-06-04 00:40:09,216:Error comparing zoo and {5/2, 40}
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=405478)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=405478)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=405478)[0m ERROR:2025-06-04 00:40:09,220:Error comparing zoo and 3/14
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=405478)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=405478)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=405478)[0m ERROR:2025-06-04 00:40:09,222:Error comparing zoo and 9/52
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=405478)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=405478)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=405478)[0m ERROR:2025-06-04 00:40:09,225:Error comparing zoo and 2/11
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=405478)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=405478)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=405478)[0m ERROR:2025-06-04 00:40:09,229:Error comparing zoo and 2/3
[36m(main_task pid=405478)[0m Traceback (most recent call last):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=405478)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=405478)[0m     return func(*args, **kwargs)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=405478)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=405478)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=405478)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=405478)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=405478)[0m ValueError: Can't evaluate nan or zoo
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406159)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:66 - batch/bef_solve_none:23.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:27.000 - batch/solve_none:23.000 - batch/solve_none_format:0.000 - batch/solve_all:27.000 - batch/bef_solved:0.517 - batch/bef_failed:0.483 - batch/on_solved:0.517 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:81704.000 - global_seqlen/max:201428.000 - global_seqlen/minmax_diff:119724.000 - global_seqlen/balanced_min:137217.000 - global_seqlen/balanced_max:140353.000 - global_seqlen/mean:137610.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.054 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.599 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:4.069 - actor/pg_loss:0.122 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:1.400 - mfu/actor:0.411 - actor/lr:0.000 - critic/score/mean:0.517 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.517 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.106 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.106 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1898.433 - response_length/max:8192.000 - response_length/min:240.000 - response_length/clip_ratio:0.111 - on_off_metrics/on_response_length_mean:1898.433 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.517 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.734 - prompt_length/max:684.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:200.748 - timing_s/old_log_prob:17.342 - timing_s/adv:22.014 - timing_s/update_actor:57.693 - timing_s/step:280.648 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/update_actor:0.026 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP
[36m(WorkerDict pid=406156)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406155)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=406160)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:67 - batch/bef_solve_none:18.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:26.000 - batch/solve_none:18.000 - batch/solve_none_format:0.000 - batch/solve_all:26.000 - batch/bef_solved:0.543 - batch/bef_failed:0.457 - batch/on_solved:0.543 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31799.000 - global_seqlen/max:50847.000 - global_seqlen/minmax_diff:19048.000 - global_seqlen/balanced_min:43378.000 - global_seqlen/balanced_max:43450.000 - global_seqlen/mean:43419.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.131 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.528 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.060 - actor/pg_loss:0.317 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.174 - mfu/actor:0.392 - actor/lr:0.000 - actor/sft_entropy_loss:0.714 - actor/sft_loss:0.918 - actor/sft_grad_norm:0.214 - mfu/sft_actor:1.290 - actor/sft_lr:0.000 - critic/score/mean:0.543 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.543 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.107 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.107 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1787.193 - response_length/max:8192.000 - response_length/min:131.000 - response_length/clip_ratio:0.100 - on_off_metrics/on_response_length_mean:1787.193 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.543 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:254.523 - prompt_length/max:767.000 - prompt_length/min:183.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.055 - timing_s/old_log_prob:16.778 - timing_s/adv:21.578 - timing_s/update_actor:57.116 - timing_s/sft_update_actor:18.806 - timing_s/step:289.736 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=406161)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=406155)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693732, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693731, ip=30.207.97.111)[0m MICROBATCH STEP
[36m(WorkerDict pid=693736, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=693735, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693737, ip=30.207.97.111)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=693598, ip=30.207.97.111)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=405478)[0m step:68 - batch/bef_solve_none:20.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:31.000 - batch/solve_none:20.000 - batch/solve_none_format:0.000 - batch/solve_all:31.000 - batch/bef_solved:0.542 - batch/bef_failed:0.458 - batch/on_solved:0.542 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:81462.000 - global_seqlen/max:225986.000 - global_seqlen/minmax_diff:144524.000 - global_seqlen/balanced_min:142238.000 - global_seqlen/balanced_max:145182.000 - global_seqlen/mean:143462.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.053 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.507 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:5.227 - actor/pg_loss:0.126 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.207 - mfu/actor:0.398 - actor/lr:0.000 - critic/score/mean:0.542 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.542 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.123 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.123 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2000.979 - response_length/max:8192.000 - response_length/min:240.000 - response_length/clip_ratio:0.130 - on_off_metrics/on_response_length_mean:2000.979 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.542 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.625 - prompt_length/max:423.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.855 - timing_s/old_log_prob:19.176 - timing_s/adv:24.636 - timing_s/update_actor:62.164 - timing_s/step:282.745 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/update_actor:0.027 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=406161)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=406161)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
Traceback (most recent call last):
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/jizhicfs/hymiezhao/ml/reasoning/LUFFY/luffy/verl/verl/src_interleave_sft/main_mix_ppo.py", line 248, in <module>
    main()
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/jizhicfs/hymiezhao/ml/reasoning/LUFFY/luffy/verl/verl/src_interleave_sft/main_mix_ppo.py", line 143, in main
    ray.get(main_task.remote(config))
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/worker.py", line 2623, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/worker.py", line 840, in get_objects
    data_metadata_pairs = self.core_worker.get_objects(
  File "python/ray/_raylet.pyx", line 3481, in ray._raylet.CoreWorker.get_objects
  File "python/ray/_raylet.pyx", line 571, in ray._raylet.check_status
KeyboardInterrupt
Exception ignored in atexit callback: <function shutdown at 0x7f6c9c3d0d30>
Traceback (most recent call last):
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/worker.py", line 1813, in shutdown
    time.sleep(0.5)
KeyboardInterrupt: 
