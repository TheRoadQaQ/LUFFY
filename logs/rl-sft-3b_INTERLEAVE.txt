2025-05-28 09:23:40,958	INFO worker.py:1564 -- Connecting to existing Ray cluster at address: 30.207.98.85:6379...
2025-05-28 09:23:40,966	INFO worker.py:1740 -- Connected to Ray cluster. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(main_task pid=254128)[0m {'actor_rollout_ref': {'actor': {'adaptive_temperature_clip': -1,
[36m(main_task pid=254128)[0m                                  'adaptive_temperature_target_entropy': 1.0,
[36m(main_task pid=254128)[0m                                  'all_max_clip': -1,
[36m(main_task pid=254128)[0m                                  'alpha_lr': 0.01,
[36m(main_task pid=254128)[0m                                  'clip_ratio': 0.2,
[36m(main_task pid=254128)[0m                                  'clip_upper_bound': 1.0,
[36m(main_task pid=254128)[0m                                  'debug': False,
[36m(main_task pid=254128)[0m                                  'entropy_coeff': 0.001,
[36m(main_task pid=254128)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=254128)[0m                                                  'grad_offload': False,
[36m(main_task pid=254128)[0m                                                  'optimizer_offload': True,
[36m(main_task pid=254128)[0m                                                  'param_offload': False,
[36m(main_task pid=254128)[0m                                                  'sft_optimizer_offload': True,
[36m(main_task pid=254128)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=254128)[0m                                  'grad_clip': 0.7,
[36m(main_task pid=254128)[0m                                  'kl_loss_coef': 0.0,
[36m(main_task pid=254128)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(main_task pid=254128)[0m                                  'loss_remove_clip': True,
[36m(main_task pid=254128)[0m                                  'loss_remove_token_mean': True,
[36m(main_task pid=254128)[0m                                  'off_policy_cliprange': 0.2,
[36m(main_task pid=254128)[0m                                  'off_policy_loss_impl': 'token',
[36m(main_task pid=254128)[0m                                  'off_policy_max_clip': -1,
[36m(main_task pid=254128)[0m                                  'off_policy_min_clip': -1,
[36m(main_task pid=254128)[0m                                  'off_policy_normalize': False,
[36m(main_task pid=254128)[0m                                  'off_policy_reshape': 'p_div_p_0.1',
[36m(main_task pid=254128)[0m                                  'off_policy_reshape_pow_exp': 0.5,
[36m(main_task pid=254128)[0m                                  'off_policy_reshape_weight': 0.1,
[36m(main_task pid=254128)[0m                                  'on_policy_reshape': 'no_reshape',
[36m(main_task pid=254128)[0m                                  'on_policy_reshape_pow_exp': 0.5,
[36m(main_task pid=254128)[0m                                  'on_policy_reshape_weight': 0.1,
[36m(main_task pid=254128)[0m                                  'optim': {'lr': 1e-06,
[36m(main_task pid=254128)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(main_task pid=254128)[0m                                            'min_lr_ratio': None,
[36m(main_task pid=254128)[0m                                            'sft': {'lr': 1e-06,
[36m(main_task pid=254128)[0m                                                    'same_or_not': False},
[36m(main_task pid=254128)[0m                                            'total_training_steps': -1,
[36m(main_task pid=254128)[0m                                            'warmup_style': 'constant'},
[36m(main_task pid=254128)[0m                                  'ppo_epochs': 1,
[36m(main_task pid=254128)[0m                                  'ppo_kl_loss_coef': 0.01,
[36m(main_task pid=254128)[0m                                  'ppo_max_token_len_per_gpu': 32768,
[36m(main_task pid=254128)[0m                                  'ppo_micro_batch_size': 64,
[36m(main_task pid=254128)[0m                                  'ppo_mini_batch_size': 64,
[36m(main_task pid=254128)[0m                                  'sft': {'entropy_coeff': 0.001,
[36m(main_task pid=254128)[0m                                          'sft_data_size': 128,
[36m(main_task pid=254128)[0m                                          'sft_epochs': 1,
[36m(main_task pid=254128)[0m                                          'sft_micro_batch_size': 16,
[36m(main_task pid=254128)[0m                                          'sft_mini_batch_size': 128},
[36m(main_task pid=254128)[0m                                  'sft_prefix_reward_weight': 1.0,
[36m(main_task pid=254128)[0m                                  'shuffle': False,
[36m(main_task pid=254128)[0m                                  'strategy': 'fsdp',
[36m(main_task pid=254128)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=254128)[0m                                  'use_adaptive_temperature': False,
[36m(main_task pid=254128)[0m                                  'use_adaptive_temperature_fixed': False,
[36m(main_task pid=254128)[0m                                  'use_dynamic_bsz': True,
[36m(main_task pid=254128)[0m                                  'use_kl_loss': False,
[36m(main_task pid=254128)[0m                                  'use_off_policy_clip': False,
[36m(main_task pid=254128)[0m                                  'use_off_policy_loss': True,
[36m(main_task pid=254128)[0m                                  'use_off_policy_probs': False,
[36m(main_task pid=254128)[0m                                  'use_ppo_kl_loss': False,
[36m(main_task pid=254128)[0m                                  'use_sft_prefix_reward': False,
[36m(main_task pid=254128)[0m                                  'use_sft_reward': False,
[36m(main_task pid=254128)[0m                                  'use_target_lst': False},
[36m(main_task pid=254128)[0m                        'hybrid_engine': True,
[36m(main_task pid=254128)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(main_task pid=254128)[0m                                  'external_lib': None,
[36m(main_task pid=254128)[0m                                  'override_config': {},
[36m(main_task pid=254128)[0m                                  'path': '/jizhicfs/hymiezhao/models/Qwen2.5-3B-think',
[36m(main_task pid=254128)[0m                                  'use_remove_padding': True},
[36m(main_task pid=254128)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(main_task pid=254128)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=254128)[0m                                'log_prob_max_token_len_per_gpu': 32768,
[36m(main_task pid=254128)[0m                                'log_prob_micro_batch_size': 128,
[36m(main_task pid=254128)[0m                                'log_prob_use_dynamic_bsz': True,
[36m(main_task pid=254128)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=254128)[0m                                'use_ref': False},
[36m(main_task pid=254128)[0m                        'rollout': {'do_sample': True,
[36m(main_task pid=254128)[0m                                    'dtype': 'bfloat16',
[36m(main_task pid=254128)[0m                                    'enable_chunked_prefill': True,
[36m(main_task pid=254128)[0m                                    'enforce_eager': True,
[36m(main_task pid=254128)[0m                                    'free_cache_engine': True,
[36m(main_task pid=254128)[0m                                    'gpu_memory_utilization': 0.8,
[36m(main_task pid=254128)[0m                                    'ignore_eos': False,
[36m(main_task pid=254128)[0m                                    'load_format': 'dummy_dtensor',
[36m(main_task pid=254128)[0m                                    'log_prob_max_token_len_per_gpu': 32768,
[36m(main_task pid=254128)[0m                                    'log_prob_micro_batch_size': 128,
[36m(main_task pid=254128)[0m                                    'log_prob_use_dynamic_bsz': True,
[36m(main_task pid=254128)[0m                                    'max_num_batched_tokens': 8192,
[36m(main_task pid=254128)[0m                                    'max_num_seqs': 1024,
[36m(main_task pid=254128)[0m                                    'max_prefix_len': 8192,
[36m(main_task pid=254128)[0m                                    'max_prefix_ratio': 1.0,
[36m(main_task pid=254128)[0m                                    'min_prefix_ratio': 0.0,
[36m(main_task pid=254128)[0m                                    'n': 8,
[36m(main_task pid=254128)[0m                                    'n_prefix': 1,
[36m(main_task pid=254128)[0m                                    'n_val': 1,
[36m(main_task pid=254128)[0m                                    'name': 'vllm',
[36m(main_task pid=254128)[0m                                    'prefix_linear_max_ratio': 0.8,
[36m(main_task pid=254128)[0m                                    'prefix_linear_max_var': 0.1,
[36m(main_task pid=254128)[0m                                    'prefix_reward_strategy': 'all',
[36m(main_task pid=254128)[0m                                    'prefix_reward_weight_alpha': 1.0,
[36m(main_task pid=254128)[0m                                    'prefix_reward_weight_beta': 1.0,
[36m(main_task pid=254128)[0m                                    'prefix_share_across_samples': False,
[36m(main_task pid=254128)[0m                                    'prefix_steps': 1000,
[36m(main_task pid=254128)[0m                                    'prefix_strategy': 'random',
[36m(main_task pid=254128)[0m                                    'prompt_length': 1024,
[36m(main_task pid=254128)[0m                                    'response_length': 8192,
[36m(main_task pid=254128)[0m                                    'temperature': 1.0,
[36m(main_task pid=254128)[0m                                    'tensor_model_parallel_size': 2,
[36m(main_task pid=254128)[0m                                    'top_k': -1,
[36m(main_task pid=254128)[0m                                    'top_p': 1,
[36m(main_task pid=254128)[0m                                    'val_temperature': 0.6}},
[36m(main_task pid=254128)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(main_task pid=254128)[0m                'gamma': 1.0,
[36m(main_task pid=254128)[0m                'grpo_use_std': False,
[36m(main_task pid=254128)[0m                'kl_ctrl': {'kl_coef': 0.0, 'type': 'fixed'},
[36m(main_task pid=254128)[0m                'kl_penalty': 'kl',
[36m(main_task pid=254128)[0m                'lam': 1.0,
[36m(main_task pid=254128)[0m                'surprisal_base': 0.0},
[36m(main_task pid=254128)[0m  'critic': {'cliprange_value': 0.5,
[36m(main_task pid=254128)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(main_task pid=254128)[0m             'forward_micro_batch_size': 64,
[36m(main_task pid=254128)[0m             'grad_clip': 1.0,
[36m(main_task pid=254128)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(main_task pid=254128)[0m                       'external_lib': None,
[36m(main_task pid=254128)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=254128)[0m                                       'grad_offload': False,
[36m(main_task pid=254128)[0m                                       'optimizer_offload': False,
[36m(main_task pid=254128)[0m                                       'param_offload': False,
[36m(main_task pid=254128)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(main_task pid=254128)[0m                       'override_config': {},
[36m(main_task pid=254128)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(main_task pid=254128)[0m                       'tokenizer_path': '/jizhicfs/hymiezhao/models/Qwen2.5-3B-think',
[36m(main_task pid=254128)[0m                       'use_remove_padding': False},
[36m(main_task pid=254128)[0m             'optim': {'lr': 1e-05,
[36m(main_task pid=254128)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(main_task pid=254128)[0m                       'min_lr_ratio': None,
[36m(main_task pid=254128)[0m                       'total_training_steps': -1,
[36m(main_task pid=254128)[0m                       'warmup_style': 'constant'},
[36m(main_task pid=254128)[0m             'ppo_epochs': 1,
[36m(main_task pid=254128)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(main_task pid=254128)[0m             'ppo_micro_batch_size': 64,
[36m(main_task pid=254128)[0m             'ppo_mini_batch_size': 64,
[36m(main_task pid=254128)[0m             'shuffle': False,
[36m(main_task pid=254128)[0m             'strategy': 'fsdp',
[36m(main_task pid=254128)[0m             'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=254128)[0m             'use_dynamic_bsz': True},
[36m(main_task pid=254128)[0m  'data': {'accuracy_lower_bound': 0.0,
[36m(main_task pid=254128)[0m           'accuracy_upper_bound': 1.0,
[36m(main_task pid=254128)[0m           'add_tgt_acc_upper_bound': 0.5,
[36m(main_task pid=254128)[0m           'add_tgt_with_acc': False,
[36m(main_task pid=254128)[0m           'disable_truncation_advantage': False,
[36m(main_task pid=254128)[0m           'filter_accuracy': False,
[36m(main_task pid=254128)[0m           'filter_targets': False,
[36m(main_task pid=254128)[0m           'max_prompt_length': 1024,
[36m(main_task pid=254128)[0m           'max_response_length': 8192,
[36m(main_task pid=254128)[0m           'prompt_key': 'prompt',
[36m(main_task pid=254128)[0m           'return_raw_chat': False,
[36m(main_task pid=254128)[0m           'return_raw_input_ids': False,
[36m(main_task pid=254128)[0m           'reward_impl_version': 3,
[36m(main_task pid=254128)[0m           'sample_target_ratio': 1.0,
[36m(main_task pid=254128)[0m           'shuffle': True,
[36m(main_task pid=254128)[0m           'tokenizer': None,
[36m(main_task pid=254128)[0m           'train_batch_size': 128,
[36m(main_task pid=254128)[0m           'train_files': './dataset//openr1.parquet',
[36m(main_task pid=254128)[0m           'val_batch_size': 512,
[36m(main_task pid=254128)[0m           'val_files': './dataset//valid.parquet'},
[36m(main_task pid=254128)[0m  'reward_model': {'enable': False,
[36m(main_task pid=254128)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(main_task pid=254128)[0m                   'max_length': None,
[36m(main_task pid=254128)[0m                   'micro_batch_size': 64,
[36m(main_task pid=254128)[0m                   'model': {'external_lib': None,
[36m(main_task pid=254128)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(main_task pid=254128)[0m                                             'min_num_params': 0,
[36m(main_task pid=254128)[0m                                             'param_offload': False},
[36m(main_task pid=254128)[0m                             'input_tokenizer': '/jizhicfs/hymiezhao/models/Qwen2.5-3B-think',
[36m(main_task pid=254128)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(main_task pid=254128)[0m                             'use_remove_padding': False},
[36m(main_task pid=254128)[0m                   'strategy': 'fsdp',
[36m(main_task pid=254128)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(main_task pid=254128)[0m                   'use_dynamic_bsz': True},
[36m(main_task pid=254128)[0m  'sft': {'buffer_type': 'solve_none'},
[36m(main_task pid=254128)[0m  'trainer': {'acc_rebatch': False,
[36m(main_task pid=254128)[0m              'add_full_target_when_none': False,
[36m(main_task pid=254128)[0m              'critic_warmup': 0,
[36m(main_task pid=254128)[0m              'debug': False,
[36m(main_task pid=254128)[0m              'default_hdfs_dir': None,
[36m(main_task pid=254128)[0m              'default_local_dir': './train_results/rl-sft/3b_INTERLEAVE',
[36m(main_task pid=254128)[0m              'experiment_name': '3b_INTERLEAVE',
[36m(main_task pid=254128)[0m              'logger': ['console', 'wandb'],
[36m(main_task pid=254128)[0m              'max_optim_to_keep': 2,
[36m(main_task pid=254128)[0m              'n_gpus_per_node': 8,
[36m(main_task pid=254128)[0m              'nnodes': 2,
[36m(main_task pid=254128)[0m              'project_name': 'rl-sft',
[36m(main_task pid=254128)[0m              'rejection_sample': False,
[36m(main_task pid=254128)[0m              'rejection_sample_multiplier': 2,
[36m(main_task pid=254128)[0m              'resume_from_path': False,
[36m(main_task pid=254128)[0m              'resume_mode': 'auto',
[36m(main_task pid=254128)[0m              'save_freq': -1,
[36m(main_task pid=254128)[0m              'skip_by_step': False,
[36m(main_task pid=254128)[0m              'skip_valid_mask': False,
[36m(main_task pid=254128)[0m              'test_freq': 10,
[36m(main_task pid=254128)[0m              'total_epochs': 5,
[36m(main_task pid=254128)[0m              'total_training_steps': None,
[36m(main_task pid=254128)[0m              'val_before_train': False}}
[36m(main_task pid=254128)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(main_task pid=254128)[0m No module named 'vllm._version'
[36m(main_task pid=254128)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(main_task pid=254128)[0m original dataset len: 45792
[36m(main_task pid=254128)[0m filter dataset len: 45764
[36m(main_task pid=254128)[0m original dataset len: 2019
[36m(main_task pid=254128)[0m filter dataset len: 2017
[36m(main_task pid=254128)[0m Size of train dataloader: 357
[36m(main_task pid=254128)[0m Size of val dataloader: 1
[36m(main_task pid=254128)[0m Total training steps: 1785
[36m(pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=234876, ip=30.207.98.114)[0m No module named 'vllm._version'
[36m(pid=234876, ip=30.207.98.114)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(pid=235070, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=235070, ip=30.207.98.114)[0m No module named 'vllm._version'
[36m(pid=235070, ip=30.207.98.114)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(pid=254530)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:[32m [repeated 10x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(pid=254530)[0m No module named 'vllm._version'[32m [repeated 10x across cluster][0m
[36m(pid=254530)[0m   from vllm.version import __version__ as VLLM_VERSION[32m [repeated 10x across cluster][0m
[36m(WorkerDict pid=254526)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=254526)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "_name_or_path": "/jizhicfs/hymiezhao/models/Qwen2.5-3B-think",
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "architectures": [
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   ],
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "eos_token_id": 151643,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "intermediate_size": 11008,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "max_window_layers": 36,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "num_hidden_layers": 36,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "rope_scaling": null,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "sliding_window": null,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "transformers_version": "4.46.3",
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "use_cache": true,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "use_mrope": false,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   "vocab_size": 151936
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m }
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m 
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:12<00:12, 12.39s/it]
[36m(pid=254533)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:[32m [repeated 4x across cluster][0m
[36m(pid=254533)[0m No module named 'vllm._version'[32m [repeated 4x across cluster][0m
[36m(pid=254533)[0m   from vllm.version import __version__ as VLLM_VERSION[32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=254533)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=254533)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=254533)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 9x across cluster][0m
[36m(WorkerDict pid=254528)[0m Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:13<00:00,  6.40s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:13<00:00,  6.78s/it]
[36m(WorkerDict pid=254533)[0m Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:08<00:08,  8.39s/it][32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=254526)[0m wrap_policy: functools.partial(<function transformer_auto_wrap_policy at 0x7f7df702ed40>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Qwen2ForCausalLM contains 3.09B parameters
[36m(WorkerDict pid=254531)[0m Total steps: 1785, num_warmup_steps: 0
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Before building vllm rollout, memory allocated (GB): 0.7185320854187012, memory reserved (GB): 0.7890625
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m wrap_policy: functools.partial(<function transformer_auto_wrap_policy at 0x7f3b34d66d40>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m INFO 05-28 09:27:05 config.py:887] Defaulting to use ray for distributed inference
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m INFO 05-28 09:27:05 config.py:1005] Chunked prefill is enabled with max_num_batched_tokens=8192.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m WARNING 05-28 09:27:05 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=254533)[0m Total steps: 1785, num_warmup_steps: 0[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m Actor use_remove_padding=True[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m local rank 0
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m INFO 05-28 09:27:06 selector.py:115] Using XFormers backend.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:211: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   @torch.library.impl_abstract("xformers_flash::flash_fwd")
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:18<00:00,  8.72s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:18<00:00,  9.31s/it][32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m   @torch.library.impl_abstract("xformers_flash::flash_bwd")
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:344: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m   @torch.library.impl_abstract("xformers_flash::flash_fwd")[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m INFO 05-28 09:27:15 utils.py:1008] Found nccl from library libnccl.so.2
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m INFO 05-28 09:27:15 pynccl.py:63] vLLM is using nccl==2.20.5
[36m(WorkerDict pid=254529)[0m INFO 05-28 09:27:07 config.py:887] Defaulting to use ray for distributed inference[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254529)[0m INFO 05-28 09:27:07 config.py:1005] Chunked prefill is enabled with max_num_batched_tokens=8192.[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254529)[0m WARNING 05-28 09:27:07 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m local rank 0[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254529)[0m INFO 05-28 09:27:08 selector.py:115] Using XFormers backend.[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m INFO 05-28 09:27:16 shm_broadcast.py:241] vLLM message queue communication handle: Handle(connect_ip='127.0.0.1', local_reader_ranks=[1], buffer=<vllm.distributed.device_communicators.shm_broadcast.ShmRingBuffer object at 0x7f45e17c3490>, local_subscribe_port=39247, remote_subscribe_port=None)
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m before init cache memory allocated: 3.93114112GB, reserved: 4.045406208GB
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m after init cache memory allocated: 65.39375104GB, reserved: 65.575845888GB
[36m(WorkerDict pid=254533)[0m INFO 05-28 09:27:15 utils.py:1008] Found nccl from library libnccl.so.2[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m INFO 05-28 09:27:15 pynccl.py:63] vLLM is using nccl==2.20.5[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m INFO 05-28 09:27:17 selector.py:115] Using XFormers backend.[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254532)[0m NCCL version 2.20.5+cuda12.4[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m INFO 05-28 09:27:17 shm_broadcast.py:241] vLLM message queue communication handle: Handle(connect_ip='127.0.0.1', local_reader_ranks=[1], buffer=<vllm.distributed.device_communicators.shm_broadcast.ShmRingBuffer object at 0x7f025037b6d0>, local_subscribe_port=48825, remote_subscribe_port=None)[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m kwargs: {'n': 8, 'logprobs': 1, 'max_tokens': 8192, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m After building vllm rollout, memory allocated (GB): 57.97579860687256, memory reserved (GB): 61.072265625
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(WorkerDict pid=254529)[0m   @torch.library.impl_abstract("xformers_flash::flash_bwd")[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254529)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/xformers/ops/fmha/flash.py:344: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m After building sharding manager, memory allocated (GB): 57.97579860687256, memory reserved (GB): 61.072265625
[36m(main_task pid=254128)[0m wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
[36m(main_task pid=254128)[0m wandb: Currently logged in as: maluqaq (theroadqaq). Use `wandb login --relogin` to force relogin
[36m(main_task pid=254128)[0m wandb: Tracking run with wandb version 0.19.1
[36m(main_task pid=254128)[0m wandb: Run data is saved locally in /jizhicfs/hymiezhao/ml/reasoning/LUFFY/wandb/run-20250528_092731-lx9tn6pw
[36m(main_task pid=254128)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(main_task pid=254128)[0m wandb: Syncing run 3b_INTERLEAVE
[36m(main_task pid=254128)[0m wandb: ‚≠êÔ∏è View project at https://wandb.ai/theroadqaq/rl-sft
[36m(main_task pid=254128)[0m wandb: üöÄ View run at https://wandb.ai/theroadqaq/rl-sft/runs/lx9tn6pw
[36m(WorkerDict pid=254533)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m   warnings.warn([32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(main_task pid=254128)[0m Checkpoint tracker file does not exist: %s /jizhicfs/hymiezhao/ml/reasoning/LUFFY/./train_results/rl-sft/3b_INTERLEAVE/latest_checkpointed_iteration.txt
[36m(main_task pid=254128)[0m Training from scratch
[36m(WorkerDict pid=254533)[0m kwargs: {'n': 8, 'logprobs': 1, 'max_tokens': 8192, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:30:45,500:Error comparing zoo and 4
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:30:45,504:Error comparing zoo and 0
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:30:45,506:Error comparing zoo and 17
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:30:45,508:Error comparing zoo and 6
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:30:45,521:Error comparing zoo and Eq(t, zoo)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:30:45,523:Error comparing zoo and 10
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:30:45,527:Error comparing zoo and V
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:30:46,793:Error comparing (pi/3 < x) & (x < (4*pi)/3) and x > (2*pi*k)/3 + pi/6
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictGreaterThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:30:47,085:Error comparing (pi/3 < x) & (x < (4*pi)/3) and Union(Interval.open(pi/6, (2*pi)/3), Interval.open((5*pi)/6, (4*pi)/3))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=254128)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=254128)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=254128)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=254128)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=254128)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in _complement
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 806, in __sub__
[36m(main_task pid=254128)[0m     return Complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1731, in reduce
[36m(main_task pid=254128)[0m     if B == S.UniversalSet or A.is_subset(B):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 430, in is_subset
[36m(main_task pid=254128)[0m     if self.intersect(other) == self:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 150, in intersect
[36m(main_task pid=254128)[0m     return Intersection(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=254128)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 455, in _
[36m(main_task pid=254128)[0m     if a.end < b.end:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=254128)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=254128)[0m TypeError: cannot determine truth value of Relational
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:1 - batch/bef_solve_none:90.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:90.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.050 - batch/bef_failed:0.950 - batch/on_solved:0.050 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:51823.000 - global_seqlen/max:79917.000 - global_seqlen/minmax_diff:28094.000 - global_seqlen/balanced_min:62612.000 - global_seqlen/balanced_max:65365.000 - global_seqlen/mean:62919.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.012 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.717 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.852 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.115 - mfu/actor:0.249 - actor/lr:0.000 - critic/score/mean:0.050 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.050 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:0.875 - critic/advantages/min:-0.375 - critic/returns/mean:-0.008 - critic/returns/max:0.875 - critic/returns/min:-0.375 - response_length/mean:744.401 - response_length/max:8192.000 - response_length/min:11.000 - response_length/clip_ratio:0.001 - on_off_metrics/on_response_length_mean:744.401 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.050 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:238.711 - prompt_length/max:546.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:186.914 - timing_s/old_log_prob:6.180 - timing_s/adv:18.118 - timing_s/update_actor:19.701 - timing_s/step:225.038 - timing_per_token_ms/update_actor:0.020 - timing_per_token_ms/gen:0.245 - timing_per_token_ms/adv:0.018
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:34:32,226:Error comparing 24907178886548373204679387995927363540336099118607787105008752944526576374799419743296378149580471615619281572322899496245840996138648114189833229118817296398424934466245900402450739830206442930284612004471015406509565972277438866035837590008515552989726240319799227640190240743273738649731406774634904247772408045075286163639723063931762746013460618326071538674381745710499812415136857418197007680479404327190773087615369169092007548660563554197068210454113520538303440360115622995551518718065306778860014123156351267833122368180892152310323223017329455925/2**1346 and 2**(2019 - k)*x**((5*k - 2017)/8)*binomial(2019, k)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'zero'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 707, in simplify
[36m(main_task pid=254128)[0m     expr = combsimp(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/combsimp.py", line 53, in combsimp
[36m(main_task pid=254128)[0m     return gammasimp(expr);
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 81, in gammasimp
[36m(main_task pid=254128)[0m     return _gammasimp(expr, as_comb=False)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 455, in _gammasimp
[36m(main_task pid=254128)[0m     was = factor(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6577, in factor
[36m(main_task pid=254128)[0m     return _generic_factor(f, gens, args, method='factor')
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6258, in _generic_factor
[36m(main_task pid=254128)[0m     return _symbolic_factor(sympify(expr), opt, method)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6198, in _symbolic_factor
[36m(main_task pid=254128)[0m     coeff, factors = _symbolic_factor_list(together(expr, fraction=opt['fraction']), opt, method)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6157, in _symbolic_factor_list
[36m(main_task pid=254128)[0m     poly, _ = _poly_from_expr(base, opt)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 4511, in _poly_from_expr
[36m(main_task pid=254128)[0m     expr = expr.expand()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3673, in expand
[36m(main_task pid=254128)[0m     expr, hit = Expr._expand_hint(expr, hint, deep=deep, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3604, in _expand_hint
[36m(main_task pid=254128)[0m     arg, arghit = Expr._expand_hint(arg, hint, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3612, in _expand_hint
[36m(main_task pid=254128)[0m     newexpr = getattr(expr, hint)(**hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 948, in _eval_expand_mul
[36m(main_task pid=254128)[0m     terms = self.func._expandsums(sums)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 909, in _expandsums
[36m(main_task pid=254128)[0m     left = Mul._expandsums(sums[:L//2])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 909, in _expandsums
[36m(main_task pid=254128)[0m     left = Mul._expandsums(sums[:L//2])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 909, in _expandsums
[36m(main_task pid=254128)[0m     left = Mul._expandsums(sums[:L//2])
[36m(main_task pid=254128)[0m   [Previous line repeated 1 more time]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 910, in _expandsums
[36m(main_task pid=254128)[0m     right = Mul._expandsums(sums[L//2:])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 913, in _expandsums
[36m(main_task pid=254128)[0m     added = Add(*terms)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 335, in flatten
[36m(main_task pid=254128)[0m     newseq.append(Mul(c, s))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 511, in flatten
[36m(main_task pid=254128)[0m     if e.is_zero:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 502, in getit
[36m(main_task pid=254128)[0m     self._assumptions = self.default_assumptions.copy()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 482, in copy
[36m(main_task pid=254128)[0m     return self.__class__(self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 479, in __init__
[36m(main_task pid=254128)[0m     self.deduce_all_facts(facts)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/facts.py", line 625, in deduce_all_facts
[36m(main_task pid=254128)[0m     self._tell(key, value)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.[32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined][32m [repeated 3x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:34:38,465:Error comparing (2 + 4**2013)/3 and -1 + 2**(2**2013)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 642, in simplify
[36m(main_task pid=254128)[0m     expr = _bottom_up(expr, lambda w: getattr(w, 'normal', lambda: w)())
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 232, in bottom_up
[36m(main_task pid=254128)[0m     rv = rv.func(*args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 207, in __new__
[36m(main_task pid=254128)[0m     obj = b._eval_power(e)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 2045, in _eval_power
[36m(main_task pid=254128)[0m     result = Integer(x**abs(expt.p))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 30x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:2 - batch/bef_solve_none:105.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:105.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.044 - batch/bef_failed:0.956 - batch/on_solved:0.044 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:29936.000 - global_seqlen/max:42220.000 - global_seqlen/minmax_diff:12284.000 - global_seqlen/balanced_min:34638.000 - global_seqlen/balanced_max:34696.000 - global_seqlen/mean:34672.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.001 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.706 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.925 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.101 - mfu/actor:0.286 - actor/lr:0.000 - actor/sft_entropy_loss:0.666 - actor/sft_loss:0.723 - actor/sft_grad_norm:0.230 - mfu/sft_actor:0.505 - actor/sft_lr:0.000 - critic/score/mean:0.044 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.044 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.875 - critic/advantages/min:-0.750 - critic/returns/mean:-0.000 - critic/returns/max:0.875 - critic/returns/min:-0.750 - response_length/mean:712.067 - response_length/max:8192.000 - response_length/min:2.000 - response_length/clip_ratio:0.002 - on_off_metrics/on_response_length_mean:712.067 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.044 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:247.023 - prompt_length/max:448.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:188.191 - timing_s/old_log_prob:4.979 - timing_s/adv:17.850 - timing_s/update_actor:16.311 - timing_s/sft_update_actor:11.727 - timing_s/step:234.380 - timing_per_token_ms/update_actor:0.017 - timing_per_token_ms/gen:0.258 - timing_per_token_ms/adv:0.018
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254530)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:3 - batch/bef_solve_none:91.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:91.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.062 - batch/bef_failed:0.938 - batch/on_solved:0.062 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25948.000 - global_seqlen/max:46405.000 - global_seqlen/minmax_diff:20457.000 - global_seqlen/balanced_min:37315.000 - global_seqlen/balanced_max:37372.000 - global_seqlen/mean:37335.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.017 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.656 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.160 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.117 - mfu/actor:0.303 - actor/lr:0.000 - actor/sft_entropy_loss:0.747 - actor/sft_loss:0.784 - actor/sft_grad_norm:0.227 - mfu/sft_actor:0.573 - actor/sft_lr:0.000 - critic/score/mean:0.062 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.062 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:0.875 - critic/advantages/min:-0.625 - critic/returns/mean:-0.007 - critic/returns/max:0.875 - critic/returns/min:-0.625 - response_length/mean:720.154 - response_length/max:8192.000 - response_length/min:4.000 - response_length/clip_ratio:0.002 - on_off_metrics/on_response_length_mean:720.154 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.062 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.625 - prompt_length/max:369.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:190.465 - timing_s/old_log_prob:4.781 - timing_s/adv:12.701 - timing_s/update_actor:15.260 - timing_s/sft_update_actor:9.184 - timing_s/step:227.905 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.258 - timing_per_token_ms/adv:0.013
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:42:18,275:Error comparing (x <= 16) & (1/sqrt(2) <= x) and log(x, 1/2) - 1*1/2*log(log(x*(-1 + log(2, 2)), 2), 2) + 1 <= 0
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'LessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:42:26,405:Error comparing -2**n + 2*3**n and binomial(m - 1, x + 1)*binomial(m - 1, z + 1)*binomial(n - 1, w + 1)*binomial(n - 1, y + 1)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 707, in simplify
[36m(main_task pid=254128)[0m     expr = combsimp(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/combsimp.py", line 53, in combsimp
[36m(main_task pid=254128)[0m     return gammasimp(expr);
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 81, in gammasimp
[36m(main_task pid=254128)[0m     return _gammasimp(expr, as_comb=False)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 455, in _gammasimp
[36m(main_task pid=254128)[0m     was = factor(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6577, in factor
[36m(main_task pid=254128)[0m     return _generic_factor(f, gens, args, method='factor')
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6258, in _generic_factor
[36m(main_task pid=254128)[0m     return _symbolic_factor(sympify(expr), opt, method)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6198, in _symbolic_factor
[36m(main_task pid=254128)[0m     coeff, factors = _symbolic_factor_list(together(expr, fraction=opt['fraction']), opt, method)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6163, in _symbolic_factor_list
[36m(main_task pid=254128)[0m     _coeff, _factors = func()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 3378, in factor_list
[36m(main_task pid=254128)[0m     coeff, factors = f.rep.factor_list()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyclasses.py", line 1637, in factor_list
[36m(main_task pid=254128)[0m     coeff, factors = dmp_factor_list(f._rep, f.lev, f.dom)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1569, in dmp_factor_list
[36m(main_task pid=254128)[0m     coeff, factors = dmp_zz_factor(f, v, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1188, in dmp_zz_factor
[36m(main_task pid=254128)[0m     g = dmp_sqf_part(g, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/sqfreetools.py", line 470, in dmp_sqf_part
[36m(main_task pid=254128)[0m     gcd = dmp_gcd(gcd, dmp_diff_in(f, 1, i, u, K), u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/euclidtools.py", line 1639, in dmp_gcd
[36m(main_task pid=254128)[0m     return dmp_inner_gcd(f, g, u, K)[0]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/euclidtools.py", line 1601, in dmp_inner_gcd
[36m(main_task pid=254128)[0m     dmp_inflate(cff, J, u, K),
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1476, in dmp_inflate
[36m(main_task pid=254128)[0m     return _rec_inflate(f, M, u, 0, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in _rec_inflate
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densebasic.py", line 1441, in <listcomp>
[36m(main_task pid=254128)[0m     g = [ _rec_inflate(c, M, w, j, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:4 - batch/bef_solve_none:101.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:101.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.042 - batch/bef_failed:0.958 - batch/on_solved:0.042 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:27074.000 - global_seqlen/max:51042.000 - global_seqlen/minmax_diff:23968.000 - global_seqlen/balanced_min:35799.000 - global_seqlen/balanced_max:35864.000 - global_seqlen/mean:35827.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.036 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.608 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.576 - actor/pg_loss:0.052 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.122 - mfu/actor:0.276 - actor/lr:0.000 - actor/sft_entropy_loss:0.633 - actor/sft_loss:0.663 - actor/sft_grad_norm:0.221 - mfu/sft_actor:0.695 - actor/sft_lr:0.000 - critic/score/mean:0.042 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.042 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.875 - critic/advantages/min:-0.500 - critic/returns/mean:-0.005 - critic/returns/max:0.875 - critic/returns/min:-0.500 - response_length/mean:800.414 - response_length/max:8192.000 - response_length/min:5.000 - response_length/clip_ratio:0.002 - on_off_metrics/on_response_length_mean:800.414 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.042 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.227 - prompt_length/max:488.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:191.397 - timing_s/old_log_prob:5.274 - timing_s/adv:18.160 - timing_s/update_actor:18.482 - timing_s/sft_update_actor:8.497 - timing_s/step:236.838 - timing_per_token_ms/update_actor:0.017 - timing_per_token_ms/gen:0.234 - timing_per_token_ms/adv:0.017
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:46:16,671:Error comparing 1992 and Sum(2**n*Sum(1992**k/factorial(k), (k, 0, n - 1))/factorial(n), (n, 0, 1992))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/solvers/solvers.py", line 2853, in _tsolve
[36m(main_task pid=254128)[0m     sols = _solve_lambert(_eq, sym, g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/solvers/bivariate.py", line 411, in _solve_lambert
[36m(main_task pid=254128)[0m     raise NotImplementedError('%s does not appear to have a solution in '
[36m(main_task pid=254128)[0m NotImplementedError: 2**_d*2**_m*exp(1992)*factorial(_d)**2 - 2**_d*_d*exp(1992)*factorial(_d + _m)*lowergamma(_d, 1992) does not appear to have a solution in terms of LambertW
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 139, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return safe_sympy_doit(a) == safe_sympy_doit(b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 80, in safe_sympy_doit
[36m(main_task pid=254128)[0m     return a.doit()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 226, in doit
[36m(main_task pid=254128)[0m     did = self.xreplace(reps).doit(**hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 252, in doit
[36m(main_task pid=254128)[0m     newf = eval_sum(f, (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1048, in eval_sum
[36m(main_task pid=254128)[0m     value = eval_sum_symbolic(f.expand(), (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1161, in eval_sum_symbolic
[36m(main_task pid=254128)[0m     lrsum = telescopic(L, R, (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 994, in telescopic
[36m(main_task pid=254128)[0m     sol = solve(L.subs(i, i + m) + R, m) or []
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/solvers/solvers.py", line 1170, in solve
[36m(main_task pid=254128)[0m     solution = _solve(f[0], *symbols, **flags)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/solvers/solvers.py", line 1721, in _solve
[36m(main_task pid=254128)[0m     soln = _tsolve(f_num, symbol, **flags)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/solvers/solvers.py", line 2874, in _tsolve
[36m(main_task pid=254128)[0m     inversion = _tsolve(g - u, sym, **flags)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/solvers/solvers.py", line 2688, in _tsolve
[36m(main_task pid=254128)[0m     f = factor(powdenest(lhs - rhs))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6577, in factor
[36m(main_task pid=254128)[0m     return _generic_factor(f, gens, args, method='factor')
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6258, in _generic_factor
[36m(main_task pid=254128)[0m     return _symbolic_factor(sympify(expr), opt, method)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6198, in _symbolic_factor
[36m(main_task pid=254128)[0m     coeff, factors = _symbolic_factor_list(together(expr, fraction=opt['fraction']), opt, method)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6163, in _symbolic_factor_list
[36m(main_task pid=254128)[0m     _coeff, _factors = func()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 3378, in factor_list
[36m(main_task pid=254128)[0m     coeff, factors = f.rep.factor_list()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyclasses.py", line 1637, in factor_list
[36m(main_task pid=254128)[0m     coeff, factors = dmp_factor_list(f._rep, f.lev, f.dom)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1569, in dmp_factor_list
[36m(main_task pid=254128)[0m     coeff, factors = dmp_zz_factor(f, v, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1189, in dmp_zz_factor
[36m(main_task pid=254128)[0m     H = dmp_zz_wang(g, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1025, in dmp_zz_wang
[36m(main_task pid=254128)[0m     ct, T = dmp_zz_factor(dmp_LC(f, K), u - 1, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1192, in dmp_zz_factor
[36m(main_task pid=254128)[0m     for g, k in dmp_zz_factor(G, u - 1, K)[1]:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1190, in dmp_zz_factor
[36m(main_task pid=254128)[0m     factors = dmp_trial_division(f, H, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 129, in dmp_trial_division
[36m(main_task pid=254128)[0m     q, r = dmp_div(f, factor, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 1629, in dmp_div
[36m(main_task pid=254128)[0m     return dmp_rr_div(f, g, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 1398, in dmp_rr_div
[36m(main_task pid=254128)[0m     r = dmp_sub(r, h, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 655, in dmp_sub
[36m(main_task pid=254128)[0m     return dmp_strip([ dmp_sub(a, b, v, K) for a, b in zip(f, g) ], u)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 655, in <listcomp>
[36m(main_task pid=254128)[0m     return dmp_strip([ dmp_sub(a, b, v, K) for a, b in zip(f, g) ], u)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 645, in dmp_sub
[36m(main_task pid=254128)[0m     return dmp_neg(g, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 510, in dmp_neg
[36m(main_task pid=254128)[0m     return [ dmp_neg(cf, v, K) for cf in f ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 510, in <listcomp>
[36m(main_task pid=254128)[0m     return [ dmp_neg(cf, v, K) for cf in f ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 510, in dmp_neg
[36m(main_task pid=254128)[0m     return [ dmp_neg(cf, v, K) for cf in f ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 510, in <listcomp>
[36m(main_task pid=254128)[0m     return [ dmp_neg(cf, v, K) for cf in f ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 510, in dmp_neg
[36m(main_task pid=254128)[0m     return [ dmp_neg(cf, v, K) for cf in f ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 510, in <listcomp>
[36m(main_task pid=254128)[0m     return [ dmp_neg(cf, v, K) for cf in f ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 510, in dmp_neg
[36m(main_task pid=254128)[0m     return [ dmp_neg(cf, v, K) for cf in f ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 510, in <listcomp>
[36m(main_task pid=254128)[0m     return [ dmp_neg(cf, v, K) for cf in f ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 506, in dmp_neg
[36m(main_task pid=254128)[0m     return dup_neg(f, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 488, in dup_neg
[36m(main_task pid=254128)[0m     return [ -coeff for coeff in f ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 488, in <listcomp>
[36m(main_task pid=254128)[0m     return [ -coeff for coeff in f ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:46:19,705:Error comparing 1992 and Sum(2**n*x_n, (n, 0, 1992))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1335, in evalf_sum
[36m(main_task pid=254128)[0m     raise NotImplementedError
[36m(main_task pid=254128)[0m NotImplementedError
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 645, in simplify
[36m(main_task pid=254128)[0m     expr1 = shorter(_e, _mexpand(_e).cancel())  # issue 6829
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3782, in cancel
[36m(main_task pid=254128)[0m     return cancel(self, *gens, **args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7155, in cancel
[36m(main_task pid=254128)[0m     f = signsimp(f)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 406, in signsimp
[36m(main_task pid=254128)[0m     e = sub_post(sub_pre(e))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/cse_opts.py", line 14, in sub_pre
[36m(main_task pid=254128)[0m     adds = [a for a in e.atoms(Add) if a.could_extract_minus_sign()]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/cse_opts.py", line 14, in <listcomp>
[36m(main_task pid=254128)[0m     adds = [a for a in e.atoms(Add) if a.could_extract_minus_sign()]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 412, in could_extract_minus_sign
[36m(main_task pid=254128)[0m     return _could_extract_minus_sign(self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 30, in _could_extract_minus_sign
[36m(main_task pid=254128)[0m     return bool(expr.sort_key() < (-expr).sort_key())
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 136, in sort_key
[36m(main_task pid=254128)[0m     args = expr.as_ordered_terms(order=order)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 1135, in as_ordered_terms
[36m(main_task pid=254128)[0m     terms, gens = self.as_terms()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 1172, in as_terms
[36m(main_task pid=254128)[0m     coeff *= complex(factor)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 343, in __complex__
[36m(main_task pid=254128)[0m     result = self.evalf()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1648, in evalf
[36m(main_task pid=254128)[0m     result = evalf(self, prec + 4, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1355, in evalf_sum
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(s, prec2, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1175, in evalf_integral
[36m(main_task pid=254128)[0m     result = do_integral(expr, workprec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1136, in do_integral
[36m(main_task pid=254128)[0m     result, quadrature_err = quadts(f, [xlow, xhigh], error=1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 789, in quadts
[36m(main_task pid=254128)[0m     return ctx.quad(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 746, in quad
[36m(main_task pid=254128)[0m     v, err = rule.summation(f, points[0], prec, epsilon, m, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 229, in summation
[36m(main_task pid=254128)[0m     nodes = self.get_nodes(a, b, degree, prec, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 64, in get_nodes
[36m(main_task pid=254128)[0m     nodes = self.calc_nodes(degree, prec, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 363, in calc_nodes
[36m(main_task pid=254128)[0m     c = ctx.exp(a-b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/ctx_mp_python.py", line 1000, in f
[36m(main_task pid=254128)[0m     return ctx.make_mpf(mpf_f(x._mpf_, prec, rounding))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libelefun.py", line 1188, in mpf_exp
[36m(main_task pid=254128)[0m     return from_man_exp(man, n-wp, prec, rnd)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libmpf.py", line 291, in from_man_exp
[36m(main_task pid=254128)[0m     def from_man_exp(man, exp, prec=None, rnd=round_fast):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:46:19,850:Error comparing zoo and 11
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:46:19,851:Error comparing zoo and 18
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:46:19,853:Error comparing zoo and 12
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:46:19,855:Error comparing zoo and 5
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:46:19,858:Error comparing zoo and 16
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:46:19,860:Error comparing zoo and 14
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 09:46:19,864:Error comparing zoo and 10
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:5 - batch/bef_solve_none:100.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:100.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.048 - batch/bef_failed:0.952 - batch/on_solved:0.048 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:49638.000 - global_seqlen/max:74553.000 - global_seqlen/minmax_diff:24915.000 - global_seqlen/balanced_min:61255.000 - global_seqlen/balanced_max:64607.000 - global_seqlen/mean:61725.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.010 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.620 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.425 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.107 - mfu/actor:0.302 - actor/lr:0.000 - critic/score/mean:0.048 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.048 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.875 - critic/advantages/min:-0.625 - critic/returns/mean:-0.003 - critic/returns/max:0.875 - critic/returns/min:-0.625 - response_length/mean:722.724 - response_length/max:8192.000 - response_length/min:8.000 - response_length/clip_ratio:0.001 - on_off_metrics/on_response_length_mean:722.724 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.048 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.742 - prompt_length/max:514.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:184.294 - timing_s/old_log_prob:4.859 - timing_s/adv:17.438 - timing_s/update_actor:15.845 - timing_s/step:217.872 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.249 - timing_per_token_ms/adv:0.018
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:6 - batch/bef_solve_none:96.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:96.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.056 - batch/bef_failed:0.944 - batch/on_solved:0.056 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:27305.000 - global_seqlen/max:43189.000 - global_seqlen/minmax_diff:15884.000 - global_seqlen/balanced_min:35513.000 - global_seqlen/balanced_max:35668.000 - global_seqlen/mean:35630.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.048 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.732 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.772 - actor/pg_loss:0.071 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.117 - mfu/actor:0.298 - actor/lr:0.000 - actor/sft_entropy_loss:0.687 - actor/sft_loss:0.717 - actor/sft_grad_norm:0.215 - mfu/sft_actor:0.524 - actor/sft_lr:0.000 - critic/score/mean:0.056 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.056 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.875 - critic/advantages/min:-0.625 - critic/returns/mean:-0.005 - critic/returns/max:0.875 - critic/returns/min:-0.625 - response_length/mean:739.183 - response_length/max:8192.000 - response_length/min:21.000 - response_length/clip_ratio:0.001 - on_off_metrics/on_response_length_mean:739.183 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.056 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.734 - prompt_length/max:528.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:190.180 - timing_s/old_log_prob:6.059 - timing_s/adv:15.137 - timing_s/update_actor:15.990 - timing_s/sft_update_actor:9.863 - timing_s/step:231.478 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.251 - timing_per_token_ms/adv:0.015
[36m(WorkerDict pid=254528)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(main_task pid=254128)[0m step:7 - batch/bef_solve_none:84.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:84.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.086 - batch/bef_failed:0.914 - batch/on_solved:0.086 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:25429.000 - global_seqlen/max:44535.000 - global_seqlen/minmax_diff:19106.000 - global_seqlen/balanced_min:36272.000 - global_seqlen/balanced_max:36427.000 - global_seqlen/mean:36381.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.029 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.728 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.840 - actor/pg_loss:0.043 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.146 - mfu/actor:0.260 - actor/lr:0.000 - actor/sft_entropy_loss:0.716 - actor/sft_loss:0.724 - actor/sft_grad_norm:0.209 - mfu/sft_actor:0.574 - actor/sft_lr:0.000 - critic/score/mean:0.086 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.086 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:0.875 - critic/advantages/min:-0.750 - critic/returns/mean:-0.009 - critic/returns/max:0.875 - critic/returns/min:-0.750 - response_length/mean:731.518 - response_length/max:8192.000 - response_length/min:24.000 - response_length/clip_ratio:0.001 - on_off_metrics/on_response_length_mean:731.518 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.086 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:239.695 - prompt_length/max:399.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:185.311 - timing_s/old_log_prob:4.686 - timing_s/adv:16.157 - timing_s/update_actor:17.804 - timing_s/sft_update_actor:9.234 - timing_s/step:228.807 - timing_per_token_ms/update_actor:0.018 - timing_per_token_ms/gen:0.247 - timing_per_token_ms/adv:0.016
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254531)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:8 - batch/bef_solve_none:85.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:85.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.092 - batch/bef_failed:0.908 - batch/on_solved:0.092 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:51984.000 - global_seqlen/max:87691.000 - global_seqlen/minmax_diff:35707.000 - global_seqlen/balanced_min:65203.000 - global_seqlen/balanced_max:67207.000 - global_seqlen/mean:65685.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.010 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.747 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.774 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.155 - mfu/actor:0.260 - actor/lr:0.000 - critic/score/mean:0.092 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.092 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.013 - critic/advantages/max:0.875 - critic/advantages/min:-0.625 - critic/returns/mean:-0.013 - critic/returns/max:0.875 - critic/returns/min:-0.625 - response_length/mean:790.367 - response_length/max:8192.000 - response_length/min:4.000 - response_length/clip_ratio:0.003 - on_off_metrics/on_response_length_mean:790.367 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.092 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:235.961 - prompt_length/max:480.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.280 - timing_s/old_log_prob:5.221 - timing_s/adv:14.014 - timing_s/update_actor:19.387 - timing_s/step:227.976 - timing_per_token_ms/update_actor:0.018 - timing_per_token_ms/gen:0.240 - timing_per_token_ms/adv:0.013
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 30x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:9 - batch/bef_solve_none:88.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:88.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.074 - batch/bef_failed:0.926 - batch/on_solved:0.074 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:26194.000 - global_seqlen/max:46701.000 - global_seqlen/minmax_diff:20507.000 - global_seqlen/balanced_min:36757.000 - global_seqlen/balanced_max:36824.000 - global_seqlen/mean:36789.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.001 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.667 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.154 - actor/pg_loss:-0.011 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.147 - mfu/actor:0.310 - actor/lr:0.000 - actor/sft_entropy_loss:0.704 - actor/sft_loss:0.714 - actor/sft_grad_norm:0.203 - mfu/sft_actor:0.606 - actor/sft_lr:0.000 - critic/score/mean:0.074 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.074 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.875 - critic/advantages/min:-0.625 - critic/returns/mean:0.002 - critic/returns/max:0.875 - critic/returns/min:-0.625 - response_length/mean:790.711 - response_length/max:8192.000 - response_length/min:17.000 - response_length/clip_ratio:0.004 - on_off_metrics/on_response_length_mean:790.711 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.074 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.203 - prompt_length/max:520.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:187.039 - timing_s/old_log_prob:5.283 - timing_s/adv:12.209 - timing_s/update_actor:16.201 - timing_s/sft_update_actor:9.331 - timing_s/step:225.082 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.231 - timing_per_token_ms/adv:0.012
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:05:11,707:Error comparing 1/(2*pi) and Integral((1 - cos(x))/((x - sin(x))**2), (x, pi, 2*pi))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 143, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return (a - b).evalf(chop=True, n=numeric_precision) == 0  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1648, in evalf
[36m(main_task pid=254128)[0m     result = evalf(self, prec + 4, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 697, in evalf_mul
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(arg, working_prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1175, in evalf_integral
[36m(main_task pid=254128)[0m     result = do_integral(expr, workprec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1136, in do_integral
[36m(main_task pid=254128)[0m     result, quadrature_err = quadts(f, [xlow, xhigh], error=1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 789, in quadts
[36m(main_task pid=254128)[0m     return ctx.quad(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 746, in quad
[36m(main_task pid=254128)[0m     v, err = rule.summation(f, points[0], prec, epsilon, m, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 233, in summation
[36m(main_task pid=254128)[0m     result = self.sum_next(f, nodes, degree, prec, results, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 308, in sum_next
[36m(main_task pid=254128)[0m     S += self.ctx.fdot((w,f(x)) for (x,w) in nodes)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/ctx_mp_python.py", line 938, in fdot
[36m(main_task pid=254128)[0m     for a, b in A:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 308, in <genexpr>
[36m(main_task pid=254128)[0m     S += self.ctx.fdot((w,f(x)) for (x,w) in nodes)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1109, in f
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(func, mp.prec, {'subs': {x: t}})
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 697, in evalf_mul
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(arg, working_prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 697, in evalf_mul
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(arg, working_prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 940, in evalf_trig
[36m(main_task pid=254128)[0m     y = func(re, prec, rnd)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libelefun.py", line 1378, in mpf_cos
[36m(main_task pid=254128)[0m     def mpf_cos(x, prec, rnd=round_fast): return mpf_cos_sin(x, prec, rnd, 1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libelefun.py", line 1360, in mpf_cos_sin
[36m(main_task pid=254128)[0m     c, s = cos_sin_basecase(t, wp)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libelefun.py", line 1129, in cos_sin_basecase
[36m(main_task pid=254128)[0m     return exponential_series(x, prec, 2)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libelefun.py", line 1081, in exponential_series
[36m(main_task pid=254128)[0m     s = isqrt_fast(abs((one<<wp) - c*c))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libintmath.py", line 258, in isqrt_fast_python
[36m(main_task pid=254128)[0m     bc = bitcount(x)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libintmath.py", line 96, in python_bitcount
[36m(main_task pid=254128)[0m     bc = int(math.log(n, 2)) - 4
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 30x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(main_task pid=254128)[0m Find no current best saved. Best score is set to -inf
[36m(main_task pid=254128)[0m Saving best checkpoint with score 0.19210494873471687 at ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Saving actor checkpoint to ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m [2025-05-28 10:10:12,457] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m df: ‚Äò/root/.triton/autotune‚Äô: No such file or directory
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m df: ‚Äò/root/.triton/autotune‚Äô: No such file or directory
[36m(WorkerDict pid=254533)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m   warnings.warn([32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:10 - batch/bef_solve_none:86.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:86.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.093 - batch/bef_failed:0.907 - batch/on_solved:0.093 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:26766.000 - global_seqlen/max:43893.000 - global_seqlen/minmax_diff:17127.000 - global_seqlen/balanced_min:35784.000 - global_seqlen/balanced_max:35883.000 - global_seqlen/mean:35828.375 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.040 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.627 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.565 - actor/pg_loss:0.064 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.158 - mfu/actor:0.295 - actor/lr:0.000 - actor/sft_entropy_loss:0.672 - actor/sft_loss:0.675 - actor/sft_grad_norm:0.197 - mfu/sft_actor:0.490 - actor/sft_lr:0.000 - val/test_score/math:0.458 - val/test_score/minerva:0.147 - val/test_score/aime:0.029 - val/test_score/olympiad_bench:0.149 - val/test_score/amc:0.178 - avg_score:0.192 - critic/score/mean:0.093 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.093 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:0.875 - critic/advantages/min:-0.625 - critic/returns/mean:-0.010 - critic/returns/max:0.875 - critic/returns/min:-0.625 - response_length/mean:761.530 - response_length/max:8192.000 - response_length/min:11.000 - response_length/clip_ratio:0.002 - on_off_metrics/on_response_length_mean:761.530 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.093 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:230.797 - prompt_length/max:348.000 - prompt_length/min:169.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:185.871 - timing_s/old_log_prob:5.711 - timing_s/adv:15.328 - timing_s/update_actor:16.228 - timing_s/sft_update_actor:10.692 - timing_s/testing:248.147 - timing_s/step:511.654 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.238 - timing_per_token_ms/adv:0.015
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:11 - batch/bef_solve_none:81.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:81.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.099 - batch/bef_failed:0.901 - batch/on_solved:0.099 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:60141.000 - global_seqlen/max:81932.000 - global_seqlen/minmax_diff:21791.000 - global_seqlen/balanced_min:67414.000 - global_seqlen/balanced_max:70654.000 - global_seqlen/mean:68288.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.079 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.695 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.027 - actor/pg_loss:0.134 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.178 - mfu/actor:0.317 - actor/lr:0.000 - critic/score/mean:0.099 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.099 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.875 - critic/advantages/min:-0.750 - critic/returns/mean:-0.001 - critic/returns/max:0.875 - critic/returns/min:-0.750 - response_length/mean:815.580 - response_length/max:8192.000 - response_length/min:48.000 - response_length/clip_ratio:0.004 - on_off_metrics/on_response_length_mean:815.580 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.099 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.422 - prompt_length/max:604.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.816 - timing_s/old_log_prob:5.391 - timing_s/adv:12.274 - timing_s/update_actor:17.574 - timing_s/step:226.010 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.234 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:17:27,179:Error comparing (-1/5 < x) & (x < 2/3) and (-1*15*x**2 + 7*x + 2)/(6*x**2 - x + 5) > 0
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictGreaterThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:12 - batch/bef_solve_none:88.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:88.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.086 - batch/bef_failed:0.914 - batch/on_solved:0.086 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:29299.000 - global_seqlen/max:47036.000 - global_seqlen/minmax_diff:17737.000 - global_seqlen/balanced_min:37474.000 - global_seqlen/balanced_max:37638.000 - global_seqlen/mean:37553.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.030 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.660 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.335 - actor/pg_loss:0.052 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.142 - mfu/actor:0.310 - actor/lr:0.000 - actor/sft_entropy_loss:0.757 - actor/sft_loss:0.750 - actor/sft_grad_norm:0.193 - mfu/sft_actor:0.506 - actor/sft_lr:0.000 - critic/score/mean:0.086 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.086 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:0.875 - critic/advantages/min:-0.750 - critic/returns/mean:-0.009 - critic/returns/max:0.875 - critic/returns/min:-0.750 - response_length/mean:851.021 - response_length/max:8192.000 - response_length/min:28.000 - response_length/clip_ratio:0.003 - on_off_metrics/on_response_length_mean:851.021 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.086 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:249.727 - prompt_length/max:531.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:185.085 - timing_s/old_log_prob:5.612 - timing_s/adv:14.123 - timing_s/update_actor:17.125 - timing_s/sft_update_actor:11.473 - timing_s/step:228.110 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.212 - timing_per_token_ms/adv:0.013
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:13 - batch/bef_solve_none:74.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:74.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.114 - batch/bef_failed:0.886 - batch/on_solved:0.114 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:27522.000 - global_seqlen/max:45771.000 - global_seqlen/minmax_diff:18249.000 - global_seqlen/balanced_min:37017.000 - global_seqlen/balanced_max:37097.000 - global_seqlen/mean:37040.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.041 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.657 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.512 - actor/pg_loss:-0.074 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.182 - mfu/actor:0.302 - actor/lr:0.000 - actor/sft_entropy_loss:0.785 - actor/sft_loss:0.763 - actor/sft_grad_norm:0.185 - mfu/sft_actor:0.756 - actor/sft_lr:0.000 - critic/score/mean:0.114 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.114 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:0.875 - critic/advantages/min:-0.750 - critic/returns/mean:-0.012 - critic/returns/max:0.875 - critic/returns/min:-0.750 - response_length/mean:932.685 - response_length/max:8192.000 - response_length/min:107.000 - response_length/clip_ratio:0.006 - on_off_metrics/on_response_length_mean:932.685 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.114 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.859 - prompt_length/max:416.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.249 - timing_s/old_log_prob:5.612 - timing_s/adv:17.212 - timing_s/update_actor:19.088 - timing_s/sft_update_actor:8.986 - timing_s/step:237.838 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.201 - timing_per_token_ms/adv:0.014
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:14 - batch/bef_solve_none:81.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:81.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.122 - batch/bef_failed:0.878 - batch/on_solved:0.122 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:58731.000 - global_seqlen/max:99523.000 - global_seqlen/minmax_diff:40792.000 - global_seqlen/balanced_min:72185.000 - global_seqlen/balanced_max:74385.000 - global_seqlen/mean:72812.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.008 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.639 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.698 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.196 - mfu/actor:0.303 - actor/lr:0.000 - critic/score/mean:0.122 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.122 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.006 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:0.006 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:893.073 - response_length/max:8192.000 - response_length/min:96.000 - response_length/clip_ratio:0.003 - on_off_metrics/on_response_length_mean:893.073 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.122 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.625 - prompt_length/max:662.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.492 - timing_s/old_log_prob:5.671 - timing_s/adv:12.412 - timing_s/update_actor:18.143 - timing_s/step:224.373 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.212 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:29:09,315:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:29:09,317:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:29:09,319:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:29:09,322:Error comparing zoo and 0
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:29:09,323:Error comparing zoo and 15
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:29:09,325:Error comparing zoo and 24
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:29:09,328:Error comparing zoo and 1/2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:15 - batch/bef_solve_none:81.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:81.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.124 - batch/bef_failed:0.876 - batch/on_solved:0.124 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:26213.000 - global_seqlen/max:42764.000 - global_seqlen/minmax_diff:16551.000 - global_seqlen/balanced_min:35404.000 - global_seqlen/balanced_max:35523.000 - global_seqlen/mean:35485.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.027 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.664 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.524 - actor/pg_loss:0.068 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.163 - mfu/actor:0.287 - actor/lr:0.000 - actor/sft_entropy_loss:0.749 - actor/sft_loss:0.733 - actor/sft_grad_norm:0.183 - mfu/sft_actor:0.631 - actor/sft_lr:0.000 - critic/score/mean:0.124 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.124 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.010 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:879.888 - response_length/max:8192.000 - response_length/min:66.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:879.888 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.124 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:239.750 - prompt_length/max:496.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:188.517 - timing_s/old_log_prob:5.646 - timing_s/adv:11.965 - timing_s/update_actor:18.866 - timing_s/sft_update_actor:9.653 - timing_s/step:229.345 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.209 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:16 - batch/bef_solve_none:73.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:1.000 - batch/solve_none:73.000 - batch/solve_none_format:0.000 - batch/solve_all:1.000 - batch/bef_solved:0.131 - batch/bef_failed:0.869 - batch/on_solved:0.131 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:66475.000 - global_seqlen/max:86097.000 - global_seqlen/minmax_diff:19622.000 - global_seqlen/balanced_min:74894.000 - global_seqlen/balanced_max:77307.000 - global_seqlen/mean:75480.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.049 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.613 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.920 - actor/pg_loss:0.096 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.184 - mfu/actor:0.278 - actor/lr:0.000 - critic/score/mean:0.131 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.131 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.019 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.019 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:937.345 - response_length/max:8192.000 - response_length/min:117.000 - response_length/clip_ratio:0.003 - on_off_metrics/on_response_length_mean:937.345 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.131 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.031 - prompt_length/max:517.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:186.019 - timing_s/old_log_prob:6.446 - timing_s/adv:15.185 - timing_s/update_actor:20.397 - timing_s/step:221.917 - timing_per_token_ms/update_actor:0.017 - timing_per_token_ms/gen:0.194 - timing_per_token_ms/adv:0.013
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:36:53,418:Error during parsing
[36m(main_task pid=254128)[0m ValueError: Error from parse_expr with transformed code: 'Ôºí'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=254128)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=254128)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=254128)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=254128)[0m     expr = eval(
[36m(main_task pid=254128)[0m   File "<string>", line 1
[36m(main_task pid=254128)[0m     Ôºí
[36m(main_task pid=254128)[0m     ^
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºí' (U+FF12)
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=254128)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=254128)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=254128)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=254128)[0m     number = Number(number_str)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=254128)[0m     val = sympify(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=254128)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=254128)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse 'Ôºí'' failed, because of exception being raised:
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºí' (U+FF12) (<string>, line 1)
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:17 - batch/bef_solve_none:69.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:69.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.138 - batch/bef_failed:0.862 - batch/on_solved:0.138 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32433.000 - global_seqlen/max:42733.000 - global_seqlen/minmax_diff:10300.000 - global_seqlen/balanced_min:37945.000 - global_seqlen/balanced_max:38076.000 - global_seqlen/mean:38031.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.025 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.681 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.549 - actor/pg_loss:-0.039 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.169 - mfu/actor:0.304 - actor/lr:0.000 - actor/sft_entropy_loss:0.684 - actor/sft_loss:0.679 - actor/sft_grad_norm:0.173 - mfu/sft_actor:0.575 - actor/sft_lr:0.000 - critic/score/mean:0.138 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.138 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.011 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:950.657 - response_length/max:8192.000 - response_length/min:160.000 - response_length/clip_ratio:0.006 - on_off_metrics/on_response_length_mean:950.657 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.138 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.023 - prompt_length/max:568.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:196.855 - timing_s/old_log_prob:5.719 - timing_s/adv:12.807 - timing_s/update_actor:19.336 - timing_s/sft_update_actor:11.199 - timing_s/step:240.525 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.202 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254528)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:40:47,595:Error comparing (d_1 < 1) & (d_2 < d_1) and d_1 < d_2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 10:40:53,401:Error comparing (-1 <= a) & (a <= 17/8) and a <= 17/8
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'LessThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:18 - batch/bef_solve_none:63.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:63.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.174 - batch/bef_failed:0.826 - batch/on_solved:0.174 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:29175.000 - global_seqlen/max:46033.000 - global_seqlen/minmax_diff:16858.000 - global_seqlen/balanced_min:39595.000 - global_seqlen/balanced_max:39714.000 - global_seqlen/mean:39665.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.003 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.624 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.799 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.198 - mfu/actor:0.338 - actor/lr:0.000 - actor/sft_entropy_loss:0.765 - actor/sft_loss:0.726 - actor/sft_grad_norm:0.164 - mfu/sft_actor:0.761 - actor/sft_lr:0.000 - critic/score/mean:0.174 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.174 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.021 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.021 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:960.476 - response_length/max:8192.000 - response_length/min:155.000 - response_length/clip_ratio:0.007 - on_off_metrics/on_response_length_mean:960.476 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.174 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:239.359 - prompt_length/max:367.000 - prompt_length/min:170.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.253 - timing_s/old_log_prob:5.884 - timing_s/adv:14.897 - timing_s/update_actor:18.805 - timing_s/sft_update_actor:9.243 - timing_s/step:238.568 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.199 - timing_per_token_ms/adv:0.012
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254532)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:19 - batch/bef_solve_none:63.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:0.000 - batch/solve_none:63.000 - batch/solve_none_format:0.000 - batch/solve_all:0.000 - batch/bef_solved:0.187 - batch/bef_failed:0.813 - batch/on_solved:0.187 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:68905.000 - global_seqlen/max:94204.000 - global_seqlen/minmax_diff:25299.000 - global_seqlen/balanced_min:81859.000 - global_seqlen/balanced_max:82073.000 - global_seqlen/mean:81939.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.073 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.666 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.647 - actor/pg_loss:0.157 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.217 - mfu/actor:0.268 - actor/lr:0.000 - critic/score/mean:0.187 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.187 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.016 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.016 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1033.439 - response_length/max:8192.000 - response_length/min:216.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1033.439 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.187 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:246.867 - prompt_length/max:587.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.414 - timing_s/old_log_prob:5.921 - timing_s/adv:15.034 - timing_s/update_actor:23.337 - timing_s/step:232.141 - timing_per_token_ms/update_actor:0.018 - timing_per_token_ms/gen:0.183 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 23x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 24x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(main_task pid=254128)[0m Saving best checkpoint with score 0.2795656881524876 at ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Saving actor checkpoint to ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(main_task pid=254128)[0m step:20 - batch/bef_solve_none:62.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:4.000 - batch/solve_none:62.000 - batch/solve_none_format:0.000 - batch/solve_all:4.000 - batch/bef_solved:0.188 - batch/bef_failed:0.812 - batch/on_solved:0.188 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:69676.000 - global_seqlen/max:97978.000 - global_seqlen/minmax_diff:28302.000 - global_seqlen/balanced_min:80627.000 - global_seqlen/balanced_max:80943.000 - global_seqlen/mean:80746.500 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.018 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.786 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.712 - actor/pg_loss:0.040 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.197 - mfu/actor:0.314 - actor/lr:0.000 - val/test_score/olympiad_bench:0.263 - val/test_score/amc:0.307 - val/test_score/math:0.570 - val/test_score/aime:0.033 - val/test_score/minerva:0.224 - avg_score:0.280 - critic/score/mean:0.188 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.188 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.014 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1023.164 - response_length/max:8192.000 - response_length/min:40.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1023.164 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.188 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:238.500 - prompt_length/max:501.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.925 - timing_s/old_log_prob:5.897 - timing_s/adv:13.925 - timing_s/update_actor:19.574 - timing_s/testing:245.420 - timing_s/step:505.599 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.184 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:21 - batch/bef_solve_none:69.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:4.000 - batch/solve_none:69.000 - batch/solve_none_format:0.000 - batch/solve_all:4.000 - batch/bef_solved:0.180 - batch/bef_failed:0.820 - batch/on_solved:0.180 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:28995.000 - global_seqlen/max:43892.000 - global_seqlen/minmax_diff:14897.000 - global_seqlen/balanced_min:37997.000 - global_seqlen/balanced_max:38094.000 - global_seqlen/mean:38060.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.005 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.653 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.603 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.188 - mfu/actor:0.287 - actor/lr:0.000 - actor/sft_entropy_loss:0.745 - actor/sft_loss:0.726 - actor/sft_grad_norm:0.161 - mfu/sft_actor:0.686 - actor/sft_lr:0.000 - critic/score/mean:0.180 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.180 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.010 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:969.245 - response_length/max:8192.000 - response_length/min:77.000 - response_length/clip_ratio:0.002 - on_off_metrics/on_response_length_mean:969.245 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.180 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:235.062 - prompt_length/max:515.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:187.672 - timing_s/old_log_prob:6.039 - timing_s/adv:14.370 - timing_s/update_actor:20.380 - timing_s/sft_update_actor:9.799 - timing_s/step:232.557 - timing_per_token_ms/update_actor:0.017 - timing_per_token_ms/gen:0.189 - timing_per_token_ms/adv:0.012
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:22 - batch/bef_solve_none:60.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:1.000 - batch/solve_none:60.000 - batch/solve_none_format:0.000 - batch/solve_all:1.000 - batch/bef_solved:0.177 - batch/bef_failed:0.823 - batch/on_solved:0.177 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:65963.000 - global_seqlen/max:109968.000 - global_seqlen/minmax_diff:44005.000 - global_seqlen/balanced_min:85026.000 - global_seqlen/balanced_max:85339.000 - global_seqlen/mean:85298.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.011 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.684 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.364 - actor/pg_loss:-0.038 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.202 - mfu/actor:0.338 - actor/lr:0.000 - critic/score/mean:0.177 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.177 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.014 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1089.462 - response_length/max:8192.000 - response_length/min:192.000 - response_length/clip_ratio:0.010 - on_off_metrics/on_response_length_mean:1089.462 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.177 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.320 - prompt_length/max:407.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.261 - timing_s/old_log_prob:6.663 - timing_s/adv:16.782 - timing_s/update_actor:19.477 - timing_s/step:230.856 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.174 - timing_per_token_ms/adv:0.012
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 30x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254527)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:23 - batch/bef_solve_none:50.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:2.000 - batch/solve_none:50.000 - batch/solve_none_format:0.000 - batch/solve_all:2.000 - batch/bef_solved:0.218 - batch/bef_failed:0.782 - batch/on_solved:0.218 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:28370.000 - global_seqlen/max:49950.000 - global_seqlen/minmax_diff:21580.000 - global_seqlen/balanced_min:37262.000 - global_seqlen/balanced_max:37316.000 - global_seqlen/mean:37277.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.041 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.736 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.228 - actor/pg_loss:0.105 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.227 - mfu/actor:0.316 - actor/lr:0.000 - actor/sft_entropy_loss:0.743 - actor/sft_loss:0.702 - actor/sft_grad_norm:0.154 - mfu/sft_actor:0.743 - actor/sft_lr:0.000 - critic/score/mean:0.218 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.218 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.021 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.021 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1061.297 - response_length/max:8192.000 - response_length/min:212.000 - response_length/clip_ratio:0.008 - on_off_metrics/on_response_length_mean:1061.297 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.218 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.594 - prompt_length/max:546.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.079 - timing_s/old_log_prob:6.496 - timing_s/adv:14.077 - timing_s/update_actor:20.519 - timing_s/sft_update_actor:9.901 - timing_s/step:236.880 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.177 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:24 - batch/bef_solve_none:60.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:5.000 - batch/solve_none:60.000 - batch/solve_none_format:0.000 - batch/solve_all:5.000 - batch/bef_solved:0.272 - batch/bef_failed:0.728 - batch/on_solved:0.272 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:75885.000 - global_seqlen/max:101835.000 - global_seqlen/minmax_diff:25950.000 - global_seqlen/balanced_min:85135.000 - global_seqlen/balanced_max:85136.000 - global_seqlen/mean:85135.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.004 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.759 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.991 - actor/pg_loss:-0.016 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.193 - mfu/actor:0.318 - actor/lr:0.000 - critic/score/mean:0.272 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.272 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.017 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1089.190 - response_length/max:8192.000 - response_length/min:228.000 - response_length/clip_ratio:0.008 - on_off_metrics/on_response_length_mean:1089.190 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.272 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.047 - prompt_length/max:448.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.777 - timing_s/old_log_prob:6.398 - timing_s/adv:12.649 - timing_s/update_actor:21.186 - timing_s/step:226.937 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.173 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:25 - batch/bef_solve_none:47.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:5.000 - batch/solve_none:47.000 - batch/solve_none_format:0.000 - batch/solve_all:5.000 - batch/bef_solved:0.278 - batch/bef_failed:0.722 - batch/on_solved:0.278 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31686.000 - global_seqlen/max:47630.000 - global_seqlen/minmax_diff:15944.000 - global_seqlen/balanced_min:39427.000 - global_seqlen/balanced_max:39535.000 - global_seqlen/mean:39493.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.080 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.724 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.391 - actor/pg_loss:0.198 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.221 - mfu/actor:0.318 - actor/lr:0.000 - actor/sft_entropy_loss:0.732 - actor/sft_loss:0.716 - actor/sft_grad_norm:0.147 - mfu/sft_actor:0.719 - actor/sft_lr:0.000 - critic/score/mean:0.278 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.278 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.027 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.027 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1144.280 - response_length/max:8192.000 - response_length/min:171.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1144.280 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.278 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.203 - prompt_length/max:790.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.974 - timing_s/old_log_prob:6.340 - timing_s/adv:18.375 - timing_s/update_actor:21.315 - timing_s/sft_update_actor:10.602 - timing_s/step:245.573 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.166 - timing_per_token_ms/adv:0.013
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:26 - batch/bef_solve_none:49.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:4.000 - batch/solve_none:49.000 - batch/solve_none_format:0.000 - batch/solve_all:4.000 - batch/bef_solved:0.268 - batch/bef_failed:0.732 - batch/on_solved:0.268 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:68157.000 - global_seqlen/max:115659.000 - global_seqlen/minmax_diff:47502.000 - global_seqlen/balanced_min:82349.000 - global_seqlen/balanced_max:83397.000 - global_seqlen/mean:82677.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.087 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.777 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.890 - actor/pg_loss:-0.181 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.207 - mfu/actor:0.318 - actor/lr:0.000 - critic/score/mean:0.268 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.268 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.017 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1046.552 - response_length/max:8192.000 - response_length/min:206.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1046.552 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.268 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.281 - prompt_length/max:996.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.343 - timing_s/old_log_prob:6.905 - timing_s/adv:15.469 - timing_s/update_actor:19.683 - timing_s/step:227.786 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.179 - timing_per_token_ms/adv:0.012
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 11:20:44,479:Error comparing 400 and Sum(1/f(k), (k, 1, 1995))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'zero'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'extended_real'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'zero'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'algebraic'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 166, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     elif isinstance(a_b_diff, Basic) and a_b_diff.is_zero:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 503, in getit
[36m(main_task pid=254128)[0m     return _ask(fact, self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 559, in _ask
[36m(main_task pid=254128)[0m     fact_i_value = handler_i(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 860, in _eval_is_extended_negative
[36m(main_task pid=254128)[0m     v = _monotonic_sign(a)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/exprtools.py", line 69, in _monotonic_sign
[36m(main_task pid=254128)[0m     if not self.is_extended_real:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 503, in getit
[36m(main_task pid=254128)[0m     return _ask(fact, self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 559, in _ask
[36m(main_task pid=254128)[0m     fact_i_value = handler_i(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 871, in _eval_is_extended_negative
[36m(main_task pid=254128)[0m     args = [a for a in self.args if not a.is_zero]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 871, in <listcomp>
[36m(main_task pid=254128)[0m     args = [a for a in self.args if not a.is_zero]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 503, in getit
[36m(main_task pid=254128)[0m     return _ask(fact, self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 559, in _ask
[36m(main_task pid=254128)[0m     fact_i_value = handler_i(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 1382, in _eval_is_algebraic
[36m(main_task pid=254128)[0m     r = _fuzzy_group((a.is_algebraic for a in self.args), quick_exit=True)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/logic.py", line 81, in _fuzzy_group
[36m(main_task pid=254128)[0m     for a in args:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 1382, in <genexpr>
[36m(main_task pid=254128)[0m     r = _fuzzy_group((a.is_algebraic for a in self.args), quick_exit=True)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 503, in getit
[36m(main_task pid=254128)[0m     return _ask(fact, self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 559, in _ask
[36m(main_task pid=254128)[0m     fact_i_value = handler_i(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 512, in _eval_is_extended_real
[36m(main_task pid=254128)[0m     if self.base.func == Pow and self.base.base is S.Exp1 and self.base.exp.is_imaginary:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/function.py", line 369, in func
[36m(main_task pid=254128)[0m     @property
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 11:20:47,343:Error comparing (2 < a) & (a < 8/3) and a > 3
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictGreaterThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 22x across cluster][0m
[36m(WorkerDict pid=254530)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 26x across cluster][0m
[36m(main_task pid=254128)[0m step:27 - batch/bef_solve_none:53.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:5.000 - batch/solve_none:53.000 - batch/solve_none_format:0.000 - batch/solve_all:5.000 - batch/bef_solved:0.294 - batch/bef_failed:0.706 - batch/on_solved:0.294 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31568.000 - global_seqlen/max:47299.000 - global_seqlen/minmax_diff:15731.000 - global_seqlen/balanced_min:41363.000 - global_seqlen/balanced_max:41464.000 - global_seqlen/mean:41384.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.123 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.867 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.333 - actor/pg_loss:0.277 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.215 - mfu/actor:0.281 - actor/lr:0.000 - actor/sft_entropy_loss:0.657 - actor/sft_loss:0.665 - actor/sft_grad_norm:0.142 - mfu/sft_actor:0.720 - actor/sft_lr:0.000 - critic/score/mean:0.294 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.294 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.039 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.039 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1164.540 - response_length/max:8192.000 - response_length/min:188.000 - response_length/clip_ratio:0.008 - on_off_metrics/on_response_length_mean:1164.540 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.294 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.867 - prompt_length/max:515.000 - prompt_length/min:183.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.448 - timing_s/old_log_prob:6.665 - timing_s/adv:16.660 - timing_s/update_actor:24.426 - timing_s/sft_update_actor:10.664 - timing_s/step:250.509 - timing_per_token_ms/update_actor:0.017 - timing_per_token_ms/gen:0.166 - timing_per_token_ms/adv:0.012
[36m(WorkerDict pid=254528)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:28 - batch/bef_solve_none:62.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:4.000 - batch/solve_none:62.000 - batch/solve_none_format:0.000 - batch/solve_all:4.000 - batch/bef_solved:0.232 - batch/bef_failed:0.768 - batch/on_solved:0.232 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:70191.000 - global_seqlen/max:107728.000 - global_seqlen/minmax_diff:37537.000 - global_seqlen/balanced_min:93029.000 - global_seqlen/balanced_max:93030.000 - global_seqlen/mean:93029.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.016 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.832 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.548 - actor/pg_loss:0.034 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.223 - mfu/actor:0.318 - actor/lr:0.000 - critic/score/mean:0.232 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.232 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.026 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.026 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1205.014 - response_length/max:8192.000 - response_length/min:244.000 - response_length/clip_ratio:0.006 - on_off_metrics/on_response_length_mean:1205.014 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.232 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:248.578 - prompt_length/max:452.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.512 - timing_s/old_log_prob:6.751 - timing_s/adv:13.775 - timing_s/update_actor:22.593 - timing_s/step:229.217 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.156 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:29 - batch/bef_solve_none:58.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:3.000 - batch/solve_none:58.000 - batch/solve_none_format:0.000 - batch/solve_all:3.000 - batch/bef_solved:0.234 - batch/bef_failed:0.766 - batch/on_solved:0.234 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:72068.000 - global_seqlen/max:106399.000 - global_seqlen/minmax_diff:34331.000 - global_seqlen/balanced_min:90777.000 - global_seqlen/balanced_max:90778.000 - global_seqlen/mean:90777.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.013 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.833 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.601 - actor/pg_loss:-0.030 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.183 - mfu/actor:0.316 - actor/lr:0.000 - critic/score/mean:0.234 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.234 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.026 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.026 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1187.809 - response_length/max:8192.000 - response_length/min:129.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1187.809 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.234 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:230.594 - prompt_length/max:425.000 - prompt_length/min:181.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.313 - timing_s/old_log_prob:6.376 - timing_s/adv:15.080 - timing_s/update_actor:21.973 - timing_s/step:229.680 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.158 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 25x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 11:37:25,922:Error comparing C*exp(-1*2*t) + exp(2*i*t)/(2*i + 2) and Eq(z, C_1*exp(-1*2*t) + C_2*i*exp(-1*2*t) + i*sin(2*t)/4 + cos(2*t)/4)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 699, in simplify
[36m(main_task pid=254128)[0m     expr = trigsimp(expr, deep=True)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 565, in trigsimp
[36m(main_task pid=254128)[0m     expr_simplified = trigsimpfunc(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 558, in <lambda>
[36m(main_task pid=254128)[0m     'matching': (lambda x: futrig(x)),
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1159, in futrig
[36m(main_task pid=254128)[0m     e = bottom_up(e, _futrig)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 233, in bottom_up
[36m(main_task pid=254128)[0m     rv = F(rv)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1226, in _futrig
[36m(main_task pid=254128)[0m     e = greedy(tree, objective=Lops)(e)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 150, in minrule
[36m(main_task pid=254128)[0m     return min([rule(expr) for rule in rules], key=objective)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 150, in <listcomp>
[36m(main_task pid=254128)[0m     return min([rule(expr) for rule in rules], key=objective)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 64, in chain_rl
[36m(main_task pid=254128)[0m     expr = rule(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1203, in <lambda>
[36m(main_task pid=254128)[0m     lambda x: _eapply(factor, x, trigs),
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1250, in _eapply
[36m(main_task pid=254128)[0m     return func(e)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6577, in factor
[36m(main_task pid=254128)[0m     return _generic_factor(f, gens, args, method='factor')
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6258, in _generic_factor
[36m(main_task pid=254128)[0m     return _symbolic_factor(sympify(expr), opt, method)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6198, in _symbolic_factor
[36m(main_task pid=254128)[0m     coeff, factors = _symbolic_factor_list(together(expr, fraction=opt['fraction']), opt, method)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6163, in _symbolic_factor_list
[36m(main_task pid=254128)[0m     _coeff, _factors = func()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 3378, in factor_list
[36m(main_task pid=254128)[0m     coeff, factors = f.rep.factor_list()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyclasses.py", line 1637, in factor_list
[36m(main_task pid=254128)[0m     coeff, factors = dmp_factor_list(f._rep, f.lev, f.dom)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1569, in dmp_factor_list
[36m(main_task pid=254128)[0m     coeff, factors = dmp_zz_factor(f, v, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1189, in dmp_zz_factor
[36m(main_task pid=254128)[0m     H = dmp_zz_wang(g, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1112, in dmp_zz_wang
[36m(main_task pid=254128)[0m     factors = dmp_zz_wang_hensel_lifting(f, H, LC, A, p, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 982, in dmp_zz_wang_hensel_lifting
[36m(main_task pid=254128)[0m     h = dmp_sub(s, dmp_expand(H, w, K), w, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 1873, in dmp_expand
[36m(main_task pid=254128)[0m     f = dmp_mul(f, g, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 828, in dmp_mul
[36m(main_task pid=254128)[0m     coeff = dmp_add(coeff, dmp_mul(f[j], g[i - j], v, K), v, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 828, in dmp_mul
[36m(main_task pid=254128)[0m     coeff = dmp_add(coeff, dmp_mul(f[j], g[i - j], v, K), v, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 828, in dmp_mul
[36m(main_task pid=254128)[0m     coeff = dmp_add(coeff, dmp_mul(f[j], g[i - j], v, K), v, K)
[36m(main_task pid=254128)[0m   [Previous line repeated 4 more times]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 807, in dmp_mul
[36m(main_task pid=254128)[0m     return dup_mul(f, g, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densearith.py", line 766, in dup_mul
[36m(main_task pid=254128)[0m     for j in range(max(0, i - dg), min(df, i) + 1):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(main_task pid=254128)[0m Saving best checkpoint with score 0.285823225776105 at ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Saving actor checkpoint to ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(main_task pid=254128)[0m step:30 - batch/bef_solve_none:57.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:6.000 - batch/solve_none:57.000 - batch/solve_none_format:0.000 - batch/solve_all:6.000 - batch/bef_solved:0.229 - batch/bef_failed:0.771 - batch/on_solved:0.229 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:33360.000 - global_seqlen/max:46440.000 - global_seqlen/minmax_diff:13080.000 - global_seqlen/balanced_min:39784.000 - global_seqlen/balanced_max:39910.000 - global_seqlen/mean:39835.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.082 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.776 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.093 - actor/pg_loss:0.196 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.205 - mfu/actor:0.331 - actor/lr:0.000 - actor/sft_entropy_loss:0.626 - actor/sft_loss:0.634 - actor/sft_grad_norm:0.138 - mfu/sft_actor:0.878 - actor/sft_lr:0.000 - val/test_score/math:0.610 - val/test_score/aime:0.058 - val/test_score/amc:0.289 - val/test_score/minerva:0.228 - val/test_score/olympiad_bench:0.244 - avg_score:0.286 - critic/score/mean:0.229 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.229 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:0.875 - critic/advantages/min:-0.750 - critic/returns/mean:-0.030 - critic/returns/max:0.875 - critic/returns/min:-0.750 - response_length/mean:1161.527 - response_length/max:8192.000 - response_length/min:281.000 - response_length/clip_ratio:0.010 - on_off_metrics/on_response_length_mean:1161.527 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.229 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.078 - prompt_length/max:503.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.203 - timing_s/old_log_prob:6.489 - timing_s/adv:13.770 - timing_s/update_actor:21.181 - timing_s/sft_update_actor:9.068 - timing_s/testing:258.192 - timing_s/step:528.656 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.163 - timing_per_token_ms/adv:0.010
[36m(main_task pid=254128)[0m ERROR:2025-05-28 11:41:18,788:Error comparing (x <= 7*pi/4) & (pi/4 <= x) and Union(Interval((7*pi)/4, 2*pi), Union(Interval((5*pi)/4, (7*pi)/4), Union(Interval(0, pi/4), Interval((3*pi)/4, pi))))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=254128)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=254128)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=254128)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=254128)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=254128)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in _complement
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 806, in __sub__
[36m(main_task pid=254128)[0m     return Complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in _complement
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 806, in __sub__
[36m(main_task pid=254128)[0m     return Complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in _complement
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 806, in __sub__
[36m(main_task pid=254128)[0m     return Complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 219, in _complement
[36m(main_task pid=254128)[0m     return Intersection(other, self.complement(S.Reals))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in simplify_intersection
[36m(main_task pid=254128)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=254128)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 455, in _
[36m(main_task pid=254128)[0m     if a.end < b.end:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=254128)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=254128)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=254128)[0m ERROR:2025-05-28 11:41:19,117:Error comparing (x <= 7*pi/4) & (pi/4 <= x) and Union(Interval(0, pi/4), Interval((3*pi)/4, (5*pi)/4))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=254128)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=254128)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=254128)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=254128)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=254128)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in _complement
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 806, in __sub__
[36m(main_task pid=254128)[0m     return Complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 219, in _complement
[36m(main_task pid=254128)[0m     return Intersection(other, self.complement(S.Reals))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in simplify_intersection
[36m(main_task pid=254128)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=254128)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 455, in _
[36m(main_task pid=254128)[0m     if a.end < b.end:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=254128)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=254128)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=254128)[0m ERROR:2025-05-28 11:41:19,218:Error comparing (x <= 7*pi/4) & (pi/4 <= x) and Union(Interval(0, pi/4), Interval((5*pi)/4, 2*pi))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=254128)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=254128)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=254128)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=254128)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=254128)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in _complement
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 222, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(o - self for o in other.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 806, in __sub__
[36m(main_task pid=254128)[0m     return Complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1207, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 219, in _complement
[36m(main_task pid=254128)[0m     return Intersection(other, self.complement(S.Reals))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in simplify_intersection
[36m(main_task pid=254128)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=254128)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 455, in _
[36m(main_task pid=254128)[0m     if a.end < b.end:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=254128)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=254128)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=254128)[0m ERROR:2025-05-28 11:41:19,367:Error comparing (x <= 7*pi/4) & (pi/4 <= x) and {pi/4, (3*pi)/4, (5*pi)/4, (7*pi)/4}
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=254128)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=254128)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=254128)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=254128)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=254128)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2025, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 219, in _complement
[36m(main_task pid=254128)[0m     return Intersection(other, self.complement(S.Reals))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in simplify_intersection
[36m(main_task pid=254128)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=254128)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 430, in _
[36m(main_task pid=254128)[0m     if a.start <= b.end and b.start <= a.end:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=254128)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=254128)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=254128)[0m ERROR:2025-05-28 11:41:25,565:Error comparing (1/3 < a) & (a < 1) and a < 1/3
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 11:41:25,626:Error comparing (1/3 < a) & (a < 1) and a < -1
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 11:41:25,635:Error comparing (1/3 < a) & (a < 1) and a > 1
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictGreaterThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:31 - batch/bef_solve_none:56.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:4.000 - batch/solve_none:56.000 - batch/solve_none_format:0.000 - batch/solve_all:4.000 - batch/bef_solved:0.229 - batch/bef_failed:0.771 - batch/on_solved:0.229 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:65074.000 - global_seqlen/max:126781.000 - global_seqlen/minmax_diff:61707.000 - global_seqlen/balanced_min:93964.000 - global_seqlen/balanced_max:93965.000 - global_seqlen/mean:93964.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.060 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.794 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.985 - actor/pg_loss:0.157 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.216 - mfu/actor:0.322 - actor/lr:0.000 - critic/score/mean:0.229 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.229 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.021 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.021 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1226.043 - response_length/max:8192.000 - response_length/min:251.000 - response_length/clip_ratio:0.011 - on_off_metrics/on_response_length_mean:1226.043 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.229 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.156 - prompt_length/max:458.000 - prompt_length/min:171.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.539 - timing_s/old_log_prob:6.843 - timing_s/adv:14.646 - timing_s/update_actor:22.673 - timing_s/step:230.174 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.153 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:32 - batch/bef_solve_none:41.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:41.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.291 - batch/bef_failed:0.709 - batch/on_solved:0.291 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:34857.000 - global_seqlen/max:48470.000 - global_seqlen/minmax_diff:13613.000 - global_seqlen/balanced_min:40631.000 - global_seqlen/balanced_max:40672.000 - global_seqlen/mean:40653.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.086 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.878 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.282 - actor/pg_loss:0.185 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.232 - mfu/actor:0.310 - actor/lr:0.000 - actor/sft_entropy_loss:0.717 - actor/sft_loss:0.717 - actor/sft_grad_norm:0.135 - mfu/sft_actor:0.766 - actor/sft_lr:0.000 - critic/score/mean:0.291 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.291 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.014 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1111.566 - response_length/max:8192.000 - response_length/min:228.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1111.566 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.291 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.195 - prompt_length/max:373.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:190.415 - timing_s/old_log_prob:6.314 - timing_s/adv:15.045 - timing_s/update_actor:21.230 - timing_s/sft_update_actor:9.727 - timing_s/step:236.727 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.167 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:33 - batch/bef_solve_none:55.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:3.000 - batch/solve_none:55.000 - batch/solve_none_format:0.000 - batch/solve_all:3.000 - batch/bef_solved:0.233 - batch/bef_failed:0.767 - batch/on_solved:0.233 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:64803.000 - global_seqlen/max:118550.000 - global_seqlen/minmax_diff:53747.000 - global_seqlen/balanced_min:91799.000 - global_seqlen/balanced_max:91800.000 - global_seqlen/mean:91799.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.008 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.859 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.354 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.209 - mfu/actor:0.321 - actor/lr:0.000 - critic/score/mean:0.233 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.233 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.019 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.019 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1197.279 - response_length/max:8192.000 - response_length/min:247.000 - response_length/clip_ratio:0.004 - on_off_metrics/on_response_length_mean:1197.279 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.233 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.094 - prompt_length/max:435.000 - prompt_length/min:183.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:191.899 - timing_s/old_log_prob:6.613 - timing_s/adv:14.800 - timing_s/update_actor:21.869 - timing_s/step:228.886 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.157 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:34 - batch/bef_solve_none:52.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:5.000 - batch/solve_none:52.000 - batch/solve_none_format:0.000 - batch/solve_all:5.000 - batch/bef_solved:0.260 - batch/bef_failed:0.740 - batch/on_solved:0.260 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:78266.000 - global_seqlen/max:126084.000 - global_seqlen/minmax_diff:47818.000 - global_seqlen/balanced_min:92392.000 - global_seqlen/balanced_max:92393.000 - global_seqlen/mean:92392.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.751 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.312 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.209 - mfu/actor:0.318 - actor/lr:0.000 - critic/score/mean:0.260 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.260 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.025 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.025 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1200.907 - response_length/max:8192.000 - response_length/min:189.000 - response_length/clip_ratio:0.007 - on_off_metrics/on_response_length_mean:1200.907 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.260 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.719 - prompt_length/max:686.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:201.485 - timing_s/old_log_prob:6.943 - timing_s/adv:14.662 - timing_s/update_actor:22.282 - timing_s/step:238.758 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.164 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:35 - batch/bef_solve_none:50.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:5.000 - batch/solve_none:50.000 - batch/solve_none_format:0.000 - batch/solve_all:5.000 - batch/bef_solved:0.295 - batch/bef_failed:0.705 - batch/on_solved:0.295 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32486.000 - global_seqlen/max:47967.000 - global_seqlen/minmax_diff:15481.000 - global_seqlen/balanced_min:41007.000 - global_seqlen/balanced_max:41062.000 - global_seqlen/mean:41038.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.005 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.882 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.317 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.208 - mfu/actor:0.324 - actor/lr:0.000 - actor/sft_entropy_loss:0.664 - actor/sft_loss:0.672 - actor/sft_grad_norm:0.126 - mfu/sft_actor:0.762 - actor/sft_lr:0.000 - critic/score/mean:0.295 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.295 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.025 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.025 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1190.049 - response_length/max:8192.000 - response_length/min:262.000 - response_length/clip_ratio:0.003 - on_off_metrics/on_response_length_mean:1190.049 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.295 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.500 - prompt_length/max:463.000 - prompt_length/min:167.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.994 - timing_s/old_log_prob:7.072 - timing_s/adv:13.113 - timing_s/update_actor:21.791 - timing_s/sft_update_actor:10.501 - timing_s/step:238.717 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.158 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 21x across cluster][0m
[36m(main_task pid=254128)[0m step:36 - batch/bef_solve_none:54.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:8.000 - batch/solve_none:54.000 - batch/solve_none_format:0.000 - batch/solve_all:8.000 - batch/bef_solved:0.288 - batch/bef_failed:0.712 - batch/on_solved:0.288 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:74048.000 - global_seqlen/max:116544.000 - global_seqlen/minmax_diff:42496.000 - global_seqlen/balanced_min:91059.000 - global_seqlen/balanced_max:91060.000 - global_seqlen/mean:91059.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.851 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.435 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.213 - mfu/actor:0.309 - actor/lr:0.000 - critic/score/mean:0.288 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.288 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.026 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.026 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1188.532 - response_length/max:8192.000 - response_length/min:185.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1188.532 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.288 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:234.266 - prompt_length/max:397.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.104 - timing_s/old_log_prob:7.075 - timing_s/adv:14.024 - timing_s/update_actor:22.735 - timing_s/step:231.209 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.159 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 27x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:37 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:4.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:4.000 - batch/bef_solved:0.302 - batch/bef_failed:0.698 - batch/on_solved:0.302 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:33558.000 - global_seqlen/max:48103.000 - global_seqlen/minmax_diff:14545.000 - global_seqlen/balanced_min:39834.000 - global_seqlen/balanced_max:39935.000 - global_seqlen/mean:39889.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.056 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.801 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.999 - actor/pg_loss:0.136 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.224 - mfu/actor:0.313 - actor/lr:0.000 - actor/sft_entropy_loss:0.649 - actor/sft_loss:0.654 - actor/sft_grad_norm:0.125 - mfu/sft_actor:0.798 - actor/sft_lr:0.000 - critic/score/mean:0.302 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.302 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.034 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.034 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1264.160 - response_length/max:8192.000 - response_length/min:199.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1264.160 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.302 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.023 - prompt_length/max:411.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.612 - timing_s/old_log_prob:7.599 - timing_s/adv:16.440 - timing_s/update_actor:23.794 - timing_s/sft_update_actor:10.489 - timing_s/step:244.668 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.150 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=254527)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:09:03,686:Error comparing (-6 <= x) & (x < 10) and x >= 6
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'GreaterThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:38 - batch/bef_solve_none:56.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:14.000 - batch/solve_none:56.000 - batch/solve_none_format:0.000 - batch/solve_all:14.000 - batch/bef_solved:0.289 - batch/bef_failed:0.711 - batch/on_solved:0.289 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:62733.000 - global_seqlen/max:115517.000 - global_seqlen/minmax_diff:52784.000 - global_seqlen/balanced_min:93328.000 - global_seqlen/balanced_max:93329.000 - global_seqlen/mean:93328.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.026 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.805 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.883 - actor/pg_loss:0.066 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.195 - mfu/actor:0.311 - actor/lr:0.000 - critic/score/mean:0.289 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.289 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.020 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1214.041 - response_length/max:8192.000 - response_length/min:193.000 - response_length/clip_ratio:0.007 - on_off_metrics/on_response_length_mean:1214.041 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.289 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.219 - prompt_length/max:387.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:196.040 - timing_s/old_log_prob:6.738 - timing_s/adv:13.729 - timing_s/update_actor:23.130 - timing_s/step:233.231 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.158 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:13:02,563:Error comparing (-2022 < a_1) & (a_1 < -2021) and a < -2110
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:39 - batch/bef_solve_none:53.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:5.000 - batch/solve_none:53.000 - batch/solve_none_format:0.000 - batch/solve_all:5.000 - batch/bef_solved:0.274 - batch/bef_failed:0.726 - batch/on_solved:0.274 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31815.000 - global_seqlen/max:48156.000 - global_seqlen/minmax_diff:16341.000 - global_seqlen/balanced_min:41169.000 - global_seqlen/balanced_max:41246.000 - global_seqlen/mean:41202.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.120 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.834 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.747 - actor/pg_loss:0.309 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.222 - mfu/actor:0.337 - actor/lr:0.000 - actor/sft_entropy_loss:0.778 - actor/sft_loss:0.769 - actor/sft_grad_norm:0.121 - mfu/sft_actor:0.973 - actor/sft_lr:0.000 - critic/score/mean:0.274 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.274 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.037 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.037 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1283.975 - response_length/max:8192.000 - response_length/min:317.000 - response_length/clip_ratio:0.011 - on_off_metrics/on_response_length_mean:1283.975 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.274 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.047 - prompt_length/max:395.000 - prompt_length/min:170.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:196.644 - timing_s/old_log_prob:7.828 - timing_s/adv:15.424 - timing_s/update_actor:22.419 - timing_s/sft_update_actor:9.054 - timing_s/step:243.851 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.150 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:17:10,314:Error during parsing
[36m(main_task pid=254128)[0m ValueError: Error from parse_expr with transformed code: 'Ôºê'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=254128)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=254128)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=254128)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=254128)[0m     expr = eval(
[36m(main_task pid=254128)[0m   File "<string>", line 1
[36m(main_task pid=254128)[0m     Ôºê
[36m(main_task pid=254128)[0m     ^
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºê' (U+FF10)
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=254128)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=254128)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=254128)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=254128)[0m     number = Number(number_str)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=254128)[0m     val = sympify(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=254128)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=254128)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse 'Ôºê'' failed, because of exception being raised:
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºê' (U+FF10) (<string>, line 1)
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m Saving best checkpoint with score 0.2957970960145099 at ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Saving actor checkpoint to ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(main_task pid=254128)[0m step:40 - batch/bef_solve_none:35.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:8.000 - batch/solve_none:35.000 - batch/solve_none_format:0.000 - batch/solve_all:8.000 - batch/bef_solved:0.329 - batch/bef_failed:0.671 - batch/on_solved:0.329 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:74645.000 - global_seqlen/max:108600.000 - global_seqlen/minmax_diff:33955.000 - global_seqlen/balanced_min:90148.000 - global_seqlen/balanced_max:90149.000 - global_seqlen/mean:90148.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.109 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.878 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.306 - actor/pg_loss:0.246 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.223 - mfu/actor:0.308 - actor/lr:0.000 - val/test_score/minerva:0.217 - val/test_score/amc:0.313 - val/test_score/aime:0.058 - val/test_score/math:0.626 - val/test_score/olympiad_bench:0.264 - avg_score:0.296 - critic/score/mean:0.329 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.329 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.032 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1167.830 - response_length/max:8192.000 - response_length/min:220.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1167.830 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.329 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.734 - prompt_length/max:503.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:203.234 - timing_s/old_log_prob:6.646 - timing_s/adv:12.797 - timing_s/update_actor:22.500 - timing_s/testing:247.408 - timing_s/step:519.115 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.170 - timing_per_token_ms/adv:0.009
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:25:39,419:Error comparing (0 < x_0) & (x_0 < 2/a) and Abs(x_0 - 1*1/a) < epsilon
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:25:43,306:Error comparing 150 and binomial(2*m, 14 - m)*binomial(3*m, 5*m - 11)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 707, in simplify
[36m(main_task pid=254128)[0m     expr = combsimp(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/combsimp.py", line 53, in combsimp
[36m(main_task pid=254128)[0m     return gammasimp(expr);
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 81, in gammasimp
[36m(main_task pid=254128)[0m     return _gammasimp(expr, as_comb=False)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 457, in _gammasimp
[36m(main_task pid=254128)[0m     expr = rule_gamma(was)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 159, in rule_gamma
[36m(main_task pid=254128)[0m     ni, dd = Add(*[
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 160, in <listcomp>
[36m(main_task pid=254128)[0m     rule_gamma(gamma_rat(a/dd), level + 1) for a in ni.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 178, in rule_gamma
[36m(main_task pid=254128)[0m     expr = rule_gamma(expr, 4)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 429, in rule_gamma
[36m(main_task pid=254128)[0m     y = find_fuzzy(numer, g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 394, in find_fuzzy
[36m(main_task pid=254128)[0m     a = len(cancel(x/y).free_symbols)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7155, in cancel
[36m(main_task pid=254128)[0m     f = signsimp(f)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 406, in signsimp
[36m(main_task pid=254128)[0m     e = sub_post(sub_pre(e))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/cse_opts.py", line 14, in sub_pre
[36m(main_task pid=254128)[0m     adds = [a for a in e.atoms(Add) if a.could_extract_minus_sign()]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/cse_opts.py", line 14, in <listcomp>
[36m(main_task pid=254128)[0m     adds = [a for a in e.atoms(Add) if a.could_extract_minus_sign()]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 412, in could_extract_minus_sign
[36m(main_task pid=254128)[0m     return _could_extract_minus_sign(self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 20, in _could_extract_minus_sign
[36m(main_task pid=254128)[0m     negative_args = sum(1 for i in expr.args
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 21, in <genexpr>
[36m(main_task pid=254128)[0m     if i.could_extract_minus_sign())
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 176, in could_extract_minus_sign
[36m(main_task pid=254128)[0m     if self == (-self):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 469, in __eq__
[36m(main_task pid=254128)[0m     def __eq__(self, other):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:41 - batch/bef_solve_none:51.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:8.000 - batch/solve_none:51.000 - batch/solve_none_format:0.000 - batch/solve_all:8.000 - batch/bef_solved:0.260 - batch/bef_failed:0.740 - batch/on_solved:0.260 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:76566.000 - global_seqlen/max:115448.000 - global_seqlen/minmax_diff:38882.000 - global_seqlen/balanced_min:94349.000 - global_seqlen/balanced_max:94349.000 - global_seqlen/mean:94349.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.042 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.877 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.298 - actor/pg_loss:0.116 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.202 - mfu/actor:0.309 - actor/lr:0.000 - critic/score/mean:0.260 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.260 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.015 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1231.070 - response_length/max:8192.000 - response_length/min:240.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1231.070 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.260 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.133 - prompt_length/max:440.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.446 - timing_s/old_log_prob:6.451 - timing_s/adv:18.089 - timing_s/update_actor:23.657 - timing_s/step:234.517 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.153 - timing_per_token_ms/adv:0.012
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:42 - batch/bef_solve_none:55.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:6.000 - batch/solve_none:55.000 - batch/solve_none_format:0.000 - batch/solve_all:6.000 - batch/bef_solved:0.245 - batch/bef_failed:0.755 - batch/on_solved:0.245 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32674.000 - global_seqlen/max:49170.000 - global_seqlen/minmax_diff:16496.000 - global_seqlen/balanced_min:40073.000 - global_seqlen/balanced_max:40094.000 - global_seqlen/mean:40081.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.052 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.901 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.216 - actor/pg_loss:0.131 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.209 - mfu/actor:0.358 - actor/lr:0.000 - actor/sft_entropy_loss:0.604 - actor/sft_loss:0.613 - actor/sft_grad_norm:0.113 - mfu/sft_actor:1.057 - actor/sft_lr:0.000 - critic/score/mean:0.245 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.245 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.021 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.021 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1333.172 - response_length/max:8192.000 - response_length/min:268.000 - response_length/clip_ratio:0.008 - on_off_metrics/on_response_length_mean:1333.172 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.245 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.742 - prompt_length/max:477.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.714 - timing_s/old_log_prob:7.261 - timing_s/adv:14.623 - timing_s/update_actor:21.977 - timing_s/sft_update_actor:8.751 - timing_s/step:238.380 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.141 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254532)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254531)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:43 - batch/bef_solve_none:59.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:59.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.283 - batch/bef_failed:0.717 - batch/on_solved:0.283 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:77021.000 - global_seqlen/max:127098.000 - global_seqlen/minmax_diff:50077.000 - global_seqlen/balanced_min:94797.000 - global_seqlen/balanced_max:94798.000 - global_seqlen/mean:94797.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.015 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.802 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.922 - actor/pg_loss:-0.041 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.217 - mfu/actor:0.312 - actor/lr:0.000 - critic/score/mean:0.283 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.283 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.025 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.025 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1243.993 - response_length/max:8192.000 - response_length/min:203.000 - response_length/clip_ratio:0.008 - on_off_metrics/on_response_length_mean:1243.993 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.283 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.219 - prompt_length/max:425.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.715 - timing_s/old_log_prob:6.794 - timing_s/adv:12.468 - timing_s/update_actor:23.330 - timing_s/step:228.837 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.151 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:44 - batch/bef_solve_none:52.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:52.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.286 - batch/bef_failed:0.714 - batch/on_solved:0.286 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:80806.000 - global_seqlen/max:123012.000 - global_seqlen/minmax_diff:42206.000 - global_seqlen/balanced_min:98188.000 - global_seqlen/balanced_max:98586.000 - global_seqlen/mean:98214.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.060 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.890 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.255 - actor/pg_loss:0.140 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.223 - mfu/actor:0.347 - actor/lr:0.000 - critic/score/mean:0.286 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.286 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.024 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.024 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1292.323 - response_length/max:8192.000 - response_length/min:265.000 - response_length/clip_ratio:0.014 - on_off_metrics/on_response_length_mean:1292.323 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.286 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.281 - prompt_length/max:544.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.266 - timing_s/old_log_prob:7.206 - timing_s/adv:14.844 - timing_s/update_actor:21.994 - timing_s/step:235.414 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.150 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:45 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.326 - batch/bef_failed:0.674 - batch/on_solved:0.326 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32765.000 - global_seqlen/max:47253.000 - global_seqlen/minmax_diff:14488.000 - global_seqlen/balanced_min:40573.000 - global_seqlen/balanced_max:40658.000 - global_seqlen/mean:40612.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.015 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.903 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.232 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.209 - mfu/actor:0.320 - actor/lr:0.000 - actor/sft_entropy_loss:0.538 - actor/sft_loss:0.566 - actor/sft_grad_norm:0.111 - mfu/sft_actor:0.786 - actor/sft_lr:0.000 - critic/score/mean:0.326 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.326 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.023 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1317.537 - response_length/max:8192.000 - response_length/min:160.000 - response_length/clip_ratio:0.011 - on_off_metrics/on_response_length_mean:1317.537 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.326 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:249.656 - prompt_length/max:728.000 - prompt_length/min:171.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:200.291 - timing_s/old_log_prob:6.501 - timing_s/adv:13.456 - timing_s/update_actor:24.288 - timing_s/sft_update_actor:11.062 - timing_s/step:249.431 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.148 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:45:38,679:Error comparing (pi/4 <= x) & (x <= (7*pi)/4) and {pi/4, (5*pi)/4}
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=254128)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=254128)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=254128)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=254128)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=254128)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1737, in reduce
[36m(main_task pid=254128)[0m     result = B._complement(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2025, in _complement
[36m(main_task pid=254128)[0m     return Set._complement(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 219, in _complement
[36m(main_task pid=254128)[0m     return Intersection(other, self.complement(S.Reals))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in simplify_intersection
[36m(main_task pid=254128)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2621, in <genexpr>
[36m(main_task pid=254128)[0m     return Union(*(Intersection(arg, other) for arg in s.args))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=254128)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 430, in _
[36m(main_task pid=254128)[0m     if a.start <= b.end and b.start <= a.end:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=254128)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=254128)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:45:39,130:Error comparing (pi/4 <= x) & (x <= (7*pi)/4) and Union(Interval(pi/4, (3*pi)/4), Interval((5*pi)/4, (7*pi)/4))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 573, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_sets(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 351, in sympy_compare_sets
[36m(main_task pid=254128)[0m     if isinstance(a_set, Set) and isinstance(b_set, Set) and a_set.symmetric_difference(b_set).is_empty:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 259, in symmetric_difference
[36m(main_task pid=254128)[0m     return SymmetricDifference(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2183, in __new__
[36m(main_task pid=254128)[0m     return SymmetricDifference.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2189, in reduce
[36m(main_task pid=254128)[0m     result = B._symmetric_difference(A)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 262, in _symmetric_difference
[36m(main_task pid=254128)[0m     return Union(Complement(self, other), Complement(other, self))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1721, in __new__
[36m(main_task pid=254128)[0m     return Complement.reduce(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1731, in reduce
[36m(main_task pid=254128)[0m     if B == S.UniversalSet or A.is_subset(B):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1434, in is_subset
[36m(main_task pid=254128)[0m     return fuzzy_and(s.is_subset(other) for s in self.args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/logic.py", line 142, in fuzzy_and
[36m(main_task pid=254128)[0m     for ai in args:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1434, in <genexpr>
[36m(main_task pid=254128)[0m     return fuzzy_and(s.is_subset(other) for s in self.args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 430, in is_subset
[36m(main_task pid=254128)[0m     if self.intersect(other) == self:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 150, in intersect
[36m(main_task pid=254128)[0m     return Intersection(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 1507, in __new__
[36m(main_task pid=254128)[0m     return simplify_intersection(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/sets.py", line 2644, in simplify_intersection
[36m(main_task pid=254128)[0m     new_set = intersection_sets(s, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/multipledispatch/dispatcher.py", line 243, in __call__
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/sets/handlers/intersection.py", line 432, in _
[36m(main_task pid=254128)[0m     if a.start < b.start:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/relational.py", line 516, in __bool__
[36m(main_task pid=254128)[0m     raise TypeError("cannot determine truth value of Relational")
[36m(main_task pid=254128)[0m TypeError: cannot determine truth value of Relational
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:45:42,564:Error comparing 1980 and E*E*E*E*A*a*a*a*a*a*a*a*a*a*b*c*c*da*de*f*g*g*h*h*i*i*i*i*i*l*l*l*m*m*m*m*n*n*n*n*n*n*o*o*p*p*q*r*r*s*s*s*t*t*t*t*t*u*u*u*v*y*y*factorial(p)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 707, in simplify
[36m(main_task pid=254128)[0m     expr = combsimp(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/combsimp.py", line 53, in combsimp
[36m(main_task pid=254128)[0m     return gammasimp(expr);
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 79, in gammasimp
[36m(main_task pid=254128)[0m     return _gammasimp(d, as_comb=False).xreplace(dict(zip(dum, simp)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 455, in _gammasimp
[36m(main_task pid=254128)[0m     was = factor(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6577, in factor
[36m(main_task pid=254128)[0m     return _generic_factor(f, gens, args, method='factor')
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6258, in _generic_factor
[36m(main_task pid=254128)[0m     return _symbolic_factor(sympify(expr), opt, method)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6198, in _symbolic_factor
[36m(main_task pid=254128)[0m     coeff, factors = _symbolic_factor_list(together(expr, fraction=opt['fraction']), opt, method)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 6163, in _symbolic_factor_list
[36m(main_task pid=254128)[0m     _coeff, _factors = func()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 3378, in factor_list
[36m(main_task pid=254128)[0m     coeff, factors = f.rep.factor_list()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyclasses.py", line 1637, in factor_list
[36m(main_task pid=254128)[0m     coeff, factors = dmp_factor_list(f._rep, f.lev, f.dom)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1569, in dmp_factor_list
[36m(main_task pid=254128)[0m     coeff, factors = dmp_zz_factor(f, v, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1189, in dmp_zz_factor
[36m(main_task pid=254128)[0m     H = dmp_zz_wang(g, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 1066, in dmp_zz_wang
[36m(main_task pid=254128)[0m     cs, s, E = dmp_zz_wang_test_points(f, T, ct, A, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/factortools.py", line 745, in dmp_zz_wang_test_points
[36m(main_task pid=254128)[0m     if not dmp_eval_tail(dmp_LC(f, K), A, u - 1, K):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 388, in dmp_eval_tail
[36m(main_task pid=254128)[0m     e = _rec_eval_tail(f, 0, A, u, K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in _rec_eval_tail
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 356, in <listcomp>
[36m(main_task pid=254128)[0m     h = [ _rec_eval_tail(c, i + 1, A, u, K) for c in g ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 361, in _rec_eval_tail
[36m(main_task pid=254128)[0m     return dup_eval(h, A[-u + i - 1], K)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/densetools.py", line 283, in dup_eval
[36m(main_task pid=254128)[0m     result += c
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:46 - batch/bef_solve_none:55.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:6.000 - batch/solve_none:55.000 - batch/solve_none_format:0.000 - batch/solve_all:6.000 - batch/bef_solved:0.256 - batch/bef_failed:0.744 - batch/on_solved:0.256 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:81486.000 - global_seqlen/max:127010.000 - global_seqlen/minmax_diff:45524.000 - global_seqlen/balanced_min:100343.000 - global_seqlen/balanced_max:100344.000 - global_seqlen/mean:100343.375 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.072 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.819 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.746 - actor/pg_loss:0.246 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.199 - mfu/actor:0.305 - actor/lr:0.000 - critic/score/mean:0.256 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.256 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.029 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1324.646 - response_length/max:8192.000 - response_length/min:284.000 - response_length/clip_ratio:0.011 - on_off_metrics/on_response_length_mean:1324.646 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.256 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.219 - prompt_length/max:404.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.605 - timing_s/old_log_prob:6.878 - timing_s/adv:17.900 - timing_s/update_actor:25.413 - timing_s/step:241.227 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.146 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:49:37,052:Error comparing Eq(16*(x - 1)**2 + (y + 1/2)**2, 4) & Eq((x - 2)**2 + (y + 3)**2, 16*(x - 1)**2 + (y + 1/2)**2) and Eq((x - 1)**2 + (y + 1/2)**2, 4)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'Equality' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:49:37,119:Error comparing Eq(16*(x - 1)**2 + (y + 1/2)**2, 4) & Eq((x - 2)**2 + (y + 3)**2, 16*(x - 1)**2 + (y + 1/2)**2) and Eq((x - 1)**2 + (y + 1/2)**2, 5)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'Equality' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:49:37,124:Error comparing Eq(16*(x - 1)**2 + (y + 1/2)**2, 4) & Eq((x - 2)**2 + (y + 3)**2, 16*(x - 1)**2 + (y + 1/2)**2) and Eq((x - 1)**2 + (y + 1/2)**2, 4)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'Equality' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:49:37,129:Error comparing Eq(16*(x - 1)**2 + (y + 1/2)**2, 4) & Eq((x - 2)**2 + (y + 3)**2, 16*(x - 1)**2 + (y + 1/2)**2) and Eq((x - 1)**2 + (y + 1/2)**2, 4)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'Equality' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:49:37,134:Error comparing Eq(16*(x - 1)**2 + (y + 1/2)**2, 4) & Eq((x - 2)**2 + (y + 3)**2, 16*(x - 1)**2 + (y + 1/2)**2) and Eq((x - 1)**2 + (y + 1/2)**2, 4)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'Equality' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:49:37,143:Error comparing Eq(16*(x - 1)**2 + (y + 1/2)**2, 4) & Eq((x - 2)**2 + (y + 3)**2, 16*(x - 1)**2 + (y + 1/2)**2) and Eq((x - 1)**2 + (y + 1/2)**2, 3)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'Equality' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:49:39,408:Error comparing (c < b) & (b*tan(w/2) <= c) and b*tan(w/2) <= c
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'LessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:49:39,425:Error comparing (c < b) & (b*tan(w/2) <= c) and b*tan(w/2) <= c
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'LessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 12:49:43,912:Error comparing 3439 and Sum((10 - k)**(9999 - k)*binomial(9999, k), (k, 0, 9999))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 139, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return safe_sympy_doit(a) == safe_sympy_doit(b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 80, in safe_sympy_doit
[36m(main_task pid=254128)[0m     return a.doit()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 226, in doit
[36m(main_task pid=254128)[0m     did = self.xreplace(reps).doit(**hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 252, in doit
[36m(main_task pid=254128)[0m     newf = eval_sum(f, (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1048, in eval_sum
[36m(main_task pid=254128)[0m     value = eval_sum_symbolic(f.expand(), (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1227, in eval_sum_symbolic
[36m(main_task pid=254128)[0m     r = gosper_sum(f, (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/gosper.py", line 211, in gosper_sum
[36m(main_task pid=254128)[0m     g = gosper_term(f, k)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/gosper.py", line 110, in gosper_term
[36m(main_task pid=254128)[0m     r = hypersimp(f, n)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 318, in hypersimp
[36m(main_task pid=254128)[0m     g = expand_func(g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/function.py", line 2931, in expand_func
[36m(main_task pid=254128)[0m     return sympify(expr).expand(deep=deep, func=True, basic=False,
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3673, in expand
[36m(main_task pid=254128)[0m     expr, hit = Expr._expand_hint(expr, hint, deep=deep, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3604, in _expand_hint
[36m(main_task pid=254128)[0m     arg, arghit = Expr._expand_hint(arg, hint, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3604, in _expand_hint
[36m(main_task pid=254128)[0m     arg, arghit = Expr._expand_hint(arg, hint, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3612, in _expand_hint
[36m(main_task pid=254128)[0m     newexpr = getattr(expr, hint)(**hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/functions/special/gamma_functions.py", line 169, in _eval_expand_func
[36m(main_task pid=254128)[0m     return self.func(tail)*RisingFactorial(tail, coeff)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/function.py", line 466, in __new__
[36m(main_task pid=254128)[0m     result = super().__new__(cls, *args, **options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/function.py", line 307, in __new__
[36m(main_task pid=254128)[0m     evaluated = cls.eval(*args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/functions/combinatorial/factorials.py", line 597, in eval
[36m(main_task pid=254128)[0m     return reduce(lambda r, i: r*(x + i),
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/functions/combinatorial/factorials.py", line 597, in <lambda>
[36m(main_task pid=254128)[0m     return reduce(lambda r, i: r*(x + i),
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 106, in binary_op_wrapper
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 219, in __mul__
[36m(main_task pid=254128)[0m     return Mul(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 101, in __new__
[36m(main_task pid=254128)[0m     obj = cls._exec_constructor_postprocessors(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 2109, in _exec_constructor_postprocessors
[36m(main_task pid=254128)[0m     for k, v in chain.from_iterable(postprocessor_mappings):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 2104, in <genexpr>
[36m(main_task pid=254128)[0m     postprocessor_mappings = (
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:47 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.286 - batch/bef_failed:0.714 - batch/on_solved:0.286 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32078.000 - global_seqlen/max:53465.000 - global_seqlen/minmax_diff:21387.000 - global_seqlen/balanced_min:41045.000 - global_seqlen/balanced_max:41130.000 - global_seqlen/mean:41099.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.047 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.894 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.255 - actor/pg_loss:0.115 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.237 - mfu/actor:0.325 - actor/lr:0.000 - actor/sft_entropy_loss:0.576 - actor/sft_loss:0.590 - actor/sft_grad_norm:0.109 - mfu/sft_actor:0.739 - actor/sft_lr:0.000 - critic/score/mean:0.286 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.286 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.025 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.025 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1244.939 - response_length/max:8192.000 - response_length/min:220.000 - response_length/clip_ratio:0.004 - on_off_metrics/on_response_length_mean:1244.939 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.286 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:246.031 - prompt_length/max:730.000 - prompt_length/min:181.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.272 - timing_s/old_log_prob:6.362 - timing_s/adv:15.934 - timing_s/update_actor:22.344 - timing_s/sft_update_actor:11.124 - timing_s/step:242.995 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.152 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:48 - batch/bef_solve_none:49.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:49.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.299 - batch/bef_failed:0.701 - batch/on_solved:0.299 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:71030.000 - global_seqlen/max:125962.000 - global_seqlen/minmax_diff:54932.000 - global_seqlen/balanced_min:102851.000 - global_seqlen/balanced_max:102852.000 - global_seqlen/mean:102851.375 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.050 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.893 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.264 - actor/pg_loss:0.134 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.240 - mfu/actor:0.322 - actor/lr:0.000 - critic/score/mean:0.299 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.299 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.023 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1357.365 - response_length/max:8192.000 - response_length/min:250.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1357.365 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.299 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:249.688 - prompt_length/max:653.000 - prompt_length/min:183.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.519 - timing_s/old_log_prob:7.621 - timing_s/adv:14.878 - timing_s/update_actor:24.553 - timing_s/step:234.262 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:49 - batch/bef_solve_none:37.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:37.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.319 - batch/bef_failed:0.681 - batch/on_solved:0.319 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:75417.000 - global_seqlen/max:135199.000 - global_seqlen/minmax_diff:59782.000 - global_seqlen/balanced_min:99800.000 - global_seqlen/balanced_max:99801.000 - global_seqlen/mean:99800.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.036 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.883 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.313 - actor/pg_loss:0.096 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.228 - mfu/actor:0.331 - actor/lr:0.000 - critic/score/mean:0.319 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.319 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.029 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1323.512 - response_length/max:8192.000 - response_length/min:188.000 - response_length/clip_ratio:0.004 - on_off_metrics/on_response_length_mean:1323.512 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.319 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:235.875 - prompt_length/max:442.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.705 - timing_s/old_log_prob:7.465 - timing_s/adv:16.406 - timing_s/update_actor:23.270 - timing_s/step:234.697 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=254531)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 13:06:38,350:Error comparing c/x**2 - cos(2*x)/(2*x**2) and Eq(y, c/x**2 + exp(2/(x**2))*Integral(exp(-1*2/x**2)*sin(2*x), x))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 760, in simplify
[36m(main_task pid=254128)[0m     return done(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 585, in done
[36m(main_task pid=254128)[0m     rv = e.doit() if doit else e
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/integrals.py", line 619, in doit
[36m(main_task pid=254128)[0m     antideriv = self._eval_integral(
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/integrals.py", line 1091, in _eval_integral
[36m(main_task pid=254128)[0m     h = heurisch_wrapper(g, x, hints=[])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 144, in heurisch_wrapper
[36m(main_task pid=254128)[0m     res = heurisch(f, x, rewrite, hints, mappings, retries, degree_offset,
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 776, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, mappings=mappings, rewrite=rewrite, hints=hints, retries=retries - 1, unnecessary_permutations=unnecessary_permutations)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 776, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, mappings=mappings, rewrite=rewrite, hints=hints, retries=retries - 1, unnecessary_permutations=unnecessary_permutations)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 776, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, mappings=mappings, rewrite=rewrite, hints=hints, retries=retries - 1, unnecessary_permutations=unnecessary_permutations)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 762, in heurisch
[36m(main_task pid=254128)[0m     solution = _integrate()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 740, in _integrate
[36m(main_task pid=254128)[0m     numer = ring.from_expr(raw_numer)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 397, in from_expr
[36m(main_task pid=254128)[0m     poly = self._rebuild_expr(expr, mapping)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 391, in _rebuild_expr
[36m(main_task pid=254128)[0m     return _rebuild(sympify(expr))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 379, in _rebuild
[36m(main_task pid=254128)[0m     return reduce(add, list(map(_rebuild, expr.args)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 381, in _rebuild
[36m(main_task pid=254128)[0m     return reduce(mul, list(map(_rebuild, expr.args)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 379, in _rebuild
[36m(main_task pid=254128)[0m     return reduce(add, list(map(_rebuild, expr.args)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 381, in _rebuild
[36m(main_task pid=254128)[0m     return reduce(mul, list(map(_rebuild, expr.args)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 1118, in __mul__
[36m(main_task pid=254128)[0m     p[exp] = get(exp, zero) + v1*v2
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 957, in __add__
[36m(main_task pid=254128)[0m     v = get(k, zero) + v
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/external/pythonmpq.py", line 229, in __add__
[36m(main_task pid=254128)[0m     return self._new(p, q)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/external/pythonmpq.py", line 103, in _new
[36m(main_task pid=254128)[0m     @classmethod
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(main_task pid=254128)[0m Saving best checkpoint with score 0.29863196318180685 at ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Saving actor checkpoint to ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(main_task pid=254128)[0m step:50 - batch/bef_solve_none:59.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:59.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.255 - batch/bef_failed:0.745 - batch/on_solved:0.255 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:34615.000 - global_seqlen/max:44149.000 - global_seqlen/minmax_diff:9534.000 - global_seqlen/balanced_min:38937.000 - global_seqlen/balanced_max:39024.000 - global_seqlen/mean:38962.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.007 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.885 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.273 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.194 - mfu/actor:0.307 - actor/lr:0.000 - actor/sft_entropy_loss:0.649 - actor/sft_loss:0.638 - actor/sft_grad_norm:0.108 - mfu/sft_actor:0.764 - actor/sft_lr:0.000 - val/test_score/olympiad_bench:0.285 - val/test_score/math:0.658 - val/test_score/amc:0.286 - val/test_score/minerva:0.210 - val/test_score/aime:0.054 - avg_score:0.299 - critic/score/mean:0.255 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.255 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.014 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1319.668 - response_length/max:8192.000 - response_length/min:277.000 - response_length/clip_ratio:0.008 - on_off_metrics/on_response_length_mean:1319.668 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.255 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.836 - prompt_length/max:498.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.494 - timing_s/old_log_prob:6.649 - timing_s/adv:17.811 - timing_s/update_actor:24.999 - timing_s/sft_update_actor:11.320 - timing_s/testing:254.782 - timing_s/step:537.087 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.145 - timing_per_token_ms/adv:0.011
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:51 - batch/bef_solve_none:54.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:54.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.276 - batch/bef_failed:0.724 - batch/on_solved:0.276 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:75768.000 - global_seqlen/max:131371.000 - global_seqlen/minmax_diff:55603.000 - global_seqlen/balanced_min:103635.000 - global_seqlen/balanced_max:103636.000 - global_seqlen/mean:103635.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.045 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.821 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.664 - actor/pg_loss:0.123 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.204 - mfu/actor:0.346 - actor/lr:0.000 - critic/score/mean:0.276 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.276 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.014 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1367.354 - response_length/max:8192.000 - response_length/min:289.000 - response_length/clip_ratio:0.015 - on_off_metrics/on_response_length_mean:1367.354 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.276 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.945 - prompt_length/max:727.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.771 - timing_s/old_log_prob:7.136 - timing_s/adv:13.202 - timing_s/update_actor:23.527 - timing_s/step:229.810 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.138 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:52 - batch/bef_solve_none:39.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:39.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.331 - batch/bef_failed:0.669 - batch/on_solved:0.331 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:84040.000 - global_seqlen/max:123340.000 - global_seqlen/minmax_diff:39300.000 - global_seqlen/balanced_min:100288.000 - global_seqlen/balanced_max:100289.000 - global_seqlen/mean:100288.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.024 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.899 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.218 - actor/pg_loss:0.060 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.250 - mfu/actor:0.333 - actor/lr:0.000 - critic/score/mean:0.331 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.331 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.028 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.028 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1322.015 - response_length/max:8192.000 - response_length/min:195.000 - response_length/clip_ratio:0.010 - on_off_metrics/on_response_length_mean:1322.015 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.331 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.992 - prompt_length/max:514.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.763 - timing_s/old_log_prob:7.159 - timing_s/adv:14.653 - timing_s/update_actor:23.335 - timing_s/step:233.065 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:53 - batch/bef_solve_none:48.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:48.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.267 - batch/bef_failed:0.733 - batch/on_solved:0.267 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:33534.000 - global_seqlen/max:47834.000 - global_seqlen/minmax_diff:14300.000 - global_seqlen/balanced_min:42143.000 - global_seqlen/balanced_max:42213.000 - global_seqlen/mean:42168.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.035 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.885 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.290 - actor/pg_loss:0.083 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.216 - mfu/actor:0.354 - actor/lr:0.000 - actor/sft_entropy_loss:0.667 - actor/sft_loss:0.669 - actor/sft_grad_norm:0.110 - mfu/sft_actor:0.655 - actor/sft_lr:0.000 - critic/score/mean:0.267 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.267 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.020 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1239.672 - response_length/max:8192.000 - response_length/min:289.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1239.672 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.267 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.164 - prompt_length/max:448.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:202.149 - timing_s/old_log_prob:7.531 - timing_s/adv:14.287 - timing_s/update_actor:20.888 - timing_s/sft_update_actor:12.299 - timing_s/step:249.936 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.159 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 13:22:32,438:Error during parsing
[36m(main_task pid=254128)[0m ValueError: Error from parse_expr with transformed code: 'Ôºô'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=254128)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=254128)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=254128)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=254128)[0m     expr = eval(
[36m(main_task pid=254128)[0m   File "<string>", line 1
[36m(main_task pid=254128)[0m     Ôºô
[36m(main_task pid=254128)[0m     ^
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºô' (U+FF19)
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=254128)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=254128)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=254128)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=254128)[0m     number = Number(number_str)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=254128)[0m     val = sympify(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=254128)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=254128)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse 'Ôºô'' failed, because of exception being raised:
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºô' (U+FF19) (<string>, line 1)
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:54 - batch/bef_solve_none:48.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:48.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.290 - batch/bef_failed:0.710 - batch/on_solved:0.290 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:69475.000 - global_seqlen/max:121093.000 - global_seqlen/minmax_diff:51618.000 - global_seqlen/balanced_min:96953.000 - global_seqlen/balanced_max:96954.000 - global_seqlen/mean:96953.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.037 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.878 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.301 - actor/pg_loss:0.106 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.238 - mfu/actor:0.316 - actor/lr:0.000 - critic/score/mean:0.290 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.290 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.033 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.033 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1278.757 - response_length/max:8192.000 - response_length/min:273.000 - response_length/clip_ratio:0.013 - on_off_metrics/on_response_length_mean:1278.757 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.290 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.148 - prompt_length/max:393.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.235 - timing_s/old_log_prob:6.990 - timing_s/adv:12.394 - timing_s/update_actor:24.908 - timing_s/step:230.896 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.148 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:55 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.358 - batch/bef_failed:0.642 - batch/on_solved:0.358 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32643.000 - global_seqlen/max:45964.000 - global_seqlen/minmax_diff:13321.000 - global_seqlen/balanced_min:40107.000 - global_seqlen/balanced_max:40160.000 - global_seqlen/mean:40136.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.016 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.889 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.300 - actor/pg_loss:0.044 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.223 - mfu/actor:0.354 - actor/lr:0.000 - actor/sft_entropy_loss:0.717 - actor/sft_loss:0.716 - actor/sft_grad_norm:0.107 - mfu/sft_actor:0.789 - actor/sft_lr:0.000 - critic/score/mean:0.358 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.358 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.015 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1251.088 - response_length/max:8192.000 - response_length/min:167.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1251.088 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.358 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.305 - prompt_length/max:645.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.694 - timing_s/old_log_prob:7.505 - timing_s/adv:13.176 - timing_s/update_actor:20.723 - timing_s/sft_update_actor:10.536 - timing_s/step:243.473 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.155 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254527)[0m 
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:56 - batch/bef_solve_none:42.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:14.000 - batch/solve_none:42.000 - batch/solve_none_format:0.000 - batch/solve_all:14.000 - batch/bef_solved:0.353 - batch/bef_failed:0.647 - batch/on_solved:0.353 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:86370.000 - global_seqlen/max:123288.000 - global_seqlen/minmax_diff:36918.000 - global_seqlen/balanced_min:102762.000 - global_seqlen/balanced_max:102763.000 - global_seqlen/mean:102762.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.018 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.833 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.703 - actor/pg_loss:0.045 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.229 - mfu/actor:0.349 - actor/lr:0.000 - critic/score/mean:0.353 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.353 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.029 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1362.237 - response_length/max:8192.000 - response_length/min:167.000 - response_length/clip_ratio:0.012 - on_off_metrics/on_response_length_mean:1362.237 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.353 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.430 - prompt_length/max:387.000 - prompt_length/min:170.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.138 - timing_s/old_log_prob:7.229 - timing_s/adv:12.447 - timing_s/update_actor:23.062 - timing_s/step:230.964 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:57 - batch/bef_solve_none:47.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:47.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.310 - batch/bef_failed:0.690 - batch/on_solved:0.310 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:71737.000 - global_seqlen/max:127530.000 - global_seqlen/minmax_diff:55793.000 - global_seqlen/balanced_min:98187.000 - global_seqlen/balanced_max:98188.000 - global_seqlen/mean:98187.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.002 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.896 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.237 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.257 - mfu/actor:0.348 - actor/lr:0.000 - critic/score/mean:0.310 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.310 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.034 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.034 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1287.427 - response_length/max:8192.000 - response_length/min:165.000 - response_length/clip_ratio:0.011 - on_off_metrics/on_response_length_mean:1287.427 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.310 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:246.758 - prompt_length/max:528.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.709 - timing_s/old_log_prob:7.381 - timing_s/adv:13.909 - timing_s/update_actor:21.932 - timing_s/step:231.857 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.148 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:58 - batch/bef_solve_none:54.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:54.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.310 - batch/bef_failed:0.690 - batch/on_solved:0.310 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:29598.000 - global_seqlen/max:49244.000 - global_seqlen/minmax_diff:19646.000 - global_seqlen/balanced_min:42026.000 - global_seqlen/balanced_max:42078.000 - global_seqlen/mean:42050.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.054 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.891 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.257 - actor/pg_loss:0.137 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.212 - mfu/actor:0.371 - actor/lr:0.000 - actor/sft_entropy_loss:0.644 - actor/sft_loss:0.646 - actor/sft_grad_norm:0.104 - mfu/sft_actor:0.725 - actor/sft_lr:0.000 - critic/score/mean:0.310 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.310 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.015 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1303.529 - response_length/max:8192.000 - response_length/min:253.000 - response_length/clip_ratio:0.004 - on_off_metrics/on_response_length_mean:1303.529 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.310 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.070 - prompt_length/max:404.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:191.069 - timing_s/old_log_prob:6.966 - timing_s/adv:15.529 - timing_s/update_actor:20.836 - timing_s/sft_update_actor:11.553 - timing_s/step:239.303 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254528)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 13:42:12,078:Error during parsing
[36m(main_task pid=254128)[0m ValueError: Error from parse_expr with transformed code: 'Ôºñ'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=254128)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=254128)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=254128)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=254128)[0m     expr = eval(
[36m(main_task pid=254128)[0m   File "<string>", line 1
[36m(main_task pid=254128)[0m     Ôºñ
[36m(main_task pid=254128)[0m     ^
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºñ' (U+FF16)
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=254128)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=254128)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=254128)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=254128)[0m     number = Number(number_str)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=254128)[0m     val = sympify(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=254128)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=254128)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse 'Ôºñ'' failed, because of exception being raised:
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºñ' (U+FF16) (<string>, line 1)
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:59 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.325 - batch/bef_failed:0.675 - batch/on_solved:0.325 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:79805.000 - global_seqlen/max:131411.000 - global_seqlen/minmax_diff:51606.000 - global_seqlen/balanced_min:99400.000 - global_seqlen/balanced_max:99401.000 - global_seqlen/mean:99400.500 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.071 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.878 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.286 - actor/pg_loss:0.224 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.244 - mfu/actor:0.296 - actor/lr:0.000 - critic/score/mean:0.325 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.325 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.027 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.027 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1312.820 - response_length/max:8192.000 - response_length/min:72.000 - response_length/clip_ratio:0.007 - on_off_metrics/on_response_length_mean:1312.820 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.325 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.312 - prompt_length/max:476.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.543 - timing_s/old_log_prob:7.497 - timing_s/adv:13.089 - timing_s/update_actor:25.682 - timing_s/step:232.641 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m Saving best checkpoint with score 0.3028825556223671 at ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Saving actor checkpoint to ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(main_task pid=254128)[0m step:60 - batch/bef_solve_none:49.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:6.000 - batch/solve_none:49.000 - batch/solve_none_format:0.000 - batch/solve_all:6.000 - batch/bef_solved:0.288 - batch/bef_failed:0.712 - batch/on_solved:0.288 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:79338.000 - global_seqlen/max:136895.000 - global_seqlen/minmax_diff:57557.000 - global_seqlen/balanced_min:105883.000 - global_seqlen/balanced_max:105883.000 - global_seqlen/mean:105883.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.037 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.834 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.838 - actor/pg_loss:0.098 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.230 - mfu/actor:0.353 - actor/lr:0.000 - val/test_score/math:0.628 - val/test_score/amc:0.328 - val/test_score/aime:0.071 - val/test_score/minerva:0.224 - val/test_score/olympiad_bench:0.263 - avg_score:0.303 - critic/score/mean:0.288 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.288 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.025 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.025 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1406.648 - response_length/max:8192.000 - response_length/min:237.000 - response_length/clip_ratio:0.014 - on_off_metrics/on_response_length_mean:1406.648 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.288 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:247.773 - prompt_length/max:531.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.939 - timing_s/old_log_prob:7.708 - timing_s/adv:17.675 - timing_s/update_actor:23.335 - timing_s/testing:253.757 - timing_s/step:522.353 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:61 - batch/bef_solve_none:50.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:8.000 - batch/solve_none:50.000 - batch/solve_none_format:0.000 - batch/solve_all:8.000 - batch/bef_solved:0.294 - batch/bef_failed:0.706 - batch/on_solved:0.294 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:30321.000 - global_seqlen/max:49935.000 - global_seqlen/minmax_diff:19614.000 - global_seqlen/balanced_min:40792.000 - global_seqlen/balanced_max:40853.000 - global_seqlen/mean:40832.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.048 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.887 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.293 - actor/pg_loss:0.127 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.229 - mfu/actor:0.336 - actor/lr:0.000 - actor/sft_entropy_loss:0.605 - actor/sft_loss:0.606 - actor/sft_grad_norm:0.104 - mfu/sft_actor:0.775 - actor/sft_lr:0.000 - critic/score/mean:0.294 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.294 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.012 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1375.944 - response_length/max:8192.000 - response_length/min:286.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1375.944 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.294 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:234.922 - prompt_length/max:385.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.406 - timing_s/old_log_prob:7.317 - timing_s/adv:13.250 - timing_s/update_actor:23.522 - timing_s/sft_update_actor:11.571 - timing_s/step:247.062 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.141 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254528)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 13:59:03,165:Error comparing (-x**3 + x**2 + 1)**1000 and 1
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'zero'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 644, in simplify
[36m(main_task pid=254128)[0m     _e = cancel(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7182, in cancel
[36m(main_task pid=254128)[0m     R, (F, G) = sring((p, q), *gens, **args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 163, in sring
[36m(main_task pid=254128)[0m     reps, opt = _parallel_dict_from_expr(exprs, opt)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 344, in _parallel_dict_from_expr
[36m(main_task pid=254128)[0m     exprs = [ expr.expand() for expr in exprs ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 344, in <listcomp>
[36m(main_task pid=254128)[0m     exprs = [ expr.expand() for expr in exprs ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3673, in expand
[36m(main_task pid=254128)[0m     expr, hit = Expr._expand_hint(expr, hint, deep=deep, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3604, in _expand_hint
[36m(main_task pid=254128)[0m     arg, arghit = Expr._expand_hint(arg, hint, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3612, in _expand_hint
[36m(main_task pid=254128)[0m     newexpr = getattr(expr, hint)(**hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 1104, in _eval_expand_multinomial
[36m(main_task pid=254128)[0m     return basic_from_dict(expansion_dict, *p)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 403, in expr_from_dict
[36m(main_task pid=254128)[0m     result.append(Mul(*term))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 511, in flatten
[36m(main_task pid=254128)[0m     if e.is_zero:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 502, in getit
[36m(main_task pid=254128)[0m     self._assumptions = self.default_assumptions.copy()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 482, in copy
[36m(main_task pid=254128)[0m     return self.__class__(self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 479, in __init__
[36m(main_task pid=254128)[0m     self.deduce_all_facts(facts)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/facts.py", line 627, in deduce_all_facts
[36m(main_task pid=254128)[0m     beta_maytrigger.update(beta_triggers[k, v])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 13:59:07,271:Error comparing (-x**3 + x**2 + 1)**1000 and 2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'zero'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 644, in simplify
[36m(main_task pid=254128)[0m     _e = cancel(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7182, in cancel
[36m(main_task pid=254128)[0m     R, (F, G) = sring((p, q), *gens, **args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 163, in sring
[36m(main_task pid=254128)[0m     reps, opt = _parallel_dict_from_expr(exprs, opt)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 344, in _parallel_dict_from_expr
[36m(main_task pid=254128)[0m     exprs = [ expr.expand() for expr in exprs ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 344, in <listcomp>
[36m(main_task pid=254128)[0m     exprs = [ expr.expand() for expr in exprs ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3673, in expand
[36m(main_task pid=254128)[0m     expr, hit = Expr._expand_hint(expr, hint, deep=deep, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3604, in _expand_hint
[36m(main_task pid=254128)[0m     arg, arghit = Expr._expand_hint(arg, hint, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3612, in _expand_hint
[36m(main_task pid=254128)[0m     newexpr = getattr(expr, hint)(**hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 1104, in _eval_expand_multinomial
[36m(main_task pid=254128)[0m     return basic_from_dict(expansion_dict, *p)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 403, in expr_from_dict
[36m(main_task pid=254128)[0m     result.append(Mul(*term))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 685, in flatten
[36m(main_task pid=254128)[0m     elif coeff.is_zero:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 503, in getit
[36m(main_task pid=254128)[0m     return _ask(fact, self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 566, in _ask
[36m(main_task pid=254128)[0m     assumptions.deduce_all_facts(((fact_i, fact_i_value),))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/facts.py", line 633, in deduce_all_facts
[36m(main_task pid=254128)[0m     if all(self.get(k) is v for k, v in bcond):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 13:59:10,279:Error comparing (-x**3 + x**2 + 1)**1000 and 1
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'zero'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 644, in simplify
[36m(main_task pid=254128)[0m     _e = cancel(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7182, in cancel
[36m(main_task pid=254128)[0m     R, (F, G) = sring((p, q), *gens, **args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 163, in sring
[36m(main_task pid=254128)[0m     reps, opt = _parallel_dict_from_expr(exprs, opt)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 344, in _parallel_dict_from_expr
[36m(main_task pid=254128)[0m     exprs = [ expr.expand() for expr in exprs ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 344, in <listcomp>
[36m(main_task pid=254128)[0m     exprs = [ expr.expand() for expr in exprs ]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3673, in expand
[36m(main_task pid=254128)[0m     expr, hit = Expr._expand_hint(expr, hint, deep=deep, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3604, in _expand_hint
[36m(main_task pid=254128)[0m     arg, arghit = Expr._expand_hint(arg, hint, **hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3612, in _expand_hint
[36m(main_task pid=254128)[0m     newexpr = getattr(expr, hint)(**hints)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 1104, in _eval_expand_multinomial
[36m(main_task pid=254128)[0m     return basic_from_dict(expansion_dict, *p)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 403, in expr_from_dict
[36m(main_task pid=254128)[0m     result.append(Mul(*term))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 685, in flatten
[36m(main_task pid=254128)[0m     elif coeff.is_zero:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 502, in getit
[36m(main_task pid=254128)[0m     self._assumptions = self.default_assumptions.copy()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 482, in copy
[36m(main_task pid=254128)[0m     return self.__class__(self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 479, in __init__
[36m(main_task pid=254128)[0m     self.deduce_all_facts(facts)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/facts.py", line 633, in deduce_all_facts
[36m(main_task pid=254128)[0m     if all(self.get(k) is v for k, v in bcond):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 13:59:17,985:Error comparing 9*pi**3 and Integral(sqrt(t**4*cos(t)**2 + 4*sin(t*(2 - t)**2)**2), (t, 0, 3*pi))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 143, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return (a - b).evalf(chop=True, n=numeric_precision) == 0  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1648, in evalf
[36m(main_task pid=254128)[0m     result = evalf(self, prec + 4, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 649, in evalf_mul
[36m(main_task pid=254128)[0m     result = evalf(arg, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1175, in evalf_integral
[36m(main_task pid=254128)[0m     result = do_integral(expr, workprec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1136, in do_integral
[36m(main_task pid=254128)[0m     result, quadrature_err = quadts(f, [xlow, xhigh], error=1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 789, in quadts
[36m(main_task pid=254128)[0m     return ctx.quad(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 746, in quad
[36m(main_task pid=254128)[0m     v, err = rule.summation(f, points[0], prec, epsilon, m, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 233, in summation
[36m(main_task pid=254128)[0m     result = self.sum_next(f, nodes, degree, prec, results, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 308, in sum_next
[36m(main_task pid=254128)[0m     S += self.ctx.fdot((w,f(x)) for (x,w) in nodes)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/ctx_mp_python.py", line 938, in fdot
[36m(main_task pid=254128)[0m     for a, b in A:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 308, in <genexpr>
[36m(main_task pid=254128)[0m     S += self.ctx.fdot((w,f(x)) for (x,w) in nodes)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1109, in f
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(func, mp.prec, {'subs': {x: t}})
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 808, in evalf_pow
[36m(main_task pid=254128)[0m     result = evalf(base, prec + 5, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 649, in evalf_mul
[36m(main_task pid=254128)[0m     result = evalf(arg, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 777, in evalf_pow
[36m(main_task pid=254128)[0m     result = evalf(base, prec + 5, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 913, in evalf_trig
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(arg, xprec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 697, in evalf_mul
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(arg, working_prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 777, in evalf_pow
[36m(main_task pid=254128)[0m     result = evalf(base, prec + 5, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 649, in evalf_mul
[36m(main_task pid=254128)[0m     result = evalf(arg, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1482, in evalf
[36m(main_task pid=254128)[0m     rf = evalf_table[type(x)]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 13:59:21,135:Error comparing 9*pi**3 and Integral(sqrt(sin(t*(2*t**4 + 12*t**3 + 4*t**2 + 4))**2), (t, 0, 3*pi))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 143, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return (a - b).evalf(chop=True, n=numeric_precision) == 0  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1648, in evalf
[36m(main_task pid=254128)[0m     result = evalf(self, prec + 4, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 649, in evalf_mul
[36m(main_task pid=254128)[0m     result = evalf(arg, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1175, in evalf_integral
[36m(main_task pid=254128)[0m     result = do_integral(expr, workprec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1136, in do_integral
[36m(main_task pid=254128)[0m     result, quadrature_err = quadts(f, [xlow, xhigh], error=1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 789, in quadts
[36m(main_task pid=254128)[0m     return ctx.quad(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 746, in quad
[36m(main_task pid=254128)[0m     v, err = rule.summation(f, points[0], prec, epsilon, m, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 233, in summation
[36m(main_task pid=254128)[0m     result = self.sum_next(f, nodes, degree, prec, results, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 308, in sum_next
[36m(main_task pid=254128)[0m     S += self.ctx.fdot((w,f(x)) for (x,w) in nodes)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/ctx_mp_python.py", line 938, in fdot
[36m(main_task pid=254128)[0m     for a, b in A:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 308, in <genexpr>
[36m(main_task pid=254128)[0m     S += self.ctx.fdot((w,f(x)) for (x,w) in nodes)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1119, in f
[36m(main_task pid=254128)[0m     return mpf(re or fzero)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/ctx_mp_python.py", line 52, in __new__
[36m(main_task pid=254128)[0m     if kwargs:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:62 - batch/bef_solve_none:52.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:52.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.299 - batch/bef_failed:0.701 - batch/on_solved:0.299 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:76117.000 - global_seqlen/max:133579.000 - global_seqlen/minmax_diff:57462.000 - global_seqlen/balanced_min:102864.000 - global_seqlen/balanced_max:102865.000 - global_seqlen/mean:102864.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.028 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.854 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.370 - actor/pg_loss:0.070 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.247 - mfu/actor:0.318 - actor/lr:0.000 - critic/score/mean:0.299 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.299 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.027 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.027 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1363.167 - response_length/max:8192.000 - response_length/min:282.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1363.167 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.299 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.094 - prompt_length/max:510.000 - prompt_length/min:171.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.447 - timing_s/old_log_prob:7.188 - timing_s/adv:34.503 - timing_s/update_actor:25.024 - timing_s/step:255.259 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/adv:0.021
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:03:35,725:Error comparing 24.2550000000000 and (-1 + 2**50)/(2**1275)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 137, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return a.round(float_rounding) == b.round(float_rounding)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3856, in round
[36m(main_task pid=254128)[0m     digits_to_decimal = _mag(x)  # _mag(12) = 2, _mag(.012) = -1
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 4039, in _mag
[36m(main_task pid=254128)[0m     if (xpos/10**mag_first_dig) >= 1:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 65, in __sympifyit_wrapper
[36m(main_task pid=254128)[0m     return func(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 1042, in __truediv__
[36m(main_task pid=254128)[0m     return Float._new(mlib.mpf_div(self._mpf_, rhs, prec, rnd), prec)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libmpf.py", line 960, in mpf_div
[36m(main_task pid=254128)[0m     raise ZeroDivisionError
[36m(main_task pid=254128)[0m ZeroDivisionError
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:63 - batch/bef_solve_none:49.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:13.000 - batch/solve_none:49.000 - batch/solve_none_format:0.000 - batch/solve_all:13.000 - batch/bef_solved:0.324 - batch/bef_failed:0.676 - batch/on_solved:0.324 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:34472.000 - global_seqlen/max:45435.000 - global_seqlen/minmax_diff:10963.000 - global_seqlen/balanced_min:40282.000 - global_seqlen/balanced_max:40337.000 - global_seqlen/mean:40310.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.028 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.903 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.225 - actor/pg_loss:0.078 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.223 - mfu/actor:0.332 - actor/lr:0.000 - actor/sft_entropy_loss:0.686 - actor/sft_loss:0.669 - actor/sft_grad_norm:0.102 - mfu/sft_actor:0.843 - actor/sft_lr:0.000 - critic/score/mean:0.324 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.324 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.012 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1326.650 - response_length/max:8192.000 - response_length/min:203.000 - response_length/clip_ratio:0.017 - on_off_metrics/on_response_length_mean:1326.650 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.324 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.250 - prompt_length/max:500.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:208.361 - timing_s/old_log_prob:7.268 - timing_s/adv:15.366 - timing_s/update_actor:23.823 - timing_s/sft_update_actor:10.540 - timing_s/step:258.468 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.153 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m 
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:64 - batch/bef_solve_none:43.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:43.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.347 - batch/bef_failed:0.653 - batch/on_solved:0.347 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:68397.000 - global_seqlen/max:123014.000 - global_seqlen/minmax_diff:54617.000 - global_seqlen/balanced_min:97881.000 - global_seqlen/balanced_max:98969.000 - global_seqlen/mean:98352.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.001 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.798 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.942 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.234 - mfu/actor:0.355 - actor/lr:0.000 - critic/score/mean:0.347 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.347 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.017 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1284.646 - response_length/max:8192.000 - response_length/min:181.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1284.646 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.347 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:252.117 - prompt_length/max:682.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.656 - timing_s/old_log_prob:7.527 - timing_s/adv:13.104 - timing_s/update_actor:21.232 - timing_s/step:228.318 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.147 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:11:31,568:Error during parsing
[36m(main_task pid=254128)[0m ValueError: Error from parse_expr with transformed code: 'Ôºê'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=254128)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=254128)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=254128)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=254128)[0m     expr = eval(
[36m(main_task pid=254128)[0m   File "<string>", line 1
[36m(main_task pid=254128)[0m     Ôºê
[36m(main_task pid=254128)[0m     ^
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºê' (U+FF10)
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=254128)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=254128)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=254128)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=254128)[0m     number = Number(number_str)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=254128)[0m     val = sympify(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=254128)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=254128)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse 'Ôºê'' failed, because of exception being raised:
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºê' (U+FF10) (<string>, line 1)
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:65 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.311 - batch/bef_failed:0.689 - batch/on_solved:0.311 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:90084.000 - global_seqlen/max:135920.000 - global_seqlen/minmax_diff:45836.000 - global_seqlen/balanced_min:113919.000 - global_seqlen/balanced_max:113920.000 - global_seqlen/mean:113919.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.104 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.821 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.796 - actor/pg_loss:0.209 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.274 - mfu/actor:0.296 - actor/lr:0.000 - critic/score/mean:0.311 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.311 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.041 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.041 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1533.761 - response_length/max:8192.000 - response_length/min:304.000 - response_length/clip_ratio:0.023 - on_off_metrics/on_response_length_mean:1533.761 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.311 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:246.234 - prompt_length/max:505.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.301 - timing_s/old_log_prob:8.111 - timing_s/adv:13.815 - timing_s/update_actor:29.762 - timing_s/step:241.204 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.126 - timing_per_token_ms/adv:0.008
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:15:40,784:Error comparing zoo and 11/50
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:15:40,787:Error comparing zoo and 1/2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:15:40,790:Error comparing zoo and 1/2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:15:40,793:Error comparing zoo and 1/2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:15:40,796:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:15:40,801:Error comparing zoo and 10:44
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:15:40,806:Error comparing zoo and 9/58
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:15:40,815:Error comparing zoo and Eq(v_c/v_t, D/L)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:66 - batch/bef_solve_none:49.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:49.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.308 - batch/bef_failed:0.692 - batch/on_solved:0.308 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31735.000 - global_seqlen/max:47112.000 - global_seqlen/minmax_diff:15377.000 - global_seqlen/balanced_min:41249.000 - global_seqlen/balanced_max:41313.000 - global_seqlen/mean:41280.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.079 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.865 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.446 - actor/pg_loss:0.185 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.228 - mfu/actor:0.345 - actor/lr:0.000 - actor/sft_entropy_loss:0.545 - actor/sft_loss:0.557 - actor/sft_grad_norm:0.095 - mfu/sft_actor:1.068 - actor/sft_lr:0.000 - critic/score/mean:0.308 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.308 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.030 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1499.256 - response_length/max:8192.000 - response_length/min:329.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1499.256 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.308 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.734 - prompt_length/max:684.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:204.703 - timing_s/old_log_prob:7.890 - timing_s/adv:14.199 - timing_s/update_actor:24.977 - timing_s/sft_update_actor:9.405 - timing_s/step:253.577 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.133 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m 
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:67 - batch/bef_solve_none:43.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:43.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.327 - batch/bef_failed:0.673 - batch/on_solved:0.327 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:66472.000 - global_seqlen/max:149362.000 - global_seqlen/minmax_diff:82890.000 - global_seqlen/balanced_min:116179.000 - global_seqlen/balanced_max:116180.000 - global_seqlen/mean:116179.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.005 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.754 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.303 - actor/pg_loss:0.035 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.291 - mfu/actor:0.331 - actor/lr:0.000 - critic/score/mean:0.327 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.327 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.035 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.035 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1560.786 - response_length/max:8192.000 - response_length/min:214.000 - response_length/clip_ratio:0.020 - on_off_metrics/on_response_length_mean:1560.786 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.327 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:254.523 - prompt_length/max:767.000 - prompt_length/min:183.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:208.542 - timing_s/old_log_prob:8.412 - timing_s/adv:14.961 - timing_s/update_actor:27.044 - timing_s/step:250.866 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:68 - batch/bef_solve_none:34.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:13.000 - batch/solve_none:34.000 - batch/solve_none_format:0.000 - batch/solve_all:13.000 - batch/bef_solved:0.356 - batch/bef_failed:0.644 - batch/on_solved:0.356 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:76158.000 - global_seqlen/max:147180.000 - global_seqlen/minmax_diff:71022.000 - global_seqlen/balanced_min:108559.000 - global_seqlen/balanced_max:108560.000 - global_seqlen/mean:108559.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.059 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.817 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.829 - actor/pg_loss:0.143 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.268 - mfu/actor:0.328 - actor/lr:0.000 - critic/score/mean:0.356 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.356 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.044 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.044 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1455.621 - response_length/max:8192.000 - response_length/min:216.000 - response_length/clip_ratio:0.012 - on_off_metrics/on_response_length_mean:1455.621 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.356 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.625 - prompt_length/max:423.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.439 - timing_s/old_log_prob:8.073 - timing_s/adv:14.905 - timing_s/update_actor:25.720 - timing_s/step:238.379 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254527)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:69 - batch/bef_solve_none:40.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:40.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.358 - batch/bef_failed:0.642 - batch/on_solved:0.358 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32124.000 - global_seqlen/max:47786.000 - global_seqlen/minmax_diff:15662.000 - global_seqlen/balanced_min:41243.000 - global_seqlen/balanced_max:41373.000 - global_seqlen/mean:41314.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.016 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.861 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.386 - actor/pg_loss:-0.059 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.600 - mfu/actor:0.329 - actor/lr:0.000 - actor/sft_entropy_loss:0.605 - actor/sft_loss:0.601 - actor/sft_grad_norm:0.095 - mfu/sft_actor:0.837 - actor/sft_lr:0.000 - critic/score/mean:0.358 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.358 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.033 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.033 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1366.206 - response_length/max:8192.000 - response_length/min:298.000 - response_length/clip_ratio:0.007 - on_off_metrics/on_response_length_mean:1366.206 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.358 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.539 - prompt_length/max:501.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.960 - timing_s/old_log_prob:7.065 - timing_s/adv:13.314 - timing_s/update_actor:24.188 - timing_s/sft_update_actor:10.786 - timing_s/step:244.572 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 14:36:55,025:Error comparing (P_0**(2/5) - 1*2/5*g*z/K**(3/5))**(5/2) and Eq(P(z), P_0*1/(-1*4/3*pi*G*P_0**(3/5)*z**3/(K*R**2) + 1)**(5/3))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 645, in simplify
[36m(main_task pid=254128)[0m     expr1 = shorter(_e, _mexpand(_e).cancel())  # issue 6829
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3782, in cancel
[36m(main_task pid=254128)[0m     return cancel(self, *gens, **args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7213, in cancel
[36m(main_task pid=254128)[0m     c, (P, Q) = 1, F.cancel(G)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 2242, in cancel
[36m(main_task pid=254128)[0m     _, p, q = f.cofactors(g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 2158, in cofactors
[36m(main_task pid=254128)[0m     h, cff, cfg = f._gcd(g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 2191, in _gcd
[36m(main_task pid=254128)[0m     return f._gcd_ZZ(g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 2196, in _gcd_ZZ
[36m(main_task pid=254128)[0m     return heugcd(f, g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/heuristicgcd.py", line 80, in heugcd
[36m(main_task pid=254128)[0m     h, cff, cfg = heugcd(ff, gg)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/heuristicgcd.py", line 80, in heugcd
[36m(main_task pid=254128)[0m     h, cff, cfg = heugcd(ff, gg)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/heuristicgcd.py", line 80, in heugcd
[36m(main_task pid=254128)[0m     h, cff, cfg = heugcd(ff, gg)
[36m(main_task pid=254128)[0m   [Previous line repeated 8 more times]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/heuristicgcd.py", line 61, in heugcd
[36m(main_task pid=254128)[0m     gcd, f, g = f.extract_ground(g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 2056, in extract_ground
[36m(main_task pid=254128)[0m     fc = f.content()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 1963, in content
[36m(main_task pid=254128)[0m     cont = gcd(cont, coeff)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/domains/integerring.py", line 237, in gcd
[36m(main_task pid=254128)[0m     return gcd(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m Saving best checkpoint with score 0.3091397237582442 at ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Saving actor checkpoint to ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(main_task pid=254128)[0m step:70 - batch/bef_solve_none:49.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:49.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.296 - batch/bef_failed:0.704 - batch/on_solved:0.296 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:89452.000 - global_seqlen/max:124282.000 - global_seqlen/minmax_diff:34830.000 - global_seqlen/balanced_min:106405.000 - global_seqlen/balanced_max:106406.000 - global_seqlen/mean:106405.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.009 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.799 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.975 - actor/pg_loss:-0.027 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.237 - mfu/actor:0.309 - actor/lr:0.000 - val/test_score/amc:0.319 - val/test_score/math:0.636 - val/test_score/olympiad_bench:0.284 - val/test_score/minerva:0.232 - val/test_score/aime:0.075 - avg_score:0.309 - critic/score/mean:0.296 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.296 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.018 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.018 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1416.606 - response_length/max:8192.000 - response_length/min:295.000 - response_length/clip_ratio:0.008 - on_off_metrics/on_response_length_mean:1416.606 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.296 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.984 - prompt_length/max:758.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.659 - timing_s/old_log_prob:7.168 - timing_s/adv:13.037 - timing_s/update_actor:26.562 - timing_s/testing:260.036 - timing_s/step:530.691 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:71 - batch/bef_solve_none:39.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:39.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.342 - batch/bef_failed:0.658 - batch/on_solved:0.342 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:87583.000 - global_seqlen/max:135721.000 - global_seqlen/minmax_diff:48138.000 - global_seqlen/balanced_min:106787.000 - global_seqlen/balanced_max:106788.000 - global_seqlen/mean:106787.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.022 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.889 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.259 - actor/pg_loss:-0.057 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.260 - mfu/actor:0.331 - actor/lr:0.000 - critic/score/mean:0.342 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.342 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.026 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.026 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1423.041 - response_length/max:8192.000 - response_length/min:351.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1423.041 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.342 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.516 - prompt_length/max:549.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:200.389 - timing_s/old_log_prob:7.339 - timing_s/adv:12.288 - timing_s/update_actor:25.266 - timing_s/step:238.268 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.138 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:72 - batch/bef_solve_none:42.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:42.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.326 - batch/bef_failed:0.674 - batch/on_solved:0.326 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:36975.000 - global_seqlen/max:51368.000 - global_seqlen/minmax_diff:14393.000 - global_seqlen/balanced_min:43313.000 - global_seqlen/balanced_max:43346.000 - global_seqlen/mean:43332.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.116 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.879 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.307 - actor/pg_loss:0.344 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.250 - mfu/actor:0.341 - actor/lr:0.000 - actor/sft_entropy_loss:0.708 - actor/sft_loss:0.708 - actor/sft_grad_norm:0.096 - mfu/sft_actor:0.909 - actor/sft_lr:0.000 - critic/score/mean:0.326 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.326 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.033 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.033 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1443.251 - response_length/max:8192.000 - response_length/min:285.000 - response_length/clip_ratio:0.012 - on_off_metrics/on_response_length_mean:1443.251 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.326 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.336 - prompt_length/max:625.000 - prompt_length/min:171.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:200.740 - timing_s/old_log_prob:7.428 - timing_s/adv:13.847 - timing_s/update_actor:24.791 - timing_s/sft_update_actor:10.493 - timing_s/step:250.198 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 30x across cluster][0m
[36m(main_task pid=254128)[0m step:73 - batch/bef_solve_none:53.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:53.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.291 - batch/bef_failed:0.709 - batch/on_solved:0.291 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:93259.000 - global_seqlen/max:116810.000 - global_seqlen/minmax_diff:23551.000 - global_seqlen/balanced_min:105876.000 - global_seqlen/balanced_max:105877.000 - global_seqlen/mean:105876.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.048 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.865 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.330 - actor/pg_loss:-0.109 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.237 - mfu/actor:0.340 - actor/lr:0.000 - critic/score/mean:0.291 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.291 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.014 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1411.558 - response_length/max:8192.000 - response_length/min:213.000 - response_length/clip_ratio:0.004 - on_off_metrics/on_response_length_mean:1411.558 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.291 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.766 - prompt_length/max:414.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.023 - timing_s/old_log_prob:6.869 - timing_s/adv:16.400 - timing_s/update_actor:23.878 - timing_s/step:235.578 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:74 - batch/bef_solve_none:35.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:35.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.382 - batch/bef_failed:0.618 - batch/on_solved:0.382 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:67175.000 - global_seqlen/max:126960.000 - global_seqlen/minmax_diff:59785.000 - global_seqlen/balanced_min:98881.000 - global_seqlen/balanced_max:100808.000 - global_seqlen/mean:99817.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.012 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.818 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.755 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.278 - mfu/actor:0.348 - actor/lr:0.000 - critic/score/mean:0.382 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.382 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.028 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.028 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1316.126 - response_length/max:8192.000 - response_length/min:226.000 - response_length/clip_ratio:0.006 - on_off_metrics/on_response_length_mean:1316.126 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.382 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.516 - prompt_length/max:593.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.626 - timing_s/old_log_prob:7.343 - timing_s/adv:13.340 - timing_s/update_actor:22.237 - timing_s/step:230.504 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:75 - batch/bef_solve_none:49.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:49.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.295 - batch/bef_failed:0.705 - batch/on_solved:0.295 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:34391.000 - global_seqlen/max:53635.000 - global_seqlen/minmax_diff:19244.000 - global_seqlen/balanced_min:42991.000 - global_seqlen/balanced_max:43084.000 - global_seqlen/mean:43019.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.006 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.818 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.753 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.243 - mfu/actor:0.369 - actor/lr:0.000 - actor/sft_entropy_loss:0.708 - actor/sft_loss:0.696 - actor/sft_grad_norm:0.095 - mfu/sft_actor:1.050 - actor/sft_lr:0.000 - critic/score/mean:0.295 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.295 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.002 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1448.861 - response_length/max:8192.000 - response_length/min:318.000 - response_length/clip_ratio:0.007 - on_off_metrics/on_response_length_mean:1448.861 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.295 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.125 - prompt_length/max:444.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.123 - timing_s/old_log_prob:8.155 - timing_s/adv:43.652 - timing_s/update_actor:23.659 - timing_s/sft_update_actor:9.539 - timing_s/step:275.324 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.134 - timing_per_token_ms/adv:0.025
[36m(WorkerDict pid=254532)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 15:01:39,420:Error during parsing
[36m(main_task pid=254128)[0m ValueError: Error from parse_expr with transformed code: 'Ôºî'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=254128)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=254128)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=254128)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=254128)[0m     expr = eval(
[36m(main_task pid=254128)[0m   File "<string>", line 1
[36m(main_task pid=254128)[0m     Ôºî
[36m(main_task pid=254128)[0m     ^
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºî' (U+FF14)
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=254128)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=254128)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=254128)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=254128)[0m     number = Number(number_str)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=254128)[0m     val = sympify(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=254128)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=254128)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse 'Ôºî'' failed, because of exception being raised:
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºî' (U+FF14) (<string>, line 1)
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 24x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:76 - batch/bef_solve_none:41.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:41.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.347 - batch/bef_failed:0.653 - batch/on_solved:0.347 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:91233.000 - global_seqlen/max:140136.000 - global_seqlen/minmax_diff:48903.000 - global_seqlen/balanced_min:114109.000 - global_seqlen/balanced_max:114110.000 - global_seqlen/mean:114109.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.038 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.892 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.255 - actor/pg_loss:0.123 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.282 - mfu/actor:0.328 - actor/lr:0.000 - critic/score/mean:0.347 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.347 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.031 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.031 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1539.501 - response_length/max:8192.000 - response_length/min:349.000 - response_length/clip_ratio:0.014 - on_off_metrics/on_response_length_mean:1539.501 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.347 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.453 - prompt_length/max:431.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:200.107 - timing_s/old_log_prob:7.431 - timing_s/adv:14.296 - timing_s/update_actor:26.779 - timing_s/step:241.486 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 15:05:49,251:Error comparing (0 <= x) & (x < 64) and V*bar{x} + x < 72
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 15:05:49,256:Error comparing (0 <= x) & (x < 64) and x < -V*bar{x} + 72
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 15:05:49,258:Error comparing (0 <= x) & (x < 64) and V*bar{x} + x < 72
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 15:05:49,260:Error comparing (0 <= x) & (x < 64) and x < -V*bar{x} + 72
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 15:05:49,263:Error comparing (0 <= x) & (x < 64) and x < 72
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 15:05:49,265:Error comparing (0 <= x) & (x < 64) and V*bar{x} + x < 72
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 15:05:49,267:Error comparing (0 <= x) & (x < 64) and V*bar{x} + x < 72
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictLessThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:77 - batch/bef_solve_none:52.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:52.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.268 - batch/bef_failed:0.732 - batch/on_solved:0.268 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:85547.000 - global_seqlen/max:148426.000 - global_seqlen/minmax_diff:62879.000 - global_seqlen/balanced_min:119869.000 - global_seqlen/balanced_max:119870.000 - global_seqlen/mean:119869.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.014 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.837 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.716 - actor/pg_loss:-0.049 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.244 - mfu/actor:0.317 - actor/lr:0.000 - critic/score/mean:0.268 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.268 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.013 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.013 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1629.009 - response_length/max:8192.000 - response_length/min:269.000 - response_length/clip_ratio:0.016 - on_off_metrics/on_response_length_mean:1629.009 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.268 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.945 - prompt_length/max:498.000 - prompt_length/min:184.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.260 - timing_s/old_log_prob:8.080 - timing_s/adv:18.465 - timing_s/update_actor:28.989 - timing_s/step:247.036 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 24x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 23x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:78 - batch/bef_solve_none:51.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:51.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.334 - batch/bef_failed:0.666 - batch/on_solved:0.334 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31133.000 - global_seqlen/max:51428.000 - global_seqlen/minmax_diff:20295.000 - global_seqlen/balanced_min:41368.000 - global_seqlen/balanced_max:41439.000 - global_seqlen/mean:41396.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.046 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.830 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.734 - actor/pg_loss:-0.075 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.254 - mfu/actor:0.343 - actor/lr:0.000 - actor/sft_entropy_loss:0.688 - actor/sft_loss:0.686 - actor/sft_grad_norm:0.094 - mfu/sft_actor:0.921 - actor/sft_lr:0.000 - critic/score/mean:0.334 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.334 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.015 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1555.354 - response_length/max:8192.000 - response_length/min:160.000 - response_length/clip_ratio:0.017 - on_off_metrics/on_response_length_mean:1555.354 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.334 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:255.531 - prompt_length/max:572.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.223 - timing_s/old_log_prob:7.916 - timing_s/adv:15.864 - timing_s/update_actor:25.989 - timing_s/sft_update_actor:10.965 - timing_s/step:250.366 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:79 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:4.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:4.000 - batch/bef_solved:0.303 - batch/bef_failed:0.697 - batch/on_solved:0.303 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:100056.000 - global_seqlen/max:156985.000 - global_seqlen/minmax_diff:56929.000 - global_seqlen/balanced_min:121632.000 - global_seqlen/balanced_max:121632.000 - global_seqlen/mean:121632.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.000 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.785 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.852 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.286 - mfu/actor:0.336 - actor/lr:0.000 - critic/score/mean:0.303 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.303 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.026 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.026 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1664.594 - response_length/max:8192.000 - response_length/min:283.000 - response_length/clip_ratio:0.015 - on_off_metrics/on_response_length_mean:1664.594 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.303 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:235.906 - prompt_length/max:613.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.618 - timing_s/old_log_prob:8.977 - timing_s/adv:17.416 - timing_s/update_actor:27.851 - timing_s/step:245.192 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(main_task pid=254128)[0m Saving best checkpoint with score 0.31483548240685844 at ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Saving actor checkpoint to ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(main_task pid=254128)[0m step:80 - batch/bef_solve_none:55.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:55.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.314 - batch/bef_failed:0.686 - batch/on_solved:0.314 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31141.000 - global_seqlen/max:54228.000 - global_seqlen/minmax_diff:23087.000 - global_seqlen/balanced_min:41752.000 - global_seqlen/balanced_max:41798.000 - global_seqlen/mean:41774.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.037 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.853 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.548 - actor/pg_loss:0.093 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.261 - mfu/actor:0.347 - actor/lr:0.000 - actor/sft_entropy_loss:0.656 - actor/sft_loss:0.670 - actor/sft_grad_norm:0.094 - mfu/sft_actor:1.039 - actor/sft_lr:0.000 - val/test_score/minerva:0.243 - val/test_score/aime:0.050 - val/test_score/olympiad_bench:0.294 - val/test_score/math:0.656 - val/test_score/amc:0.331 - avg_score:0.315 - critic/score/mean:0.314 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.314 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.024 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.024 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1591.313 - response_length/max:8192.000 - response_length/min:266.000 - response_length/clip_ratio:0.010 - on_off_metrics/on_response_length_mean:1591.313 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.314 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:249.062 - prompt_length/max:489.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.478 - timing_s/old_log_prob:7.624 - timing_s/adv:14.339 - timing_s/update_actor:26.196 - timing_s/sft_update_actor:9.953 - timing_s/testing:259.826 - timing_s/step:543.342 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/adv:0.008
[36m(main_task pid=254128)[0m ERROR:2025-05-28 15:27:19,046:Error during parsing
[36m(main_task pid=254128)[0m ValueError: Error from parse_expr with transformed code: 'Ôºê'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=254128)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=254128)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=254128)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=254128)[0m     expr = eval(
[36m(main_task pid=254128)[0m   File "<string>", line 1
[36m(main_task pid=254128)[0m     Ôºê
[36m(main_task pid=254128)[0m     ^
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºê' (U+FF10)
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=254128)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=254128)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=254128)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=254128)[0m     number = Number(number_str)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=254128)[0m     val = sympify(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=254128)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=254128)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse 'Ôºê'' failed, because of exception being raised:
[36m(main_task pid=254128)[0m SyntaxError: invalid character 'Ôºê' (U+FF10) (<string>, line 1)
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:81 - batch/bef_solve_none:41.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:41.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.337 - batch/bef_failed:0.663 - batch/on_solved:0.337 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:86387.000 - global_seqlen/max:147456.000 - global_seqlen/minmax_diff:61069.000 - global_seqlen/balanced_min:131338.000 - global_seqlen/balanced_max:131339.000 - global_seqlen/mean:131338.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.012 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.730 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.518 - actor/pg_loss:0.027 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.310 - mfu/actor:0.312 - actor/lr:0.000 - critic/score/mean:0.337 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.337 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.035 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.035 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1807.879 - response_length/max:8192.000 - response_length/min:238.000 - response_length/clip_ratio:0.022 - on_off_metrics/on_response_length_mean:1807.879 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.337 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.289 - prompt_length/max:592.000 - prompt_length/min:165.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.061 - timing_s/old_log_prob:8.104 - timing_s/adv:17.955 - timing_s/update_actor:32.626 - timing_s/step:249.986 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 26x across cluster][0m
[36m(main_task pid=254128)[0m step:82 - batch/bef_solve_none:39.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:39.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.335 - batch/bef_failed:0.665 - batch/on_solved:0.335 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:95821.000 - global_seqlen/max:150300.000 - global_seqlen/minmax_diff:54479.000 - global_seqlen/balanced_min:124216.000 - global_seqlen/balanced_max:124217.000 - global_seqlen/mean:124216.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.029 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.886 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.269 - actor/pg_loss:-0.066 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.305 - mfu/actor:0.352 - actor/lr:0.000 - critic/score/mean:0.335 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.335 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.033 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.033 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1693.819 - response_length/max:8192.000 - response_length/min:341.000 - response_length/clip_ratio:0.017 - on_off_metrics/on_response_length_mean:1693.819 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.335 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:247.070 - prompt_length/max:411.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:205.629 - timing_s/old_log_prob:8.224 - timing_s/adv:14.064 - timing_s/update_actor:27.320 - timing_s/step:247.370 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 22x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:83 - batch/bef_solve_none:44.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:44.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.325 - batch/bef_failed:0.675 - batch/on_solved:0.325 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31518.000 - global_seqlen/max:47156.000 - global_seqlen/minmax_diff:15638.000 - global_seqlen/balanced_min:40836.000 - global_seqlen/balanced_max:40897.000 - global_seqlen/mean:40868.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.037 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.864 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.337 - actor/pg_loss:0.083 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.270 - mfu/actor:0.335 - actor/lr:0.000 - actor/sft_entropy_loss:0.624 - actor/sft_loss:0.632 - actor/sft_grad_norm:0.090 - mfu/sft_actor:1.180 - actor/sft_lr:0.000 - critic/score/mean:0.325 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.325 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.018 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.018 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1709.218 - response_length/max:8192.000 - response_length/min:217.000 - response_length/clip_ratio:0.012 - on_off_metrics/on_response_length_mean:1709.218 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.325 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.859 - prompt_length/max:408.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.603 - timing_s/old_log_prob:8.870 - timing_s/adv:17.716 - timing_s/update_actor:28.791 - timing_s/sft_update_actor:9.509 - timing_s/step:253.936 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 15:39:51,849:Error comparing -(n + 1) + (n + 1)**k and Sum(n**(r + 1)*binomial(k, r)/(r + 1), (r, 1, k))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 760, in simplify
[36m(main_task pid=254128)[0m     return done(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 585, in done
[36m(main_task pid=254128)[0m     rv = e.doit() if doit else e
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 252, in doit
[36m(main_task pid=254128)[0m     newf = eval_sum(f, (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1048, in eval_sum
[36m(main_task pid=254128)[0m     value = eval_sum_symbolic(f.expand(), (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1252, in eval_sum_symbolic
[36m(main_task pid=254128)[0m     h = eval_sum_hyper(f_orig, (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1343, in eval_sum_hyper
[36m(main_task pid=254128)[0m     res2 = _eval_sum_hyper(f, i, b + 1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1268, in _eval_sum_hyper
[36m(main_task pid=254128)[0m     return _eval_sum_hyper(f.subs(i, i + a), i, 0)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1274, in _eval_sum_hyper
[36m(main_task pid=254128)[0m     return _eval_sum_hyper(f.subs(i, i + 1), i, 0)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1274, in _eval_sum_hyper
[36m(main_task pid=254128)[0m     return _eval_sum_hyper(f.subs(i, i + 1), i, 0)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1274, in _eval_sum_hyper
[36m(main_task pid=254128)[0m     return _eval_sum_hyper(f.subs(i, i + 1), i, 0)
[36m(main_task pid=254128)[0m   [Previous line repeated 8 more times]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1272, in _eval_sum_hyper
[36m(main_task pid=254128)[0m     if simplify(f.subs(i, Dummy('i', integer=True, positive=True))) == 0:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 707, in simplify
[36m(main_task pid=254128)[0m     expr = combsimp(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/combsimp.py", line 53, in combsimp
[36m(main_task pid=254128)[0m     return gammasimp(expr);
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 81, in gammasimp
[36m(main_task pid=254128)[0m     return _gammasimp(expr, as_comb=False)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 457, in _gammasimp
[36m(main_task pid=254128)[0m     expr = rule_gamma(was)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 178, in rule_gamma
[36m(main_task pid=254128)[0m     expr = rule_gamma(expr, 4)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 437, in rule_gamma
[36m(main_task pid=254128)[0m     y = find_fuzzy(denom, g - 1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 394, in find_fuzzy
[36m(main_task pid=254128)[0m     a = len(cancel(x/y).free_symbols)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7213, in cancel
[36m(main_task pid=254128)[0m     c, (P, Q) = 1, F.cancel(G)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 2242, in cancel
[36m(main_task pid=254128)[0m     _, p, q = f.cofactors(g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 2158, in cofactors
[36m(main_task pid=254128)[0m     h, cff, cfg = f._gcd(g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 2191, in _gcd
[36m(main_task pid=254128)[0m     return f._gcd_ZZ(g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 2196, in _gcd_ZZ
[36m(main_task pid=254128)[0m     return heugcd(f, g)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/heuristicgcd.py", line 73, in heugcd
[36m(main_task pid=254128)[0m     ff = f.evaluate(x0, x)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 2313, in evaluate
[36m(main_task pid=254128)[0m     if isinstance(x, list) and a is None:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:84 - batch/bef_solve_none:47.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:47.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.330 - batch/bef_failed:0.670 - batch/on_solved:0.330 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:96432.000 - global_seqlen/max:138115.000 - global_seqlen/minmax_diff:41683.000 - global_seqlen/balanced_min:123559.000 - global_seqlen/balanced_max:123560.000 - global_seqlen/mean:123559.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.070 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.809 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.794 - actor/pg_loss:-0.159 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.289 - mfu/actor:0.368 - actor/lr:0.000 - critic/score/mean:0.330 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.330 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.029 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1694.415 - response_length/max:8192.000 - response_length/min:403.000 - response_length/clip_ratio:0.020 - on_off_metrics/on_response_length_mean:1694.415 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.330 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.195 - prompt_length/max:387.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.616 - timing_s/old_log_prob:8.810 - timing_s/adv:20.024 - timing_s/update_actor:25.944 - timing_s/step:244.886 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254532)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 19x across cluster][0m
[36m(main_task pid=254128)[0m step:85 - batch/bef_solve_none:44.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:44.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.329 - batch/bef_failed:0.671 - batch/on_solved:0.329 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:101056.000 - global_seqlen/max:153376.000 - global_seqlen/minmax_diff:52320.000 - global_seqlen/balanced_min:126802.000 - global_seqlen/balanced_max:126803.000 - global_seqlen/mean:126802.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.046 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.845 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.540 - actor/pg_loss:0.092 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.274 - mfu/actor:0.322 - actor/lr:0.000 - critic/score/mean:0.329 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.329 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.023 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1738.285 - response_length/max:8192.000 - response_length/min:246.000 - response_length/clip_ratio:0.014 - on_off_metrics/on_response_length_mean:1738.285 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.329 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.000 - prompt_length/max:466.000 - prompt_length/min:169.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:201.783 - timing_s/old_log_prob:8.456 - timing_s/adv:14.137 - timing_s/update_actor:30.200 - timing_s/step:246.476 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 29x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 14x across cluster][0m
[36m(main_task pid=254128)[0m step:86 - batch/bef_solve_none:50.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:50.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.368 - batch/bef_failed:0.632 - batch/on_solved:0.368 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:35992.000 - global_seqlen/max:55176.000 - global_seqlen/minmax_diff:19184.000 - global_seqlen/balanced_min:43618.000 - global_seqlen/balanced_max:43663.000 - global_seqlen/mean:43638.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.082 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.808 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.869 - actor/pg_loss:0.253 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.259 - mfu/actor:0.365 - actor/lr:0.000 - actor/sft_entropy_loss:0.619 - actor/sft_loss:0.637 - actor/sft_grad_norm:0.091 - mfu/sft_actor:0.900 - actor/sft_lr:0.000 - critic/score/mean:0.368 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.368 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.016 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.016 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1591.134 - response_length/max:8192.000 - response_length/min:272.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1591.134 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.368 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.102 - prompt_length/max:470.000 - prompt_length/min:184.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:203.777 - timing_s/old_log_prob:8.139 - timing_s/adv:14.749 - timing_s/update_actor:25.036 - timing_s/sft_update_actor:11.322 - timing_s/step:255.207 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254528)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:87 - batch/bef_solve_none:42.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:13.000 - batch/solve_none:42.000 - batch/solve_none_format:0.000 - batch/solve_all:13.000 - batch/bef_solved:0.363 - batch/bef_failed:0.637 - batch/on_solved:0.363 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:93778.000 - global_seqlen/max:148530.000 - global_seqlen/minmax_diff:54752.000 - global_seqlen/balanced_min:119041.000 - global_seqlen/balanced_max:119042.000 - global_seqlen/mean:119041.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.047 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.811 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.823 - actor/pg_loss:-0.120 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.283 - mfu/actor:0.349 - actor/lr:0.000 - critic/score/mean:0.363 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.363 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.021 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.021 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1625.283 - response_length/max:8192.000 - response_length/min:280.000 - response_length/clip_ratio:0.012 - on_off_metrics/on_response_length_mean:1625.283 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.363 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:234.734 - prompt_length/max:497.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.043 - timing_s/old_log_prob:8.525 - timing_s/adv:15.487 - timing_s/update_actor:26.172 - timing_s/step:241.032 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:88 - batch/bef_solve_none:52.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:13.000 - batch/solve_none:52.000 - batch/solve_none_format:0.000 - batch/solve_all:13.000 - batch/bef_solved:0.330 - batch/bef_failed:0.670 - batch/on_solved:0.330 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:96390.000 - global_seqlen/max:186799.000 - global_seqlen/minmax_diff:90409.000 - global_seqlen/balanced_min:125544.000 - global_seqlen/balanced_max:125545.000 - global_seqlen/mean:125544.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.064 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.811 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.820 - actor/pg_loss:0.150 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.262 - mfu/actor:0.384 - actor/lr:0.000 - critic/score/mean:0.330 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.330 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.010 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1718.107 - response_length/max:8192.000 - response_length/min:389.000 - response_length/clip_ratio:0.015 - on_off_metrics/on_response_length_mean:1718.107 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.330 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.531 - prompt_length/max:475.000 - prompt_length/min:183.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:206.063 - timing_s/old_log_prob:9.659 - timing_s/adv:16.267 - timing_s/update_actor:25.948 - timing_s/step:248.621 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:89 - batch/bef_solve_none:44.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:13.000 - batch/solve_none:44.000 - batch/solve_none_format:0.000 - batch/solve_all:13.000 - batch/bef_solved:0.353 - batch/bef_failed:0.647 - batch/on_solved:0.353 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:30923.000 - global_seqlen/max:52001.000 - global_seqlen/minmax_diff:21078.000 - global_seqlen/balanced_min:41242.000 - global_seqlen/balanced_max:41351.000 - global_seqlen/mean:41268.375 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.022 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.902 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.203 - actor/pg_loss:0.053 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.247 - mfu/actor:0.362 - actor/lr:0.000 - actor/sft_entropy_loss:0.662 - actor/sft_loss:0.647 - actor/sft_grad_norm:0.090 - mfu/sft_actor:0.884 - actor/sft_lr:0.000 - critic/score/mean:0.353 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.353 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.008 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1598.473 - response_length/max:8192.000 - response_length/min:307.000 - response_length/clip_ratio:0.007 - on_off_metrics/on_response_length_mean:1598.473 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.353 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.297 - prompt_length/max:991.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.740 - timing_s/old_log_prob:7.622 - timing_s/adv:14.944 - timing_s/update_actor:25.337 - timing_s/sft_update_actor:11.465 - timing_s/step:250.827 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254530)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:90 - batch/bef_solve_none:48.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:14.000 - batch/solve_none:48.000 - batch/solve_none_format:0.000 - batch/solve_all:14.000 - batch/bef_solved:0.304 - batch/bef_failed:0.696 - batch/on_solved:0.304 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:104144.000 - global_seqlen/max:166158.000 - global_seqlen/minmax_diff:62014.000 - global_seqlen/balanced_min:128951.000 - global_seqlen/balanced_max:128952.000 - global_seqlen/mean:128951.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.038 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.827 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.665 - actor/pg_loss:-0.079 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.276 - mfu/actor:0.335 - actor/lr:0.000 - val/test_score/aime:0.071 - val/test_score/math:0.658 - val/test_score/olympiad_bench:0.275 - val/test_score/minerva:0.228 - val/test_score/amc:0.307 - avg_score:0.308 - critic/score/mean:0.304 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.304 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.026 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.026 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1759.332 - response_length/max:8192.000 - response_length/min:444.000 - response_length/clip_ratio:0.014 - on_off_metrics/on_response_length_mean:1759.332 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.304 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:255.539 - prompt_length/max:524.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.602 - timing_s/old_log_prob:8.942 - timing_s/adv:16.487 - timing_s/update_actor:29.630 - timing_s/testing:261.655 - timing_s/step:505.696 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:91 - batch/bef_solve_none:38.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:38.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.348 - batch/bef_failed:0.652 - batch/on_solved:0.348 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:102262.000 - global_seqlen/max:151270.000 - global_seqlen/minmax_diff:49008.000 - global_seqlen/balanced_min:125303.000 - global_seqlen/balanced_max:125304.000 - global_seqlen/mean:125303.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.028 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.833 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.660 - actor/pg_loss:0.063 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.298 - mfu/actor:0.359 - actor/lr:0.000 - critic/score/mean:0.348 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.348 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.032 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1711.921 - response_length/max:8192.000 - response_length/min:240.000 - response_length/clip_ratio:0.013 - on_off_metrics/on_response_length_mean:1711.921 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.348 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.953 - prompt_length/max:421.000 - prompt_length/min:181.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:206.022 - timing_s/old_log_prob:8.489 - timing_s/adv:16.300 - timing_s/update_actor:27.034 - timing_s/step:249.658 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:17:23,740:Error comparing pi**3/3 and Integral(sqrt(t**4*cos(t)**2 + sin(t*(t**2 - 2)**2)**2), (t, 0, pi))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 143, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return (a - b).evalf(chop=True, n=numeric_precision) == 0  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1648, in evalf
[36m(main_task pid=254128)[0m     result = evalf(self, prec + 4, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 649, in evalf_mul
[36m(main_task pid=254128)[0m     result = evalf(arg, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1175, in evalf_integral
[36m(main_task pid=254128)[0m     result = do_integral(expr, workprec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1136, in do_integral
[36m(main_task pid=254128)[0m     result, quadrature_err = quadts(f, [xlow, xhigh], error=1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 789, in quadts
[36m(main_task pid=254128)[0m     return ctx.quad(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 746, in quad
[36m(main_task pid=254128)[0m     v, err = rule.summation(f, points[0], prec, epsilon, m, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 233, in summation
[36m(main_task pid=254128)[0m     result = self.sum_next(f, nodes, degree, prec, results, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 308, in sum_next
[36m(main_task pid=254128)[0m     S += self.ctx.fdot((w,f(x)) for (x,w) in nodes)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/ctx_mp_python.py", line 938, in fdot
[36m(main_task pid=254128)[0m     for a, b in A:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 308, in <genexpr>
[36m(main_task pid=254128)[0m     S += self.ctx.fdot((w,f(x)) for (x,w) in nodes)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1109, in f
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(func, mp.prec, {'subs': {x: t}})
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 808, in evalf_pow
[36m(main_task pid=254128)[0m     result = evalf(base, prec + 5, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 697, in evalf_mul
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(arg, working_prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 777, in evalf_pow
[36m(main_task pid=254128)[0m     result = evalf(base, prec + 5, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 940, in evalf_trig
[36m(main_task pid=254128)[0m     y = func(re, prec, rnd)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libelefun.py", line 1378, in mpf_cos
[36m(main_task pid=254128)[0m     def mpf_cos(x, prec, rnd=round_fast): return mpf_cos_sin(x, prec, rnd, 1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libelefun.py", line 1360, in mpf_cos_sin
[36m(main_task pid=254128)[0m     c, s = cos_sin_basecase(t, wp)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libelefun.py", line 1148, in cos_sin_basecase
[36m(main_task pid=254128)[0m     a //= k; sin += a; k += 1; a = -((a*x) >> prec)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 30x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 18x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 13x across cluster][0m
[36m(main_task pid=254128)[0m step:92 - batch/bef_solve_none:37.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:37.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.347 - batch/bef_failed:0.653 - batch/on_solved:0.347 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:33255.000 - global_seqlen/max:48924.000 - global_seqlen/minmax_diff:15669.000 - global_seqlen/balanced_min:41503.000 - global_seqlen/balanced_max:41548.000 - global_seqlen/mean:41524.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.071 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.825 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.771 - actor/pg_loss:0.180 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.272 - mfu/actor:0.382 - actor/lr:0.000 - actor/sft_entropy_loss:0.609 - actor/sft_loss:0.614 - actor/sft_grad_norm:0.092 - mfu/sft_actor:0.969 - actor/sft_lr:0.000 - critic/score/mean:0.347 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.347 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.022 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.022 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1613.006 - response_length/max:8192.000 - response_length/min:311.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1613.006 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.347 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:253.391 - prompt_length/max:706.000 - prompt_length/min:184.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.367 - timing_s/old_log_prob:7.873 - timing_s/adv:16.786 - timing_s/update_actor:24.486 - timing_s/sft_update_actor:10.782 - timing_s/step:245.744 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254528)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:93 - batch/bef_solve_none:37.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:14.000 - batch/solve_none:37.000 - batch/solve_none_format:0.000 - batch/solve_all:14.000 - batch/bef_solved:0.361 - batch/bef_failed:0.639 - batch/on_solved:0.361 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:97276.000 - global_seqlen/max:158555.000 - global_seqlen/minmax_diff:61279.000 - global_seqlen/balanced_min:124386.000 - global_seqlen/balanced_max:124388.000 - global_seqlen/mean:124386.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.009 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.822 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.735 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.295 - mfu/actor:0.329 - actor/lr:0.000 - critic/score/mean:0.361 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.361 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.023 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1704.155 - response_length/max:8192.000 - response_length/min:254.000 - response_length/clip_ratio:0.018 - on_off_metrics/on_response_length_mean:1704.155 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.361 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:239.391 - prompt_length/max:616.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:201.555 - timing_s/old_log_prob:8.456 - timing_s/adv:14.448 - timing_s/update_actor:29.513 - timing_s/step:245.822 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:25:38,749:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:25:38,752:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:25:38,754:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:25:38,756:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:25:38,759:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:25:38,761:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:25:38,764:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:25:38,766:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:94 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:15.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:15.000 - batch/bef_solved:0.369 - batch/bef_failed:0.631 - batch/on_solved:0.369 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:115335.000 - global_seqlen/max:172955.000 - global_seqlen/minmax_diff:57620.000 - global_seqlen/balanced_min:132599.000 - global_seqlen/balanced_max:132600.000 - global_seqlen/mean:132599.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.066 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.844 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.595 - actor/pg_loss:0.217 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.271 - mfu/actor:0.353 - actor/lr:0.000 - critic/score/mean:0.369 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.369 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.026 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.026 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1834.067 - response_length/max:8192.000 - response_length/min:366.000 - response_length/clip_ratio:0.017 - on_off_metrics/on_response_length_mean:1834.067 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.369 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.797 - prompt_length/max:469.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:201.248 - timing_s/old_log_prob:9.478 - timing_s/adv:15.955 - timing_s/update_actor:29.180 - timing_s/step:246.703 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:95 - batch/bef_solve_none:48.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:48.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.301 - batch/bef_failed:0.699 - batch/on_solved:0.301 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:33355.000 - global_seqlen/max:49421.000 - global_seqlen/minmax_diff:16066.000 - global_seqlen/balanced_min:42849.000 - global_seqlen/balanced_max:42941.000 - global_seqlen/mean:42878.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.058 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.845 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.619 - actor/pg_loss:0.140 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.276 - mfu/actor:0.359 - actor/lr:0.000 - actor/sft_entropy_loss:0.629 - actor/sft_loss:0.640 - actor/sft_grad_norm:0.093 - mfu/sft_actor:1.093 - actor/sft_lr:0.000 - critic/score/mean:0.301 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.301 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.019 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.019 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1787.363 - response_length/max:8192.000 - response_length/min:423.000 - response_length/clip_ratio:0.007 - on_off_metrics/on_response_length_mean:1787.363 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.301 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:235.883 - prompt_length/max:460.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:196.669 - timing_s/old_log_prob:8.551 - timing_s/adv:14.271 - timing_s/update_actor:27.692 - timing_s/sft_update_actor:10.602 - timing_s/step:249.557 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254531)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:96 - batch/bef_solve_none:30.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:15.000 - batch/solve_none:30.000 - batch/solve_none_format:0.000 - batch/solve_all:15.000 - batch/bef_solved:0.412 - batch/bef_failed:0.588 - batch/on_solved:0.412 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:97641.000 - global_seqlen/max:189850.000 - global_seqlen/minmax_diff:92209.000 - global_seqlen/balanced_min:129689.000 - global_seqlen/balanced_max:129690.000 - global_seqlen/mean:129689.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.075 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.894 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.274 - actor/pg_loss:0.155 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.311 - mfu/actor:0.348 - actor/lr:0.000 - critic/score/mean:0.412 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.412 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.027 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.027 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1790.100 - response_length/max:8192.000 - response_length/min:451.000 - response_length/clip_ratio:0.015 - on_off_metrics/on_response_length_mean:1790.100 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.412 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.305 - prompt_length/max:366.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.080 - timing_s/old_log_prob:10.102 - timing_s/adv:15.153 - timing_s/update_actor:28.867 - timing_s/step:241.422 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:38:07,691:Error comparing tan(20*x)/cos(20*x) and sec(20*x*(20*sin(10*x) + cos(20*x)))**2/10
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 699, in simplify
[36m(main_task pid=254128)[0m     expr = trigsimp(expr, deep=True)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 565, in trigsimp
[36m(main_task pid=254128)[0m     expr_simplified = trigsimpfunc(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 558, in <lambda>
[36m(main_task pid=254128)[0m     'matching': (lambda x: futrig(x)),
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1159, in futrig
[36m(main_task pid=254128)[0m     e = bottom_up(e, _futrig)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 233, in bottom_up
[36m(main_task pid=254128)[0m     rv = F(rv)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/trigsimp.py", line 1226, in _futrig
[36m(main_task pid=254128)[0m     e = greedy(tree, objective=Lops)(e)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 150, in minrule
[36m(main_task pid=254128)[0m     return min([rule(expr) for rule in rules], key=objective)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 150, in <listcomp>
[36m(main_task pid=254128)[0m     return min([rule(expr) for rule in rules], key=objective)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/strategies/core.py", line 64, in chain_rl
[36m(main_task pid=254128)[0m     expr = rule(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/fu.py", line 767, in TR10i
[36m(main_task pid=254128)[0m     return bottom_up(rv, f)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in bottom_up
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 230, in <listcomp>
[36m(main_task pid=254128)[0m     args = tuple([bottom_up(a, F, atoms, nonbasic) for a in args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/traversal.py", line 233, in bottom_up
[36m(main_task pid=254128)[0m     rv = F(rv)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/fu.py", line 762, in f
[36m(main_task pid=254128)[0m     rv = do(rv)  # final pass to resolve any new inducible pairs
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/fu.py", line 689, in do
[36m(main_task pid=254128)[0m     new = do(was)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/fu.py", line 703, in do
[36m(main_task pid=254128)[0m     split = trig_split(*args, two=True)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/fu.py", line 1782, in trig_split
[36m(main_task pid=254128)[0m     a, b = [Factors(i) for i in (a, b)]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/fu.py", line 1782, in <listcomp>
[36m(main_task pid=254128)[0m     a, b = [Factors(i) for i in (a, b)]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/exprtools.py", line 353, in __init__
[36m(main_task pid=254128)[0m     factors = dict(Mul._from_args(c).as_powers_dict())
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 1228, in as_powers_dict
[36m(main_task pid=254128)[0m     d[b] += e
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 1870, in __radd__
[36m(main_task pid=254128)[0m     return Integer(other + self.p)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:97 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.344 - batch/bef_failed:0.656 - batch/on_solved:0.344 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:107370.000 - global_seqlen/max:156255.000 - global_seqlen/minmax_diff:48885.000 - global_seqlen/balanced_min:132257.000 - global_seqlen/balanced_max:132257.000 - global_seqlen/mean:132257.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.003 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.906 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.193 - actor/pg_loss:0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.282 - mfu/actor:0.364 - actor/lr:0.000 - critic/score/mean:0.344 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.344 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.011 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1823.469 - response_length/max:8192.000 - response_length/min:292.000 - response_length/clip_ratio:0.015 - on_off_metrics/on_response_length_mean:1823.469 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.344 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.047 - prompt_length/max:378.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.575 - timing_s/old_log_prob:8.550 - timing_s/adv:19.907 - timing_s/update_actor:28.018 - timing_s/step:245.891 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:42:14,380:Error comparing 3**6567340 and 3**19702016
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 143, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return (a - b).evalf(chop=True, n=numeric_precision) == 0  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 106, in binary_op_wrapper
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 209, in __sub__
[36m(main_task pid=254128)[0m     return Add(self, -other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 335, in flatten
[36m(main_task pid=254128)[0m     newseq.append(Mul(c, s))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 399, in flatten
[36m(main_task pid=254128)[0m     coeff *= Pow(b, e)  # it is an unevaluated power
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 207, in __new__
[36m(main_task pid=254128)[0m     obj = b._eval_power(e)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 2045, in _eval_power
[36m(main_task pid=254128)[0m     result = Integer(x**abs(expt.p))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:42:17,469:Error comparing 3**6567340 and 3**39404040
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 143, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return (a - b).evalf(chop=True, n=numeric_precision) == 0  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 106, in binary_op_wrapper
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 209, in __sub__
[36m(main_task pid=254128)[0m     return Add(self, -other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 335, in flatten
[36m(main_task pid=254128)[0m     newseq.append(Mul(c, s))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 399, in flatten
[36m(main_task pid=254128)[0m     coeff *= Pow(b, e)  # it is an unevaluated power
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/power.py", line 207, in __new__
[36m(main_task pid=254128)[0m     obj = b._eval_power(e)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 2045, in _eval_power
[36m(main_task pid=254128)[0m     result = Integer(x**abs(expt.p))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 30x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254527)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:98 - batch/bef_solve_none:39.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:15.000 - batch/solve_none:39.000 - batch/solve_none_format:0.000 - batch/solve_all:15.000 - batch/bef_solved:0.379 - batch/bef_failed:0.621 - batch/on_solved:0.379 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:35383.000 - global_seqlen/max:47841.000 - global_seqlen/minmax_diff:12458.000 - global_seqlen/balanced_min:41571.000 - global_seqlen/balanced_max:41644.000 - global_seqlen/mean:41619.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.021 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.898 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.220 - actor/pg_loss:0.039 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.293 - mfu/actor:0.387 - actor/lr:0.000 - actor/sft_entropy_loss:0.670 - actor/sft_loss:0.681 - actor/sft_grad_norm:0.098 - mfu/sft_actor:1.088 - actor/sft_lr:0.000 - critic/score/mean:0.379 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.379 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.013 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.013 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1850.233 - response_length/max:8192.000 - response_length/min:240.000 - response_length/clip_ratio:0.011 - on_off_metrics/on_response_length_mean:1850.233 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.379 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.305 - prompt_length/max:384.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.936 - timing_s/old_log_prob:8.792 - timing_s/adv:27.373 - timing_s/update_actor:26.721 - timing_s/sft_update_actor:10.769 - timing_s/step:263.125 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/adv:0.013
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254530)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:99 - batch/bef_solve_none:41.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:41.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.349 - batch/bef_failed:0.651 - batch/on_solved:0.349 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:104191.000 - global_seqlen/max:144842.000 - global_seqlen/minmax_diff:40651.000 - global_seqlen/balanced_min:128507.000 - global_seqlen/balanced_max:128507.000 - global_seqlen/mean:128507.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.043 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.890 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.250 - actor/pg_loss:-0.092 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.298 - mfu/actor:0.375 - actor/lr:0.000 - critic/score/mean:0.349 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.349 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.019 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.019 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1767.406 - response_length/max:8192.000 - response_length/min:443.000 - response_length/clip_ratio:0.013 - on_off_metrics/on_response_length_mean:1767.406 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.349 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.516 - prompt_length/max:395.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.135 - timing_s/old_log_prob:7.890 - timing_s/adv:14.641 - timing_s/update_actor:26.467 - timing_s/step:240.580 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 16:50:38,306:Error during parsing
[36m(main_task pid=254128)[0m ValueError: Error from parse_expr with transformed code: '‡ß¶'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m The above exception was the direct cause of the following exception:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 481, in sympify
[36m(main_task pid=254128)[0m     expr = parse_expr(a, local_dict=locals, transformations=transformations, evaluate=evaluate)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1090, in parse_expr
[36m(main_task pid=254128)[0m     raise e from ValueError(f"Error from parse_expr with transformed code: {code!r}")
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 1081, in parse_expr
[36m(main_task pid=254128)[0m     rv = eval_expr(code, local_dict, global_dict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/parsing/sympy_parser.py", line 909, in eval_expr
[36m(main_task pid=254128)[0m     expr = eval(
[36m(main_task pid=254128)[0m   File "<string>", line 1
[36m(main_task pid=254128)[0m     ‡ß¶
[36m(main_task pid=254128)[0m     ^
[36m(main_task pid=254128)[0m SyntaxError: invalid character '‡ß¶' (U+09E6)
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 640, in parse
[36m(main_task pid=254128)[0m     return extract_target_from_pred(pred, target_res, fallback_mode=fallback_mode, extraction_mode=extraction_mode, timeout_seconds=parsing_timeout)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 574, in extract_target_from_pred
[36m(main_task pid=254128)[0m     extracted_match, str_fallback = extract_match(match, target_type, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 517, in extract_match
[36m(main_task pid=254128)[0m     return extract_expr(match, timeout_seconds=timeout_seconds)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/parser.py", line 394, in extract_expr
[36m(main_task pid=254128)[0m     number = Number(number_str)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 338, in __new__
[36m(main_task pid=254128)[0m     val = sympify(obj)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 483, in sympify
[36m(main_task pid=254128)[0m     raise SympifyError('could not parse %r' % a, exc)
[36m(main_task pid=254128)[0m sympy.core.sympify.SympifyError: Sympify of expression 'could not parse '‡ß¶'' failed, because of exception being raised:
[36m(main_task pid=254128)[0m SyntaxError: invalid character '‡ß¶' (U+09E6) (<string>, line 1)
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:100 - batch/bef_solve_none:43.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:43.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.342 - batch/bef_failed:0.658 - batch/on_solved:0.342 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:117247.000 - global_seqlen/max:171426.000 - global_seqlen/minmax_diff:54179.000 - global_seqlen/balanced_min:142019.000 - global_seqlen/balanced_max:142020.000 - global_seqlen/mean:142019.188 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.004 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.893 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.292 - actor/pg_loss:-0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.287 - mfu/actor:0.377 - actor/lr:0.000 - val/test_score/math:0.658 - val/test_score/olympiad_bench:0.299 - val/test_score/aime:0.037 - val/test_score/amc:0.328 - val/test_score/minerva:0.250 - avg_score:0.314 - critic/score/mean:0.342 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.342 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.013 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.013 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1979.034 - response_length/max:8192.000 - response_length/min:313.000 - response_length/clip_ratio:0.016 - on_off_metrics/on_response_length_mean:1979.034 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.342 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.016 - prompt_length/max:829.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:200.083 - timing_s/old_log_prob:9.046 - timing_s/adv:14.661 - timing_s/update_actor:29.280 - timing_s/testing:262.961 - timing_s/step:507.316 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:101 - batch/bef_solve_none:37.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:37.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.361 - batch/bef_failed:0.639 - batch/on_solved:0.361 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32961.000 - global_seqlen/max:51541.000 - global_seqlen/minmax_diff:18580.000 - global_seqlen/balanced_min:41418.000 - global_seqlen/balanced_max:41454.000 - global_seqlen/mean:41431.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.080 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.916 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.171 - actor/pg_loss:0.191 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.300 - mfu/actor:0.370 - actor/lr:0.000 - actor/sft_entropy_loss:0.601 - actor/sft_loss:0.616 - actor/sft_grad_norm:0.087 - mfu/sft_actor:1.175 - actor/sft_lr:0.000 - critic/score/mean:0.361 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.361 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.017 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1846.864 - response_length/max:8192.000 - response_length/min:280.000 - response_length/clip_ratio:0.013 - on_off_metrics/on_response_length_mean:1846.864 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.361 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:239.180 - prompt_length/max:452.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.209 - timing_s/old_log_prob:8.384 - timing_s/adv:13.693 - timing_s/update_actor:27.863 - timing_s/sft_update_actor:10.443 - timing_s/step:251.534 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:102 - batch/bef_solve_none:52.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:52.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.306 - batch/bef_failed:0.694 - batch/on_solved:0.306 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:121836.000 - global_seqlen/max:168915.000 - global_seqlen/minmax_diff:47079.000 - global_seqlen/balanced_min:145254.000 - global_seqlen/balanced_max:145255.000 - global_seqlen/mean:145254.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.009 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.838 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.599 - actor/pg_loss:-0.016 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.293 - mfu/actor:0.366 - actor/lr:0.000 - critic/score/mean:0.306 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.306 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.016 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.016 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2017.939 - response_length/max:8192.000 - response_length/min:287.000 - response_length/clip_ratio:0.018 - on_off_metrics/on_response_length_mean:2017.939 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.306 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.664 - prompt_length/max:555.000 - prompt_length/min:181.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:203.659 - timing_s/old_log_prob:9.061 - timing_s/adv:14.342 - timing_s/update_actor:31.925 - timing_s/step:250.218 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:07:31,316:Error comparing log(5, E)/8 and Integral((8*sin(theta)*cos(theta)**2 - 1*4*sin(theta) + cos(theta)**2 - 1)/((8*cos(theta)**2)), (theta, pi/2, 0))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 143, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return (a - b).evalf(chop=True, n=numeric_precision) == 0  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1648, in evalf
[36m(main_task pid=254128)[0m     result = evalf(self, prec + 4, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 649, in evalf_mul
[36m(main_task pid=254128)[0m     result = evalf(arg, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1175, in evalf_integral
[36m(main_task pid=254128)[0m     result = do_integral(expr, workprec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1136, in do_integral
[36m(main_task pid=254128)[0m     result, quadrature_err = quadts(f, [xlow, xhigh], error=1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 789, in quadts
[36m(main_task pid=254128)[0m     return ctx.quad(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 746, in quad
[36m(main_task pid=254128)[0m     v, err = rule.summation(f, points[0], prec, epsilon, m, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 233, in summation
[36m(main_task pid=254128)[0m     result = self.sum_next(f, nodes, degree, prec, results, verbose)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 308, in sum_next
[36m(main_task pid=254128)[0m     S += self.ctx.fdot((w,f(x)) for (x,w) in nodes)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/ctx_mp_python.py", line 938, in fdot
[36m(main_task pid=254128)[0m     for a, b in A:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/calculus/quadrature.py", line 308, in <genexpr>
[36m(main_task pid=254128)[0m     S += self.ctx.fdot((w,f(x)) for (x,w) in nodes)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1109, in f
[36m(main_task pid=254128)[0m     re, im, re_acc, im_acc = evalf(func, mp.prec, {'subs': {x: t}})
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 649, in evalf_mul
[36m(main_task pid=254128)[0m     result = evalf(arg, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in evalf_add
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 601, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [evalf(arg, prec + 10, options) for arg in v.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1483, in evalf
[36m(main_task pid=254128)[0m     r = rf(x, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 649, in evalf_mul
[36m(main_task pid=254128)[0m     result = evalf(arg, prec, options)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/evalf.py", line 1449, in evalf
[36m(main_task pid=254128)[0m     def evalf(x: 'Expr', prec: int, options: OPT_DICT) -> TMP_RES:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:07:32,944:Error comparing (-1/2 < k) & (k < 4) and k >= 1
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'GreaterThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:07:32,948:Error comparing (-1/2 < k) & (k < 4) and k <= 0
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'LessThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:07:32,955:Error comparing (-1/2 < k) & (k < 4) and Part2:*k >= -2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'GreaterThan' object has no attribute '_unsorted_args'
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:07:32,957:Error comparing (-1/2 < k) & (k < 4) and k <= 0
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'LessThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:103 - batch/bef_solve_none:44.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:44.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.347 - batch/bef_failed:0.653 - batch/on_solved:0.347 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:120683.000 - global_seqlen/max:166671.000 - global_seqlen/minmax_diff:45988.000 - global_seqlen/balanced_min:139166.000 - global_seqlen/balanced_max:139167.000 - global_seqlen/mean:139166.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.039 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.850 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.519 - actor/pg_loss:-0.092 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.299 - mfu/actor:0.372 - actor/lr:0.000 - critic/score/mean:0.347 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.347 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.023 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1925.784 - response_length/max:8192.000 - response_length/min:379.000 - response_length/clip_ratio:0.013 - on_off_metrics/on_response_length_mean:1925.784 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.347 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:248.695 - prompt_length/max:834.000 - prompt_length/min:169.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.563 - timing_s/old_log_prob:9.014 - timing_s/adv:17.552 - timing_s/update_actor:28.859 - timing_s/step:246.279 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:11:44,153:Error comparing C*cos(x) + sin(x) and Eq(y, (C + Integral(exp(cos(x)), x))*exp(-cos(x)))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 760, in simplify
[36m(main_task pid=254128)[0m     return done(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 585, in done
[36m(main_task pid=254128)[0m     rv = e.doit() if doit else e
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/integrals.py", line 619, in doit
[36m(main_task pid=254128)[0m     antideriv = self._eval_integral(
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/integrals.py", line 1091, in _eval_integral
[36m(main_task pid=254128)[0m     h = heurisch_wrapper(g, x, hints=[])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 144, in heurisch_wrapper
[36m(main_task pid=254128)[0m     res = heurisch(f, x, rewrite, hints, mappings, retries, degree_offset,
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 776, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, mappings=mappings, rewrite=rewrite, hints=hints, retries=retries - 1, unnecessary_permutations=unnecessary_permutations)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 776, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, mappings=mappings, rewrite=rewrite, hints=hints, retries=retries - 1, unnecessary_permutations=unnecessary_permutations)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 776, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, mappings=mappings, rewrite=rewrite, hints=hints, retries=retries - 1, unnecessary_permutations=unnecessary_permutations)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 534, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, rewrite=True, hints=hints,
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 759, in heurisch
[36m(main_task pid=254128)[0m     solution = _integrate('Q')
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 740, in _integrate
[36m(main_task pid=254128)[0m     numer = ring.from_expr(raw_numer)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 397, in from_expr
[36m(main_task pid=254128)[0m     poly = self._rebuild_expr(expr, mapping)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 391, in _rebuild_expr
[36m(main_task pid=254128)[0m     return _rebuild(sympify(expr))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 379, in _rebuild
[36m(main_task pid=254128)[0m     return reduce(add, list(map(_rebuild, expr.args)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 381, in _rebuild
[36m(main_task pid=254128)[0m     return reduce(mul, list(map(_rebuild, expr.args)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 379, in _rebuild
[36m(main_task pid=254128)[0m     return reduce(add, list(map(_rebuild, expr.args)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 381, in _rebuild
[36m(main_task pid=254128)[0m     return reduce(mul, list(map(_rebuild, expr.args)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 1118, in __mul__
[36m(main_task pid=254128)[0m     p[exp] = get(exp, zero) + v1*v2
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 1117, in __mul__
[36m(main_task pid=254128)[0m     exp = monomial_mul(exp1, exp2)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:11:47,180:Error comparing C*cos(x) + sin(x) and Eq(y, (C + Integral(exp(cos(x)), x))*exp(-cos(x)))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 760, in simplify
[36m(main_task pid=254128)[0m     return done(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 585, in done
[36m(main_task pid=254128)[0m     rv = e.doit() if doit else e
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/integrals.py", line 619, in doit
[36m(main_task pid=254128)[0m     antideriv = self._eval_integral(
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/integrals.py", line 1091, in _eval_integral
[36m(main_task pid=254128)[0m     h = heurisch_wrapper(g, x, hints=[])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 144, in heurisch_wrapper
[36m(main_task pid=254128)[0m     res = heurisch(f, x, rewrite, hints, mappings, retries, degree_offset,
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 776, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, mappings=mappings, rewrite=rewrite, hints=hints, retries=retries - 1, unnecessary_permutations=unnecessary_permutations)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 776, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, mappings=mappings, rewrite=rewrite, hints=hints, retries=retries - 1, unnecessary_permutations=unnecessary_permutations)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 776, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, mappings=mappings, rewrite=rewrite, hints=hints, retries=retries - 1, unnecessary_permutations=unnecessary_permutations)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 534, in heurisch
[36m(main_task pid=254128)[0m     result = heurisch(f, x, rewrite=True, hints=hints,
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 759, in heurisch
[36m(main_task pid=254128)[0m     solution = _integrate('Q')
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/integrals/heurisch.py", line 740, in _integrate
[36m(main_task pid=254128)[0m     numer = ring.from_expr(raw_numer)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 397, in from_expr
[36m(main_task pid=254128)[0m     poly = self._rebuild_expr(expr, mapping)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 391, in _rebuild_expr
[36m(main_task pid=254128)[0m     return _rebuild(sympify(expr))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 379, in _rebuild
[36m(main_task pid=254128)[0m     return reduce(add, list(map(_rebuild, expr.args)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 381, in _rebuild
[36m(main_task pid=254128)[0m     return reduce(mul, list(map(_rebuild, expr.args)))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 1118, in __mul__
[36m(main_task pid=254128)[0m     p[exp] = get(exp, zero) + v1*v2
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 1117, in __mul__
[36m(main_task pid=254128)[0m     exp = monomial_mul(exp1, exp2)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:11:54,247:Error comparing Eq(P(x), (x - 1/2)**2001 + 1/2) and 1/2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 644, in simplify
[36m(main_task pid=254128)[0m     _e = cancel(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7218, in cancel
[36m(main_task pid=254128)[0m     return c*(P.as_expr()/Q.as_expr())
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 643, in as_expr
[36m(main_task pid=254128)[0m     return expr_from_dict(self.as_expr_dict(), *symbols)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 405, in expr_from_dict
[36m(main_task pid=254128)[0m     return Add(*result)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 335, in flatten
[36m(main_task pid=254128)[0m     newseq.append(Mul(c, s))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 657, in flatten
[36m(main_task pid=254128)[0m     if coeff in (S.Infinity, S.NegativeInfinity):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 3116, in __eq__
[36m(main_task pid=254128)[0m     return other is S.Infinity or other == float('inf')
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 1939, in __eq__
[36m(main_task pid=254128)[0m     return Rational.__eq__(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 1593, in __eq__
[36m(main_task pid=254128)[0m     other = _sympify(other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/sympify.py", line 488, in _sympify
[36m(main_task pid=254128)[0m     def _sympify(a):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:11:57,261:Error comparing Eq(P(x), (x - 1/2)**2001 + 1/2) and -x
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'zero'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 644, in simplify
[36m(main_task pid=254128)[0m     _e = cancel(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7218, in cancel
[36m(main_task pid=254128)[0m     return c*(P.as_expr()/Q.as_expr())
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 643, in as_expr
[36m(main_task pid=254128)[0m     return expr_from_dict(self.as_expr_dict(), *symbols)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 403, in expr_from_dict
[36m(main_task pid=254128)[0m     result.append(Mul(*term))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 283, in flatten
[36m(main_task pid=254128)[0m     if a.is_Rational and not a.is_zero:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 503, in getit
[36m(main_task pid=254128)[0m     return _ask(fact, self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 566, in _ask
[36m(main_task pid=254128)[0m     assumptions.deduce_all_facts(((fact_i, fact_i_value),))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/facts.py", line 633, in deduce_all_facts
[36m(main_task pid=254128)[0m     if all(self.get(k) is v for k, v in bcond):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:12:00,279:Error comparing Eq(P(x), (x - 1/2)**2001 + 1/2) and -1*1/2*x**2001 + 1/2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 644, in simplify
[36m(main_task pid=254128)[0m     _e = cancel(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7218, in cancel
[36m(main_task pid=254128)[0m     return c*(P.as_expr()/Q.as_expr())
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 643, in as_expr
[36m(main_task pid=254128)[0m     return expr_from_dict(self.as_expr_dict(), *symbols)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 403, in expr_from_dict
[36m(main_task pid=254128)[0m     result.append(Mul(*term))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 480, in flatten
[36m(main_task pid=254128)[0m     c_powers = _gather(c_powers)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 473, in _gather
[36m(main_task pid=254128)[0m     d[di] = Add(*li)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 52, in __new__
[36m(main_task pid=254128)[0m     @cacheit
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:12:03,302:Error comparing Eq(P(x), (x - 1/2)**2001 + 1/2) and -1*x**2001/2 + x**2001
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 644, in simplify
[36m(main_task pid=254128)[0m     _e = cancel(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7218, in cancel
[36m(main_task pid=254128)[0m     return c*(P.as_expr()/Q.as_expr())
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/rings.py", line 643, in as_expr
[36m(main_task pid=254128)[0m     return expr_from_dict(self.as_expr_dict(), *symbols)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polyutils.py", line 399, in expr_from_dict
[36m(main_task pid=254128)[0m     for g, m in zip(gens, monom):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:12:06,321:Error comparing Eq(P(x), (x - 1/2)**2001 + 1/2) and (1 - x**2001)/2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'extended_negative'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 645, in simplify
[36m(main_task pid=254128)[0m     expr1 = shorter(_e, _mexpand(_e).cancel())  # issue 6829
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3782, in cancel
[36m(main_task pid=254128)[0m     return cancel(self, *gens, **args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7155, in cancel
[36m(main_task pid=254128)[0m     f = signsimp(f)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 406, in signsimp
[36m(main_task pid=254128)[0m     e = sub_post(sub_pre(e))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/cse_opts.py", line 14, in sub_pre
[36m(main_task pid=254128)[0m     adds = [a for a in e.atoms(Add) if a.could_extract_minus_sign()]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/cse_opts.py", line 14, in <listcomp>
[36m(main_task pid=254128)[0m     adds = [a for a in e.atoms(Add) if a.could_extract_minus_sign()]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 412, in could_extract_minus_sign
[36m(main_task pid=254128)[0m     return _could_extract_minus_sign(self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 20, in _could_extract_minus_sign
[36m(main_task pid=254128)[0m     negative_args = sum(1 for i in expr.args
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 21, in <genexpr>
[36m(main_task pid=254128)[0m     if i.could_extract_minus_sign())
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 179, in could_extract_minus_sign
[36m(main_task pid=254128)[0m     return c.is_Number and c.is_extended_negative
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 503, in getit
[36m(main_task pid=254128)[0m     return _ask(fact, self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 566, in _ask
[36m(main_task pid=254128)[0m     assumptions.deduce_all_facts(((fact_i, fact_i_value),))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/facts.py", line 633, in deduce_all_facts
[36m(main_task pid=254128)[0m     if all(self.get(k) is v for k, v in bcond):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 17:12:09,439:Error comparing Eq(P(x), (x - 1/2)**2001 + 1/2) and -1*1/2*x**2001 + 1/2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'zero'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 644, in simplify
[36m(main_task pid=254128)[0m     _e = cancel(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7218, in cancel
[36m(main_task pid=254128)[0m     return c*(P.as_expr()/Q.as_expr())
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 106, in binary_op_wrapper
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 259, in __truediv__
[36m(main_task pid=254128)[0m     return Mul(self, denom)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 295, in flatten
[36m(main_task pid=254128)[0m     newb = Add(*[_keep_coeff(a, bi) for bi in b.args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/add.py", line 335, in flatten
[36m(main_task pid=254128)[0m     newseq.append(Mul(c, s))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 511, in flatten
[36m(main_task pid=254128)[0m     if e.is_zero:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 503, in getit
[36m(main_task pid=254128)[0m     return _ask(fact, self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 566, in _ask
[36m(main_task pid=254128)[0m     assumptions.deduce_all_facts(((fact_i, fact_i_value),))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/facts.py", line 633, in deduce_all_facts
[36m(main_task pid=254128)[0m     if all(self.get(k) is v for k, v in bcond):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:104 - batch/bef_solve_none:55.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:17.000 - batch/solve_none:55.000 - batch/solve_none_format:0.000 - batch/solve_all:17.000 - batch/bef_solved:0.354 - batch/bef_failed:0.646 - batch/on_solved:0.354 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:34261.000 - global_seqlen/max:45950.000 - global_seqlen/minmax_diff:11689.000 - global_seqlen/balanced_min:40450.000 - global_seqlen/balanced_max:40635.000 - global_seqlen/mean:40535.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.004 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.898 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.233 - actor/pg_loss:-0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.232 - mfu/actor:0.356 - actor/lr:0.000 - actor/sft_entropy_loss:0.648 - actor/sft_loss:0.638 - actor/sft_grad_norm:0.082 - mfu/sft_actor:1.180 - actor/sft_lr:0.000 - critic/score/mean:0.354 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.354 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.010 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1902.717 - response_length/max:8192.000 - response_length/min:179.000 - response_length/clip_ratio:0.010 - on_off_metrics/on_response_length_mean:1902.717 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.354 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:235.453 - prompt_length/max:377.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:200.109 - timing_s/old_log_prob:9.317 - timing_s/adv:43.972 - timing_s/update_actor:29.818 - timing_s/sft_update_actor:10.439 - timing_s/step:284.680 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/adv:0.020
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:105 - batch/bef_solve_none:42.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:13.000 - batch/solve_none:42.000 - batch/solve_none_format:0.000 - batch/solve_all:13.000 - batch/bef_solved:0.349 - batch/bef_failed:0.651 - batch/on_solved:0.349 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:109989.000 - global_seqlen/max:200144.000 - global_seqlen/minmax_diff:90155.000 - global_seqlen/balanced_min:150553.000 - global_seqlen/balanced_max:150554.000 - global_seqlen/mean:150553.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.027 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.885 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.355 - actor/pg_loss:0.076 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.342 - mfu/actor:0.376 - actor/lr:0.000 - critic/score/mean:0.349 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.349 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.032 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2111.321 - response_length/max:8192.000 - response_length/min:316.000 - response_length/clip_ratio:0.031 - on_off_metrics/on_response_length_mean:2111.321 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.349 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.070 - prompt_length/max:508.000 - prompt_length/min:170.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:205.565 - timing_s/old_log_prob:10.152 - timing_s/adv:22.405 - timing_s/update_actor:31.560 - timing_s/step:259.837 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:106 - batch/bef_solve_none:43.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:20.000 - batch/solve_none:43.000 - batch/solve_none_format:0.000 - batch/solve_all:20.000 - batch/bef_solved:0.358 - batch/bef_failed:0.642 - batch/on_solved:0.358 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:106538.000 - global_seqlen/max:159301.000 - global_seqlen/minmax_diff:52763.000 - global_seqlen/balanced_min:138756.000 - global_seqlen/balanced_max:139284.000 - global_seqlen/mean:138796.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.053 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.844 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.603 - actor/pg_loss:-0.119 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.280 - mfu/actor:0.343 - actor/lr:0.000 - critic/score/mean:0.358 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.358 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.005 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1931.340 - response_length/max:8192.000 - response_length/min:421.000 - response_length/clip_ratio:0.016 - on_off_metrics/on_response_length_mean:1931.340 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.358 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.359 - prompt_length/max:387.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:200.730 - timing_s/old_log_prob:8.620 - timing_s/adv:16.543 - timing_s/update_actor:31.295 - timing_s/step:248.877 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:107 - batch/bef_solve_none:35.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:17.000 - batch/solve_none:35.000 - batch/solve_none_format:0.000 - batch/solve_all:17.000 - batch/bef_solved:0.410 - batch/bef_failed:0.590 - batch/on_solved:0.410 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31427.000 - global_seqlen/max:48760.000 - global_seqlen/minmax_diff:17333.000 - global_seqlen/balanced_min:40828.000 - global_seqlen/balanced_max:40914.000 - global_seqlen/mean:40882.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.112 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.879 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.366 - actor/pg_loss:0.278 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.311 - mfu/actor:0.380 - actor/lr:0.000 - actor/sft_entropy_loss:0.620 - actor/sft_loss:0.622 - actor/sft_grad_norm:0.078 - mfu/sft_actor:1.102 - actor/sft_lr:0.000 - critic/score/mean:0.410 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.410 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.019 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.019 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1885.480 - response_length/max:8192.000 - response_length/min:489.000 - response_length/clip_ratio:0.012 - on_off_metrics/on_response_length_mean:1885.480 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.410 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.617 - prompt_length/max:522.000 - prompt_length/min:170.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.642 - timing_s/old_log_prob:9.389 - timing_s/adv:15.393 - timing_s/update_actor:27.522 - timing_s/sft_update_actor:10.760 - timing_s/step:251.657 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:108 - batch/bef_solve_none:35.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:35.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.384 - batch/bef_failed:0.616 - batch/on_solved:0.384 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:119673.000 - global_seqlen/max:202188.000 - global_seqlen/minmax_diff:82515.000 - global_seqlen/balanced_min:144652.000 - global_seqlen/balanced_max:144652.000 - global_seqlen/mean:144652.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.035 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.831 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.744 - actor/pg_loss:0.091 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.326 - mfu/actor:0.378 - actor/lr:0.000 - critic/score/mean:0.384 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.384 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.020 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2011.938 - response_length/max:8192.000 - response_length/min:260.000 - response_length/clip_ratio:0.020 - on_off_metrics/on_response_length_mean:2011.938 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.384 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:248.250 - prompt_length/max:728.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:207.411 - timing_s/old_log_prob:10.822 - timing_s/adv:16.484 - timing_s/update_actor:29.854 - timing_s/step:254.059 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 26x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 22x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:109 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.327 - batch/bef_failed:0.673 - batch/on_solved:0.327 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:111102.000 - global_seqlen/max:164203.000 - global_seqlen/minmax_diff:53101.000 - global_seqlen/balanced_min:142603.000 - global_seqlen/balanced_max:142604.000 - global_seqlen/mean:142603.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.073 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.835 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.645 - actor/pg_loss:0.197 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.279 - mfu/actor:0.379 - actor/lr:0.000 - critic/score/mean:0.327 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.327 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.014 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1984.574 - response_length/max:8192.000 - response_length/min:425.000 - response_length/clip_ratio:0.011 - on_off_metrics/on_response_length_mean:1984.574 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.327 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.602 - prompt_length/max:440.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.993 - timing_s/old_log_prob:9.231 - timing_s/adv:18.843 - timing_s/update_actor:29.207 - timing_s/step:247.354 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254528)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=254531)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:110 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:8.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:8.000 - batch/bef_solved:0.346 - batch/bef_failed:0.654 - batch/on_solved:0.346 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32268.000 - global_seqlen/max:49960.000 - global_seqlen/minmax_diff:17692.000 - global_seqlen/balanced_min:41395.000 - global_seqlen/balanced_max:41541.000 - global_seqlen/mean:41449.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.010 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.884 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.266 - actor/pg_loss:0.035 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.314 - mfu/actor:0.361 - actor/lr:0.000 - actor/sft_entropy_loss:0.609 - actor/sft_loss:0.615 - actor/sft_grad_norm:0.077 - mfu/sft_actor:1.240 - actor/sft_lr:0.000 - val/test_score/amc:0.301 - val/test_score/olympiad_bench:0.306 - val/test_score/math:0.642 - val/test_score/aime:0.054 - val/test_score/minerva:0.217 - avg_score:0.304 - critic/score/mean:0.346 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.346 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.029 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1976.207 - response_length/max:8192.000 - response_length/min:372.000 - response_length/clip_ratio:0.014 - on_off_metrics/on_response_length_mean:1976.207 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.346 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.695 - prompt_length/max:415.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:205.017 - timing_s/old_log_prob:10.046 - timing_s/adv:16.142 - timing_s/update_actor:30.508 - timing_s/sft_update_actor:10.417 - timing_s/testing:266.880 - timing_s/step:529.300 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:111 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:5.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:5.000 - batch/bef_solved:0.296 - batch/bef_failed:0.704 - batch/on_solved:0.296 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:126556.000 - global_seqlen/max:168827.000 - global_seqlen/minmax_diff:42271.000 - global_seqlen/balanced_min:143114.000 - global_seqlen/balanced_max:143624.000 - global_seqlen/mean:143468.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.102 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.830 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.691 - actor/pg_loss:0.290 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.347 - mfu/actor:0.344 - actor/lr:0.000 - critic/score/mean:0.296 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.296 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.030 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2003.029 - response_length/max:8192.000 - response_length/min:361.000 - response_length/clip_ratio:0.022 - on_off_metrics/on_response_length_mean:2003.029 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.296 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:238.672 - prompt_length/max:383.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:203.066 - timing_s/old_log_prob:8.926 - timing_s/adv:16.330 - timing_s/update_actor:32.325 - timing_s/step:252.033 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:112 - batch/bef_solve_none:39.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:39.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.349 - batch/bef_failed:0.651 - batch/on_solved:0.349 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:97329.000 - global_seqlen/max:196717.000 - global_seqlen/minmax_diff:99388.000 - global_seqlen/balanced_min:141061.000 - global_seqlen/balanced_max:141062.000 - global_seqlen/mean:141061.500 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.005 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.899 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.210 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.314 - mfu/actor:0.397 - actor/lr:0.000 - critic/score/mean:0.349 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.349 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.023 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1963.875 - response_length/max:8192.000 - response_length/min:479.000 - response_length/clip_ratio:0.018 - on_off_metrics/on_response_length_mean:1963.875 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.349 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.211 - prompt_length/max:501.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:200.383 - timing_s/old_log_prob:10.490 - timing_s/adv:17.017 - timing_s/update_actor:27.628 - timing_s/step:245.347 - timing_per_token_ms/update_actor:0.012 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:113 - batch/bef_solve_none:35.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:15.000 - batch/solve_none:35.000 - batch/solve_none_format:0.000 - batch/solve_all:15.000 - batch/bef_solved:0.345 - batch/bef_failed:0.655 - batch/on_solved:0.345 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:35344.000 - global_seqlen/max:53797.000 - global_seqlen/minmax_diff:18453.000 - global_seqlen/balanced_min:42222.000 - global_seqlen/balanced_max:42266.000 - global_seqlen/mean:42248.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.072 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.857 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.512 - actor/pg_loss:0.198 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.320 - mfu/actor:0.383 - actor/lr:0.000 - actor/sft_entropy_loss:0.625 - actor/sft_loss:0.626 - actor/sft_grad_norm:0.078 - mfu/sft_actor:1.456 - actor/sft_lr:0.000 - critic/score/mean:0.345 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.345 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.025 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.025 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2153.996 - response_length/max:8192.000 - response_length/min:296.000 - response_length/clip_ratio:0.020 - on_off_metrics/on_response_length_mean:2153.996 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.345 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:248.758 - prompt_length/max:997.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:210.275 - timing_s/old_log_prob:9.287 - timing_s/adv:15.596 - timing_s/update_actor:31.344 - timing_s/sft_update_actor:9.822 - timing_s/step:267.426 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:114 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.339 - batch/bef_failed:0.661 - batch/on_solved:0.339 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:122326.000 - global_seqlen/max:166039.000 - global_seqlen/minmax_diff:43713.000 - global_seqlen/balanced_min:147678.000 - global_seqlen/balanced_max:147679.000 - global_seqlen/mean:147678.500 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.014 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.889 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.289 - actor/pg_loss:-0.039 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.306 - mfu/actor:0.370 - actor/lr:0.000 - critic/score/mean:0.339 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.339 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.027 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.027 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2073.328 - response_length/max:8192.000 - response_length/min:442.000 - response_length/clip_ratio:0.025 - on_off_metrics/on_response_length_mean:2073.328 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.339 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:234.148 - prompt_length/max:367.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:204.611 - timing_s/old_log_prob:9.023 - timing_s/adv:14.611 - timing_s/update_actor:31.154 - timing_s/step:250.687 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:03:25,945:Error comparing (-1 <= a) & (a < -3/4) and a >= -3/2
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'GreaterThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254528)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:115 - batch/bef_solve_none:42.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:42.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.334 - batch/bef_failed:0.666 - batch/on_solved:0.334 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:115704.000 - global_seqlen/max:176854.000 - global_seqlen/minmax_diff:61150.000 - global_seqlen/balanced_min:140153.000 - global_seqlen/balanced_max:140154.000 - global_seqlen/mean:140153.875 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.067 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.901 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.209 - actor/pg_loss:-0.179 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.307 - mfu/actor:0.367 - actor/lr:0.000 - critic/score/mean:0.334 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.334 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.016 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.016 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1950.295 - response_length/max:8192.000 - response_length/min:433.000 - response_length/clip_ratio:0.007 - on_off_metrics/on_response_length_mean:1950.295 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.334 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:239.609 - prompt_length/max:441.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.475 - timing_s/old_log_prob:9.610 - timing_s/adv:17.706 - timing_s/update_actor:29.286 - timing_s/step:245.758 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:07:35,058:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:07:35,062:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:07:35,064:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:07:35,068:Error comparing zoo and 7/15
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:07:35,070:Error comparing zoo and 13
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:07:35,073:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:07:35,076:Error comparing zoo and zoo
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:07:35,080:Error comparing zoo and 13/30
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 565, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_str_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 311, in sympy_str_eq
[36m(main_task pid=254128)[0m     raise ValueError("Can't evaluate nan or zoo")
[36m(main_task pid=254128)[0m ValueError: Can't evaluate nan or zoo
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:116 - batch/bef_solve_none:44.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:19.000 - batch/solve_none:44.000 - batch/solve_none_format:0.000 - batch/solve_all:19.000 - batch/bef_solved:0.386 - batch/bef_failed:0.614 - batch/on_solved:0.386 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:30057.000 - global_seqlen/max:48988.000 - global_seqlen/minmax_diff:18931.000 - global_seqlen/balanced_min:41396.000 - global_seqlen/balanced_max:41566.000 - global_seqlen/mean:41441.375 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.102 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.912 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.181 - actor/pg_loss:0.300 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.293 - mfu/actor:0.346 - actor/lr:0.000 - actor/sft_entropy_loss:0.654 - actor/sft_loss:0.656 - actor/sft_grad_norm:0.079 - mfu/sft_actor:1.140 - actor/sft_lr:0.000 - critic/score/mean:0.386 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.386 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.025 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.025 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:2041.466 - response_length/max:8192.000 - response_length/min:309.000 - response_length/clip_ratio:0.019 - on_off_metrics/on_response_length_mean:2041.466 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.386 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.875 - prompt_length/max:571.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:201.927 - timing_s/old_log_prob:9.155 - timing_s/adv:16.468 - timing_s/update_actor:32.761 - timing_s/sft_update_actor:11.391 - timing_s/step:262.853 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=254530)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:117 - batch/bef_solve_none:39.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:13.000 - batch/solve_none:39.000 - batch/solve_none_format:0.000 - batch/solve_all:13.000 - batch/bef_solved:0.406 - batch/bef_failed:0.594 - batch/on_solved:0.406 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:110233.000 - global_seqlen/max:154970.000 - global_seqlen/minmax_diff:44737.000 - global_seqlen/balanced_min:128691.000 - global_seqlen/balanced_max:128692.000 - global_seqlen/mean:128691.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.063 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.815 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.803 - actor/pg_loss:0.150 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.317 - mfu/actor:0.332 - actor/lr:0.000 - critic/score/mean:0.406 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.406 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.028 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.028 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1772.253 - response_length/max:8192.000 - response_length/min:423.000 - response_length/clip_ratio:0.012 - on_off_metrics/on_response_length_mean:1772.253 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.406 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:238.555 - prompt_length/max:451.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:203.980 - timing_s/old_log_prob:8.239 - timing_s/adv:17.348 - timing_s/update_actor:29.749 - timing_s/step:251.384 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:118 - batch/bef_solve_none:36.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:19.000 - batch/solve_none:36.000 - batch/solve_none_format:0.000 - batch/solve_all:19.000 - batch/bef_solved:0.404 - batch/bef_failed:0.596 - batch/on_solved:0.404 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:107479.000 - global_seqlen/max:142797.000 - global_seqlen/minmax_diff:35318.000 - global_seqlen/balanced_min:127682.000 - global_seqlen/balanced_max:127683.000 - global_seqlen/mean:127682.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.019 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.820 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.694 - actor/pg_loss:0.047 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.292 - mfu/actor:0.358 - actor/lr:0.000 - critic/score/mean:0.404 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.404 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.020 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1743.274 - response_length/max:8192.000 - response_length/min:328.000 - response_length/clip_ratio:0.011 - on_off_metrics/on_response_length_mean:1743.274 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.404 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.758 - prompt_length/max:678.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:201.356 - timing_s/old_log_prob:7.935 - timing_s/adv:12.647 - timing_s/update_actor:27.284 - timing_s/step:241.601 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/adv:0.006
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:119 - batch/bef_solve_none:32.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:14.000 - batch/solve_none:32.000 - batch/solve_none_format:0.000 - batch/solve_all:14.000 - batch/bef_solved:0.409 - batch/bef_failed:0.591 - batch/on_solved:0.409 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:102267.000 - global_seqlen/max:154295.000 - global_seqlen/minmax_diff:52028.000 - global_seqlen/balanced_min:131169.000 - global_seqlen/balanced_max:131170.000 - global_seqlen/mean:131169.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.052 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.860 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.474 - actor/pg_loss:0.124 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.311 - mfu/actor:0.389 - actor/lr:0.000 - critic/score/mean:0.409 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.409 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.023 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1806.466 - response_length/max:8192.000 - response_length/min:492.000 - response_length/clip_ratio:0.010 - on_off_metrics/on_response_length_mean:1806.466 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.409 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.055 - prompt_length/max:348.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.443 - timing_s/old_log_prob:8.226 - timing_s/adv:18.557 - timing_s/update_actor:26.153 - timing_s/step:244.445 - timing_per_token_ms/update_actor:0.012 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(main_task pid=254128)[0m Saving best checkpoint with score 0.31604802670168486 at ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Saving actor checkpoint to ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(main_task pid=254128)[0m step:120 - batch/bef_solve_none:40.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:24.000 - batch/solve_none:40.000 - batch/solve_none_format:0.000 - batch/solve_all:24.000 - batch/bef_solved:0.427 - batch/bef_failed:0.573 - batch/on_solved:0.427 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:36909.000 - global_seqlen/max:50533.000 - global_seqlen/minmax_diff:13624.000 - global_seqlen/balanced_min:41410.000 - global_seqlen/balanced_max:41477.000 - global_seqlen/mean:41437.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.055 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.862 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.473 - actor/pg_loss:-0.116 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.287 - mfu/actor:0.349 - actor/lr:0.000 - actor/sft_entropy_loss:0.689 - actor/sft_loss:0.683 - actor/sft_grad_norm:0.079 - mfu/sft_actor:1.077 - actor/sft_lr:0.000 - val/test_score/olympiad_bench:0.294 - val/test_score/minerva:0.235 - val/test_score/math:0.678 - val/test_score/amc:0.310 - val/test_score/aime:0.062 - avg_score:0.316 - critic/score/mean:0.427 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.427 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.020 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1821.756 - response_length/max:8192.000 - response_length/min:427.000 - response_length/clip_ratio:0.015 - on_off_metrics/on_response_length_mean:1821.756 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.427 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.891 - prompt_length/max:525.000 - prompt_length/min:181.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.965 - timing_s/old_log_prob:7.831 - timing_s/adv:13.911 - timing_s/update_actor:29.280 - timing_s/sft_update_actor:10.739 - timing_s/testing:260.836 - timing_s/step:545.153 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:121 - batch/bef_solve_none:39.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:15.000 - batch/solve_none:39.000 - batch/solve_none_format:0.000 - batch/solve_all:15.000 - batch/bef_solved:0.390 - batch/bef_failed:0.610 - batch/on_solved:0.390 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:109272.000 - global_seqlen/max:172476.000 - global_seqlen/minmax_diff:63204.000 - global_seqlen/balanced_min:125869.000 - global_seqlen/balanced_max:126343.000 - global_seqlen/mean:126076.500 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.041 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.820 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.784 - actor/pg_loss:-0.104 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.317 - mfu/actor:0.352 - actor/lr:0.000 - critic/score/mean:0.390 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.390 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.030 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.030 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1733.078 - response_length/max:8192.000 - response_length/min:225.000 - response_length/clip_ratio:0.020 - on_off_metrics/on_response_length_mean:1733.078 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.390 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.867 - prompt_length/max:502.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:200.065 - timing_s/old_log_prob:8.874 - timing_s/adv:14.710 - timing_s/update_actor:27.853 - timing_s/step:242.943 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254531)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:122 - batch/bef_solve_none:40.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:40.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.337 - batch/bef_failed:0.663 - batch/on_solved:0.337 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:108725.000 - global_seqlen/max:147790.000 - global_seqlen/minmax_diff:39065.000 - global_seqlen/balanced_min:127321.000 - global_seqlen/balanced_max:127322.000 - global_seqlen/mean:127321.562 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.094 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.896 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.232 - actor/pg_loss:0.217 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.283 - mfu/actor:0.348 - actor/lr:0.000 - critic/score/mean:0.337 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.337 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.020 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1743.259 - response_length/max:8192.000 - response_length/min:479.000 - response_length/clip_ratio:0.011 - on_off_metrics/on_response_length_mean:1743.259 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.337 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:246.141 - prompt_length/max:492.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.211 - timing_s/old_log_prob:8.226 - timing_s/adv:14.668 - timing_s/update_actor:28.047 - timing_s/step:242.266 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:41:33,737:Error comparing 1997.50000000000 and 1/(2*1000**1997)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 582, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_numeric_eq(gold, pred, float_rounding, numeric_precision):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 137, in sympy_numeric_eq
[36m(main_task pid=254128)[0m     return a.round(float_rounding) == b.round(float_rounding)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3856, in round
[36m(main_task pid=254128)[0m     digits_to_decimal = _mag(x)  # _mag(12) = 2, _mag(.012) = -1
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 4039, in _mag
[36m(main_task pid=254128)[0m     if (xpos/10**mag_first_dig) >= 1:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 65, in __sympifyit_wrapper
[36m(main_task pid=254128)[0m     return func(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 1042, in __truediv__
[36m(main_task pid=254128)[0m     return Float._new(mlib.mpf_div(self._mpf_, rhs, prec, rnd), prec)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/mpmath/libmp/libmpf.py", line 960, in mpf_div
[36m(main_task pid=254128)[0m     raise ZeroDivisionError
[36m(main_task pid=254128)[0m ZeroDivisionError
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 14x across cluster][0m
[36m(main_task pid=254128)[0m step:123 - batch/bef_solve_none:44.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:44.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.319 - batch/bef_failed:0.681 - batch/on_solved:0.319 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32349.000 - global_seqlen/max:48482.000 - global_seqlen/minmax_diff:16133.000 - global_seqlen/balanced_min:38407.000 - global_seqlen/balanced_max:38472.000 - global_seqlen/mean:38435.125 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.042 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.899 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.213 - actor/pg_loss:0.135 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.264 - mfu/actor:0.340 - actor/lr:0.000 - actor/sft_entropy_loss:0.577 - actor/sft_loss:0.562 - actor/sft_grad_norm:0.084 - mfu/sft_actor:0.956 - actor/sft_lr:0.000 - critic/score/mean:0.319 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.319 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.015 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1543.240 - response_length/max:8192.000 - response_length/min:381.000 - response_length/clip_ratio:0.008 - on_off_metrics/on_response_length_mean:1543.240 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.319 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.383 - prompt_length/max:451.000 - prompt_length/min:182.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.593 - timing_s/old_log_prob:8.373 - timing_s/adv:18.038 - timing_s/update_actor:25.512 - timing_s/sft_update_actor:10.527 - timing_s/step:252.008 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/adv:0.010
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:45:54,802:Error comparing Eq(y**n, ((-1)**n*2**n*factorial(n))/((2*x + 3)**(n + 1))) and Sum((-2)**k*binomial(n, k)*factorial(k)/(2*x + 3)**(k + 1), (k, 0, n))
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 760, in simplify
[36m(main_task pid=254128)[0m     return done(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 585, in done
[36m(main_task pid=254128)[0m     rv = e.doit() if doit else e
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in doit
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 455, in <listcomp>
[36m(main_task pid=254128)[0m     terms = [term.doit(**hints) for term in self.args]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 252, in doit
[36m(main_task pid=254128)[0m     newf = eval_sum(f, (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1048, in eval_sum
[36m(main_task pid=254128)[0m     value = eval_sum_symbolic(f.expand(), (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1252, in eval_sum_symbolic
[36m(main_task pid=254128)[0m     h = eval_sum_hyper(f_orig, (i, a, b))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1343, in eval_sum_hyper
[36m(main_task pid=254128)[0m     res2 = _eval_sum_hyper(f, i, b + 1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1268, in _eval_sum_hyper
[36m(main_task pid=254128)[0m     return _eval_sum_hyper(f.subs(i, i + a), i, 0)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1274, in _eval_sum_hyper
[36m(main_task pid=254128)[0m     return _eval_sum_hyper(f.subs(i, i + 1), i, 0)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1274, in _eval_sum_hyper
[36m(main_task pid=254128)[0m     return _eval_sum_hyper(f.subs(i, i + 1), i, 0)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1274, in _eval_sum_hyper
[36m(main_task pid=254128)[0m     return _eval_sum_hyper(f.subs(i, i + 1), i, 0)
[36m(main_task pid=254128)[0m   [Previous line repeated 15 more times]
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/concrete/summations.py", line 1272, in _eval_sum_hyper
[36m(main_task pid=254128)[0m     if simplify(f.subs(i, Dummy('i', integer=True, positive=True))) == 0:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 707, in simplify
[36m(main_task pid=254128)[0m     expr = combsimp(expr)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/combsimp.py", line 55, in combsimp
[36m(main_task pid=254128)[0m     expr = _gammasimp(expr, as_comb = True)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 457, in _gammasimp
[36m(main_task pid=254128)[0m     expr = rule_gamma(was)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 178, in rule_gamma
[36m(main_task pid=254128)[0m     expr = rule_gamma(expr, 4)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 437, in rule_gamma
[36m(main_task pid=254128)[0m     y = find_fuzzy(denom, g - 1)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/gammasimp.py", line 394, in find_fuzzy
[36m(main_task pid=254128)[0m     a = len(cancel(x/y).free_symbols)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7155, in cancel
[36m(main_task pid=254128)[0m     f = signsimp(f)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 406, in signsimp
[36m(main_task pid=254128)[0m     e = sub_post(sub_pre(e))
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/cse_opts.py", line 24, in sub_pre
[36m(main_task pid=254128)[0m     e = e.xreplace(reps)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 1313, in xreplace
[36m(main_task pid=254128)[0m     value, _ = self._xreplace(rule)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 1328, in _xreplace
[36m(main_task pid=254128)[0m     a_xr = _xreplace(rule)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 1328, in _xreplace
[36m(main_task pid=254128)[0m     a_xr = _xreplace(rule)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 1328, in _xreplace
[36m(main_task pid=254128)[0m     a_xr = _xreplace(rule)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/basic.py", line 1316, in _xreplace
[36m(main_task pid=254128)[0m     def _xreplace(self, rule):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(main_task pid=254128)[0m ERROR:2025-05-28 18:45:58,871:Error comparing -2 and 2*x*(x**2001 - 1)/(x - 1)
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 499, in getit
[36m(main_task pid=254128)[0m     return self._assumptions[fact]
[36m(main_task pid=254128)[0m KeyError: 'zero'
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m During handling of the above exception, another exception occurred:
[36m(main_task pid=254128)[0m 
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 585, in sympy_expr_eq
[36m(main_task pid=254128)[0m     if sympy_symbolic_eq(gold, pred):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 163, in sympy_symbolic_eq
[36m(main_task pid=254128)[0m     a_b_diff = simplify((a - b))  # type: ignore
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/simplify/simplify.py", line 645, in simplify
[36m(main_task pid=254128)[0m     expr1 = shorter(_e, _mexpand(_e).cancel())  # issue 6829
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 3782, in cancel
[36m(main_task pid=254128)[0m     return cancel(self, *gens, **args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/polys/polytools.py", line 7164, in cancel
[36m(main_task pid=254128)[0m     p, q = f.as_numer_denom()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 1236, in as_numer_denom
[36m(main_task pid=254128)[0m     return self.func(*numers), self.func(*denoms)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 295, in flatten
[36m(main_task pid=254128)[0m     newb = Add(*[_keep_coeff(a, bi) for bi in b.args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 295, in <listcomp>
[36m(main_task pid=254128)[0m     newb = Add(*[_keep_coeff(a, bi) for bi in b.args])
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 2179, in _keep_coeff
[36m(main_task pid=254128)[0m     m = coeff*factors
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 1904, in __mul__
[36m(main_task pid=254128)[0m     return Rational.__mul__(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 65, in __sympifyit_wrapper
[36m(main_task pid=254128)[0m     return func(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 1468, in __mul__
[36m(main_task pid=254128)[0m     return Number.__mul__(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 65, in __sympifyit_wrapper
[36m(main_task pid=254128)[0m     return func(a, b)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/numbers.py", line 485, in __mul__
[36m(main_task pid=254128)[0m     return AtomicExpr.__mul__(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 236, in _func
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/decorators.py", line 106, in binary_op_wrapper
[36m(main_task pid=254128)[0m     return func(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/expr.py", line 219, in __mul__
[36m(main_task pid=254128)[0m     return Mul(self, other)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/cache.py", line 72, in wrapper
[36m(main_task pid=254128)[0m     retval = cfunc(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/operations.py", line 98, in __new__
[36m(main_task pid=254128)[0m     c_part, nc_part, order_symbols = cls.flatten(args)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/mul.py", line 511, in flatten
[36m(main_task pid=254128)[0m     if e.is_zero:
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 502, in getit
[36m(main_task pid=254128)[0m     self._assumptions = self.default_assumptions.copy()
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 482, in copy
[36m(main_task pid=254128)[0m     return self.__class__(self)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/assumptions.py", line 479, in __init__
[36m(main_task pid=254128)[0m     self.deduce_all_facts(facts)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/sympy/core/facts.py", line 625, in deduce_all_facts
[36m(main_task pid=254128)[0m     self._tell(key, value)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 43, in handler
[36m(main_task pid=254128)[0m     raise TimeoutError("Operation timed out!")
[36m(main_task pid=254128)[0m TimeoutError: Operation timed out!
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 23x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 24x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:124 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.342 - batch/bef_failed:0.658 - batch/on_solved:0.342 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:99648.000 - global_seqlen/max:154461.000 - global_seqlen/minmax_diff:54813.000 - global_seqlen/balanced_min:117071.000 - global_seqlen/balanced_max:117595.000 - global_seqlen/mean:117116.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.001 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.815 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.750 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.287 - mfu/actor:0.358 - actor/lr:0.000 - critic/score/mean:0.342 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.342 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.020 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1588.280 - response_length/max:8192.000 - response_length/min:408.000 - response_length/clip_ratio:0.016 - on_off_metrics/on_response_length_mean:1588.280 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.342 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.672 - prompt_length/max:448.000 - prompt_length/min:174.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:204.071 - timing_s/old_log_prob:8.766 - timing_s/adv:21.787 - timing_s/update_actor:25.154 - timing_s/step:251.343 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/adv:0.012
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:125 - batch/bef_solve_none:41.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:14.000 - batch/solve_none:41.000 - batch/solve_none_format:0.000 - batch/solve_all:14.000 - batch/bef_solved:0.385 - batch/bef_failed:0.615 - batch/on_solved:0.385 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:99742.000 - global_seqlen/max:129471.000 - global_seqlen/minmax_diff:29729.000 - global_seqlen/balanced_min:115711.000 - global_seqlen/balanced_max:115712.000 - global_seqlen/mean:115711.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.092 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.865 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.466 - actor/pg_loss:-0.280 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.292 - mfu/actor:0.354 - actor/lr:0.000 - critic/score/mean:0.385 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.385 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.016 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.016 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1559.435 - response_length/max:8192.000 - response_length/min:353.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1559.435 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.385 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:248.555 - prompt_length/max:926.000 - prompt_length/min:169.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.920 - timing_s/old_log_prob:7.434 - timing_s/adv:12.956 - timing_s/update_actor:25.421 - timing_s/step:234.642 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254529)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:126 - batch/bef_solve_none:50.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:50.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.309 - batch/bef_failed:0.691 - batch/on_solved:0.309 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:29545.000 - global_seqlen/max:50745.000 - global_seqlen/minmax_diff:21200.000 - global_seqlen/balanced_min:40319.000 - global_seqlen/balanced_max:40445.000 - global_seqlen/mean:40349.688 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.020 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.807 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.783 - actor/pg_loss:0.047 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.274 - mfu/actor:0.345 - actor/lr:0.000 - actor/sft_entropy_loss:0.676 - actor/sft_loss:0.665 - actor/sft_grad_norm:0.085 - mfu/sft_actor:0.887 - actor/sft_lr:0.000 - critic/score/mean:0.309 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.309 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.018 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.018 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1505.328 - response_length/max:8192.000 - response_length/min:305.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1505.328 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.309 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.570 - prompt_length/max:387.000 - prompt_length/min:181.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.129 - timing_s/old_log_prob:8.320 - timing_s/adv:15.733 - timing_s/update_actor:25.379 - timing_s/sft_update_actor:11.178 - timing_s/step:249.726 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:127 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:15.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:15.000 - batch/bef_solved:0.372 - batch/bef_failed:0.628 - batch/on_solved:0.372 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:86601.000 - global_seqlen/max:150855.000 - global_seqlen/minmax_diff:64254.000 - global_seqlen/balanced_min:116201.000 - global_seqlen/balanced_max:116202.000 - global_seqlen/mean:116201.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.035 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.798 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.812 - actor/pg_loss:0.125 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.289 - mfu/actor:0.361 - actor/lr:0.000 - critic/score/mean:0.372 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.372 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.033 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.033 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1578.869 - response_length/max:8192.000 - response_length/min:254.000 - response_length/clip_ratio:0.019 - on_off_metrics/on_response_length_mean:1578.869 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.372 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:236.781 - prompt_length/max:365.000 - prompt_length/min:177.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:196.545 - timing_s/old_log_prob:8.135 - timing_s/adv:15.985 - timing_s/update_actor:25.410 - timing_s/step:238.259 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:128 - batch/bef_solve_none:40.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:40.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.328 - batch/bef_failed:0.672 - batch/on_solved:0.328 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:88989.000 - global_seqlen/max:139167.000 - global_seqlen/minmax_diff:50178.000 - global_seqlen/balanced_min:110920.000 - global_seqlen/balanced_max:110921.000 - global_seqlen/mean:110920.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.118 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.789 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.926 - actor/pg_loss:0.340 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.305 - mfu/actor:0.350 - actor/lr:0.000 - critic/score/mean:0.328 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.328 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.029 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1490.715 - response_length/max:8192.000 - response_length/min:306.000 - response_length/clip_ratio:0.014 - on_off_metrics/on_response_length_mean:1490.715 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.328 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.422 - prompt_length/max:584.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:196.783 - timing_s/old_log_prob:7.499 - timing_s/adv:14.067 - timing_s/update_actor:24.545 - timing_s/step:235.736 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:129 - batch/bef_solve_none:42.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:8.000 - batch/solve_none:42.000 - batch/solve_none_format:0.000 - batch/solve_all:8.000 - batch/bef_solved:0.348 - batch/bef_failed:0.652 - batch/on_solved:0.348 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:33908.000 - global_seqlen/max:50185.000 - global_seqlen/minmax_diff:16277.000 - global_seqlen/balanced_min:42402.000 - global_seqlen/balanced_max:42440.000 - global_seqlen/mean:42425.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.028 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.852 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.534 - actor/pg_loss:-0.077 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.259 - mfu/actor:0.348 - actor/lr:0.000 - actor/sft_entropy_loss:0.646 - actor/sft_loss:0.634 - actor/sft_grad_norm:0.081 - mfu/sft_actor:0.905 - actor/sft_lr:0.000 - critic/score/mean:0.348 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.348 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.018 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.018 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1428.271 - response_length/max:8192.000 - response_length/min:366.000 - response_length/clip_ratio:0.010 - on_off_metrics/on_response_length_mean:1428.271 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.348 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:231.977 - prompt_length/max:336.000 - prompt_length/min:172.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:192.881 - timing_s/old_log_prob:8.687 - timing_s/adv:14.760 - timing_s/update_actor:23.358 - timing_s/sft_update_actor:10.160 - timing_s/step:241.474 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   warnings.warn(
[36m(main_task pid=254128)[0m Saving best checkpoint with score 0.3224528096829236 at ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m Saving actor checkpoint to ./train_results/rl-sft/3b_INTERLEAVE/best/actor
[36m(main_task pid=254128)[0m step:130 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:7.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:7.000 - batch/bef_solved:0.335 - batch/bef_failed:0.665 - batch/on_solved:0.335 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:90273.000 - global_seqlen/max:135277.000 - global_seqlen/minmax_diff:45004.000 - global_seqlen/balanced_min:111962.000 - global_seqlen/balanced_max:112962.000 - global_seqlen/mean:112410.062 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.097 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.732 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.316 - actor/pg_loss:0.292 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.309 - mfu/actor:0.342 - actor/lr:0.000 - val/test_score/minerva:0.232 - val/test_score/amc:0.343 - val/test_score/olympiad_bench:0.305 - val/test_score/math:0.666 - val/test_score/aime:0.067 - avg_score:0.322 - critic/score/mean:0.335 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.335 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.042 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.042 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1520.884 - response_length/max:8192.000 - response_length/min:232.000 - response_length/clip_ratio:0.021 - on_off_metrics/on_response_length_mean:1520.884 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.335 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:235.523 - prompt_length/max:569.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.546 - timing_s/old_log_prob:8.157 - timing_s/adv:14.622 - timing_s/update_actor:25.988 - timing_s/testing:247.277 - timing_s/step:520.780 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m /jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m   with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:131 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:13.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:13.000 - batch/bef_solved:0.349 - batch/bef_failed:0.651 - batch/on_solved:0.349 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:32302.000 - global_seqlen/max:50002.000 - global_seqlen/minmax_diff:17700.000 - global_seqlen/balanced_min:41551.000 - global_seqlen/balanced_max:41646.000 - global_seqlen/mean:41615.250 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.078 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.909 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.197 - actor/pg_loss:-0.221 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.254 - mfu/actor:0.319 - actor/lr:0.000 - actor/sft_entropy_loss:0.604 - actor/sft_loss:0.587 - actor/sft_grad_norm:0.075 - mfu/sft_actor:0.998 - actor/sft_lr:0.000 - critic/score/mean:0.349 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.349 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.012 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1465.395 - response_length/max:8192.000 - response_length/min:344.000 - response_length/clip_ratio:0.007 - on_off_metrics/on_response_length_mean:1465.395 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.349 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.836 - prompt_length/max:412.000 - prompt_length/min:184.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.180 - timing_s/old_log_prob:7.086 - timing_s/adv:14.509 - timing_s/update_actor:26.221 - timing_s/sft_update_actor:10.022 - timing_s/step:245.233 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:132 - batch/bef_solve_none:39.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:39.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.342 - batch/bef_failed:0.658 - batch/on_solved:0.342 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:85772.000 - global_seqlen/max:143766.000 - global_seqlen/minmax_diff:57994.000 - global_seqlen/balanced_min:112664.000 - global_seqlen/balanced_max:112665.000 - global_seqlen/mean:112664.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.126 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.835 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.735 - actor/pg_loss:0.255 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.312 - mfu/actor:0.346 - actor/lr:0.000 - critic/score/mean:0.342 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.342 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.031 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.031 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1516.074 - response_length/max:8192.000 - response_length/min:264.000 - response_length/clip_ratio:0.015 - on_off_metrics/on_response_length_mean:1516.074 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.342 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:244.312 - prompt_length/max:435.000 - prompt_length/min:183.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.971 - timing_s/old_log_prob:7.530 - timing_s/adv:12.671 - timing_s/update_actor:25.654 - timing_s/step:233.616 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.126 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 26x across cluster][0m
[36m(main_task pid=254128)[0m step:133 - batch/bef_solve_none:36.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:10.000 - batch/solve_none:36.000 - batch/solve_none_format:0.000 - batch/solve_all:10.000 - batch/bef_solved:0.373 - batch/bef_failed:0.627 - batch/on_solved:0.373 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:83348.000 - global_seqlen/max:168143.000 - global_seqlen/minmax_diff:84795.000 - global_seqlen/balanced_min:113149.000 - global_seqlen/balanced_max:114566.000 - global_seqlen/mean:113357.750 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.059 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.770 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:1.160 - actor/pg_loss:0.140 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.292 - mfu/actor:0.319 - actor/lr:0.000 - critic/score/mean:0.373 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.373 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.027 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.027 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1519.840 - response_length/max:8192.000 - response_length/min:347.000 - response_length/clip_ratio:0.015 - on_off_metrics/on_response_length_mean:1519.840 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.373 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:251.375 - prompt_length/max:667.000 - prompt_length/min:185.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:197.828 - timing_s/old_log_prob:8.925 - timing_s/adv:14.304 - timing_s/update_actor:27.399 - timing_s/step:239.860 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 5x across cluster][0m
[36m(main_task pid=254128)[0m ERROR:2025-05-28 19:30:50,549:Error comparing (5 < Abs(2*i + z)) & (Abs(2*i + z) < 6) and Abs(2*i + z) > 5
[36m(main_task pid=254128)[0m Traceback (most recent call last):
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 700, in compare_single_extraction_wrapper
[36m(main_task pid=254128)[0m     return compare_single_extraction(g, t)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/utils.py", line 50, in wrapper
[36m(main_task pid=254128)[0m     return func(*args, **kwargs)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 682, in compare_single_extraction
[36m(main_task pid=254128)[0m     return sympy_expr_eq(gold, target, float_rounding, numeric_precision, strict)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 570, in sympy_expr_eq
[36m(main_task pid=254128)[0m     return sympy_compare_relational(gold, pred, float_rounding, numeric_precision)
[36m(main_task pid=254128)[0m   File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/math_verify/grader.py", line 259, in sympy_compare_relational
[36m(main_task pid=254128)[0m     return all(sympy_compare_relational(g, p, float_rounding, numeric_precision) for g, p in zip(gold._unsorted_args, pred._unsorted_args))
[36m(main_task pid=254128)[0m AttributeError: 'StrictGreaterThan' object has no attribute '_unsorted_args'
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:134 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.344 - batch/bef_failed:0.656 - batch/on_solved:0.344 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:81751.000 - global_seqlen/max:165482.000 - global_seqlen/minmax_diff:83731.000 - global_seqlen/balanced_min:111138.000 - global_seqlen/balanced_max:111139.000 - global_seqlen/mean:111138.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.005 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.883 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.266 - actor/pg_loss:-0.015 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.249 - mfu/actor:0.345 - actor/lr:0.000 - critic/score/mean:0.344 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.344 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.008 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1495.341 - response_length/max:8192.000 - response_length/min:232.000 - response_length/clip_ratio:0.014 - on_off_metrics/on_response_length_mean:1495.341 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.344 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:241.195 - prompt_length/max:441.000 - prompt_length/min:175.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.680 - timing_s/old_log_prob:8.594 - timing_s/adv:14.571 - timing_s/update_actor:24.871 - timing_s/step:235.431 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:135 - batch/bef_solve_none:47.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:23.000 - batch/solve_none:47.000 - batch/solve_none_format:0.000 - batch/solve_all:23.000 - batch/bef_solved:0.398 - batch/bef_failed:0.602 - batch/on_solved:0.398 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31525.000 - global_seqlen/max:52415.000 - global_seqlen/minmax_diff:20890.000 - global_seqlen/balanced_min:41675.000 - global_seqlen/balanced_max:41707.000 - global_seqlen/mean:41693.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.035 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.906 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.193 - actor/pg_loss:0.094 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.222 - mfu/actor:0.310 - actor/lr:0.000 - actor/sft_entropy_loss:0.515 - actor/sft_loss:0.507 - actor/sft_grad_norm:0.075 - mfu/sft_actor:0.895 - actor/sft_lr:0.000 - critic/score/mean:0.398 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.398 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.011 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1377.064 - response_length/max:8192.000 - response_length/min:289.000 - response_length/clip_ratio:0.006 - on_off_metrics/on_response_length_mean:1377.064 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.398 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:240.086 - prompt_length/max:436.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.786 - timing_s/old_log_prob:7.560 - timing_s/adv:12.717 - timing_s/update_actor:25.328 - timing_s/sft_update_actor:10.209 - timing_s/step:242.433 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.137 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235069, ip=30.207.98.114)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:136 - batch/bef_solve_none:38.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:16.000 - batch/solve_none:38.000 - batch/solve_none_format:0.000 - batch/solve_all:16.000 - batch/bef_solved:0.379 - batch/bef_failed:0.621 - batch/on_solved:0.379 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:83891.000 - global_seqlen/max:132878.000 - global_seqlen/minmax_diff:48987.000 - global_seqlen/balanced_min:108547.000 - global_seqlen/balanced_max:110455.000 - global_seqlen/mean:110019.812 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.028 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.834 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.597 - actor/pg_loss:-0.082 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.278 - mfu/actor:0.363 - actor/lr:0.000 - critic/score/mean:0.379 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.379 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.022 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.022 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1475.630 - response_length/max:8192.000 - response_length/min:364.000 - response_length/clip_ratio:0.009 - on_off_metrics/on_response_length_mean:1475.630 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.379 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.430 - prompt_length/max:538.000 - prompt_length/min:180.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.230 - timing_s/old_log_prob:8.514 - timing_s/adv:14.104 - timing_s/update_actor:23.411 - timing_s/step:236.058 - timing_per_token_ms/update_actor:0.013 - timing_per_token_ms/gen:0.131 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(main_task pid=254128)[0m step:137 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:16.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:16.000 - batch/bef_solved:0.352 - batch/bef_failed:0.648 - batch/on_solved:0.352 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:75978.000 - global_seqlen/max:124570.000 - global_seqlen/minmax_diff:48592.000 - global_seqlen/balanced_min:106408.000 - global_seqlen/balanced_max:108234.000 - global_seqlen/mean:107110.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.045 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.898 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.213 - actor/pg_loss:-0.130 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.247 - mfu/actor:0.308 - actor/lr:0.000 - critic/score/mean:0.352 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.352 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.017 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1436.477 - response_length/max:8192.000 - response_length/min:269.000 - response_length/clip_ratio:0.005 - on_off_metrics/on_response_length_mean:1436.477 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.352 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.117 - prompt_length/max:375.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:194.081 - timing_s/old_log_prob:6.896 - timing_s/adv:15.848 - timing_s/update_actor:26.570 - timing_s/step:236.813 - timing_per_token_ms/update_actor:0.016 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:138 - batch/bef_solve_none:45.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:9.000 - batch/solve_none:45.000 - batch/solve_none_format:0.000 - batch/solve_all:9.000 - batch/bef_solved:0.348 - batch/bef_failed:0.652 - batch/on_solved:0.348 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:31590.000 - global_seqlen/max:52163.000 - global_seqlen/minmax_diff:20573.000 - global_seqlen/balanced_min:41013.000 - global_seqlen/balanced_max:41263.000 - global_seqlen/mean:41238.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.023 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.848 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.555 - actor/pg_loss:0.074 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.281 - mfu/actor:0.347 - actor/lr:0.000 - actor/sft_entropy_loss:0.622 - actor/sft_loss:0.624 - actor/sft_grad_norm:0.071 - mfu/sft_actor:0.911 - actor/sft_lr:0.000 - critic/score/mean:0.348 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.348 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.029 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.029 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1524.155 - response_length/max:8192.000 - response_length/min:242.000 - response_length/clip_ratio:0.008 - on_off_metrics/on_response_length_mean:1524.155 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.348 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:237.664 - prompt_length/max:462.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.431 - timing_s/old_log_prob:8.603 - timing_s/adv:16.719 - timing_s/update_actor:25.069 - timing_s/sft_update_actor:10.951 - timing_s/step:248.477 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=254528)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m step:139 - batch/bef_solve_none:44.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:15.000 - batch/solve_none:44.000 - batch/solve_none_format:0.000 - batch/solve_all:15.000 - batch/bef_solved:0.373 - batch/bef_failed:0.627 - batch/on_solved:0.373 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:99647.000 - global_seqlen/max:139659.000 - global_seqlen/minmax_diff:40012.000 - global_seqlen/balanced_min:116855.000 - global_seqlen/balanced_max:117482.000 - global_seqlen/mean:117177.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.048 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.844 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.676 - actor/pg_loss:-0.145 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.245 - mfu/actor:0.320 - actor/lr:0.000 - critic/score/mean:0.373 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.373 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.019 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.019 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1583.638 - response_length/max:8192.000 - response_length/min:243.000 - response_length/clip_ratio:0.006 - on_off_metrics/on_response_length_mean:1583.638 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.373 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:247.258 - prompt_length/max:703.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.273 - timing_s/old_log_prob:7.810 - timing_s/adv:14.282 - timing_s/update_actor:27.939 - timing_s/step:237.813 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/adv:0.008
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=254532)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(main_task pid=254128)[0m Validation: Generation end.
[36m(WorkerDict pid=254528)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:140 - batch/bef_solve_none:46.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:12.000 - batch/solve_none:46.000 - batch/solve_none_format:0.000 - batch/solve_all:12.000 - batch/bef_solved:0.329 - batch/bef_failed:0.671 - batch/on_solved:0.329 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:35392.000 - global_seqlen/max:47973.000 - global_seqlen/minmax_diff:12581.000 - global_seqlen/balanced_min:40110.000 - global_seqlen/balanced_max:40178.000 - global_seqlen/mean:40133.438 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.022 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.847 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.601 - actor/pg_loss:0.052 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.272 - mfu/actor:0.333 - actor/lr:0.000 - actor/sft_entropy_loss:0.542 - actor/sft_loss:0.547 - actor/sft_grad_norm:0.067 - mfu/sft_actor:0.991 - actor/sft_lr:0.000 - val/test_score/olympiad_bench:0.297 - val/test_score/aime:0.067 - val/test_score/math:0.662 - val/test_score/amc:0.307 - val/test_score/minerva:0.250 - avg_score:0.317 - critic/score/mean:0.329 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.329 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.022 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.022 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1733.015 - response_length/max:8192.000 - response_length/min:451.000 - response_length/clip_ratio:0.010 - on_off_metrics/on_response_length_mean:1733.015 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.329 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.969 - prompt_length/max:699.000 - prompt_length/min:173.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:198.673 - timing_s/old_log_prob:8.267 - timing_s/adv:17.496 - timing_s/update_actor:29.030 - timing_s/sft_update_actor:11.094 - timing_s/testing:252.243 - timing_s/step:508.873 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/adv:0.009
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254527)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:141 - batch/bef_solve_none:43.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:15.000 - batch/solve_none:43.000 - batch/solve_none_format:0.000 - batch/solve_all:15.000 - batch/bef_solved:0.379 - batch/bef_failed:0.621 - batch/on_solved:0.379 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:104447.000 - global_seqlen/max:153203.000 - global_seqlen/minmax_diff:48756.000 - global_seqlen/balanced_min:125985.000 - global_seqlen/balanced_max:125985.000 - global_seqlen/mean:125985.000 - actor/off_pg_loss:0.000 - actor/on_pg_loss:-0.001 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.826 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.656 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/grad_norm:0.303 - mfu/actor:0.330 - actor/lr:0.000 - critic/score/mean:0.379 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.379 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.027 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.027 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1729.539 - response_length/max:8192.000 - response_length/min:283.000 - response_length/clip_ratio:0.015 - on_off_metrics/on_response_length_mean:1729.539 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.379 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:238.977 - prompt_length/max:690.000 - prompt_length/min:176.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:199.043 - timing_s/old_log_prob:7.984 - timing_s/adv:14.948 - timing_s/update_actor:29.300 - timing_s/step:243.605 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m MICROBATCH STEP
[36m(WorkerDict pid=254526)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254528)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 31x across cluster][0m
[36m(main_task pid=254128)[0m step:142 - batch/bef_solve_none:40.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:40.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.337 - batch/bef_failed:0.663 - batch/on_solved:0.337 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:95025.000 - global_seqlen/max:138364.000 - global_seqlen/minmax_diff:43339.000 - global_seqlen/balanced_min:122015.000 - global_seqlen/balanced_max:122843.000 - global_seqlen/mean:122363.625 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.036 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.858 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.417 - actor/pg_loss:0.078 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.296 - mfu/actor:0.343 - actor/lr:0.000 - critic/score/mean:0.337 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.337 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.015 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1669.416 - response_length/max:8192.000 - response_length/min:359.000 - response_length/clip_ratio:0.004 - on_off_metrics/on_response_length_mean:1669.416 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.337 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:242.516 - prompt_length/max:449.000 - prompt_length/min:185.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:195.482 - timing_s/old_log_prob:7.719 - timing_s/adv:13.587 - timing_s/update_actor:27.290 - timing_s/step:236.672 - timing_per_token_ms/update_actor:0.014 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=254533)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP
[36m(WorkerDict pid=254527)[0m MICROBATCH STEP
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235071, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 32x across cluster][0m
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 32x across cluster][0m
[36m(main_task pid=254128)[0m step:143 - batch/bef_solve_none:40.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:16.000 - batch/solve_none:40.000 - batch/solve_none_format:0.000 - batch/solve_all:16.000 - batch/bef_solved:0.383 - batch/bef_failed:0.617 - batch/on_solved:0.383 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:93118.000 - global_seqlen/max:153283.000 - global_seqlen/minmax_diff:60165.000 - global_seqlen/balanced_min:120061.000 - global_seqlen/balanced_max:120062.000 - global_seqlen/mean:120061.938 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.022 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.901 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.216 - actor/pg_loss:0.061 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.267 - mfu/actor:0.328 - actor/lr:0.000 - critic/score/mean:0.383 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.383 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.017 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1632.796 - response_length/max:8192.000 - response_length/min:282.000 - response_length/clip_ratio:0.012 - on_off_metrics/on_response_length_mean:1632.796 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.383 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:243.172 - prompt_length/max:745.000 - prompt_length/min:178.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:196.478 - timing_s/old_log_prob:7.972 - timing_s/adv:13.230 - timing_s/update_actor:27.991 - timing_s/step:238.009 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235074, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=254526)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235073, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 31x across cluster][0m
[36m(WorkerDict pid=235070, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 17x across cluster][0m
[36m(WorkerDict pid=235072, ip=30.207.98.114)[0m MICROBATCH STEP[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=234876, ip=30.207.98.114)[0m no token mean: mean normalization 8192[32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=235068, ip=30.207.98.114)[0m SFT MICROBATCH STEP
[36m(WorkerDict pid=254533)[0m no token mean: mean normalization 8192[32m [repeated 15x across cluster][0m
[36m(main_task pid=254128)[0m step:144 - batch/bef_solve_none:41.000 - batch/bef_solve_none_format:0.000 - batch/bef_solve_all:11.000 - batch/solve_none:41.000 - batch/solve_none_format:0.000 - batch/solve_all:11.000 - batch/bef_solved:0.341 - batch/bef_failed:0.659 - batch/on_solved:0.341 - batch/off_solved:0.000 - critic/kl:0.000 - critic/kl_coeff:0.000 - global_seqlen/min:35944.000 - global_seqlen/max:49012.000 - global_seqlen/minmax_diff:13068.000 - global_seqlen/balanced_min:42910.000 - global_seqlen/balanced_max:43034.000 - global_seqlen/mean:42948.312 - actor/off_pg_loss:0.000 - actor/on_pg_loss:0.035 - actor/off_pg_clipfrac:0.000 - actor/off_policy_prob:0.000 - actor/on_policy_prob:0.823 - actor/off_ratio_mean:0.000 - actor/off_ratio_max_clip_frac:0.000 - actor/off_ratio_min_clip_frac:0.000 - actor/entropy_loss:0.607 - actor/pg_loss:0.112 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/grad_norm:0.280 - mfu/actor:0.339 - actor/lr:0.000 - actor/sft_entropy_loss:0.694 - actor/sft_loss:0.714 - actor/sft_grad_norm:0.071 - mfu/sft_actor:0.888 - actor/sft_lr:0.000 - critic/score/mean:0.341 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.341 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:0.875 - critic/advantages/min:-0.875 - critic/returns/mean:-0.012 - critic/returns/max:0.875 - critic/returns/min:-0.875 - response_length/mean:1549.405 - response_length/max:8192.000 - response_length/min:353.000 - response_length/clip_ratio:0.004 - on_off_metrics/on_response_length_mean:1549.405 - on_off_metrics/off_response_length_mean:nan - on_off_metrics/on_score:0.341 - on_off_metrics/off_score:nan - on_off_metrics/off_on_example_ratio:0.000 - prompt_length/mean:245.141 - prompt_length/max:412.000 - prompt_length/min:179.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:193.898 - timing_s/old_log_prob:7.508 - timing_s/adv:13.090 - timing_s/update_actor:26.655 - timing_s/sft_update_actor:11.292 - timing_s/step:245.232 - timing_per_token_ms/update_actor:0.015 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/adv:0.007
[36m(WorkerDict pid=254533)[0m SFT MICROBATCH STEP[32m [repeated 15x across cluster][0m
Traceback (most recent call last):
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/jizhicfs/hymiezhao/ml/reasoning/LUFFY/luffy/verl/verl/src_interleave_sft/main_mix_ppo.py", line 248, in <module>
    main()
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/jizhicfs/hymiezhao/ml/reasoning/LUFFY/luffy/verl/verl/src_interleave_sft/main_mix_ppo.py", line 143, in main
    ray.get(main_task.remote(config))
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/worker.py", line 2623, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/worker.py", line 840, in get_objects
    data_metadata_pairs = self.core_worker.get_objects(
  File "python/ray/_raylet.pyx", line 3481, in ray._raylet.CoreWorker.get_objects
  File "python/ray/_raylet.pyx", line 571, in ray._raylet.check_status
KeyboardInterrupt
Exception ignored in atexit callback: <function shutdown at 0x7fdd42570c10>
Traceback (most recent call last):
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/jizhicfs/hymiezhao/miniconda3/envs/LUFFY/lib/python3.10/site-packages/ray/_private/worker.py", line 1813, in shutdown
    time.sleep(0.5)
KeyboardInterrupt: 
